(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55fc9f54"],{"0c05":function(e,t,a){"use strict";a("a972")},"0f52":function(e,t,a){"use strict";a("a412")},"14a4":function(e,t,a){},"2d22":function(e,t,a){"use strict";a("48d8")},"2e75":function(e,t,a){},"35ff":function(e,t,a){"use strict";a("804c")},"48d8":function(e,t,a){},68872:function(e,t,a){"use strict";a("2e75")},"794a":function(e,t,a){},"804c":function(e,t,a){},"828b":function(e,t,a){},"8d29":function(e,t,a){"use strict";a("f0bf")},"8e0a":function(e,t,a){"use strict";a("794a")},a186:function(e,t,a){"use strict";a("828b")},a412:function(e,t,a){},a972:function(e,t,a){},adac:function(e,t,a){},c992:function(e,t,a){"use strict";a("adac")},cbe7:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-detail-container"},[t("div",{staticClass:"page-header"},[t("div",{staticClass:"header-title"},[e.customer.name?t("span",[e._v(e._s(e.customer.name))]):t("span",[e._v("客户详情")])]),t("div",{staticClass:"header-actions"},["info"===e.activeTab?t("el-button",{attrs:{type:"success",icon:"el-icon-check",size:"mini",round:"",loading:e.saveLoading},on:{click:e.saveCustomerInfo}},[e._v("保存")]):e._e()],1)]),t("tabs-nav",{ref:"tabsNav",attrs:{tabs:e.tabOptions,"default-active":e.activeTab},on:{"tab-click":e.handleTabClick},scopedSlots:e._u([{key:"info",fn:function(){return[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tab-content"},[t("el-collapse",{staticClass:"custom-collapse",attrs:{value:["basicInfo","addressInfo","feeInfo","businessInfo","ipInfo","financeInfo","researchInvestment","investment","qualificationInfo"]}},[t("el-collapse-item",{attrs:{title:"企业基本信息",name:"basicInfo"}},[t("el-form",{ref:"basicForm",staticClass:"detail-form",attrs:{model:e.editForm,rules:e.formRules,"label-width":"100px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户编号"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"系统自动生成",disabled:""},model:{value:e.editForm.customerCode,callback:function(t){e.$set(e.editForm,"customerCode",t)},expression:"editForm.customerCode"}}):t("span",[e._v(e._s(e.customer.customerCode||"系统自动生成"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户名称",prop:"name"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入客户名称"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}}):t("span",[e._v(e._s(e.customer.name||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户名称(英)"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入英文名称"},model:{value:e.editForm.nameEn,callback:function(t){e.$set(e.editForm,"nameEn",t)},expression:"editForm.nameEn"}}):t("span",[e._v(e._s(e.customer.nameEn||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"信用代码"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入统一社会信用代码"},on:{blur:e.checkCreditCodeUnique},model:{value:e.editForm.creditCode,callback:function(t){e.$set(e.editForm,"creditCode",t)},expression:"editForm.creditCode"}}):t("span",[e._v(e._s(e.customer.creditCode||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"法定代表人"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入法定代表人"},model:{value:e.editForm.legalRepresentative,callback:function(t){e.$set(e.editForm,"legalRepresentative",t)},expression:"editForm.legalRepresentative"}}):t("span",[e._v(e._s(e.customer.legalRepresentative||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"公司负责人"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入公司负责人"},model:{value:e.editForm.companyManager,callback:function(t){e.$set(e.editForm,"companyManager",t)},expression:"editForm.companyManager"}}):t("span",[e._v(e._s(e.customer.companyManager||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户等级"}},[e.isEditMode?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择客户等级"},model:{value:e.editForm.level,callback:function(t){e.$set(e.editForm,"level",t)},expression:"editForm.level"}},e._l(e.levelOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):t("el-tag",{attrs:{size:"medium"}},[e._v(e._s(e.getLevelLabel(e.customer.level)))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户规模"}},[e.isEditMode?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择客户规模"},model:{value:e.editForm.customerScale,callback:function(t){e.$set(e.editForm,"customerScale",t)},expression:"editForm.customerScale"}},e._l(e.customerScaleOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):t("span",[e._v(e._s(e.getCustomerScaleLabel(e.customer.customerScale)||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"业务人员"}},[e.isEditMode?t("div",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.showBusinessPersonDialog=!0}}},[e._v(" 管理业务人员 ")]),e.customerBusinessPersons&&e.customerBusinessPersons.length>0?t("div",{staticStyle:{"margin-top":"8px"}},e._l(e.customerBusinessPersons,(function(a){return t("el-tag",{key:a.id,staticStyle:{"margin-right":"5px","margin-bottom":"5px"},attrs:{type:"primary",size:"small",closable:""},on:{close:function(t){return e.removeBusinessPerson(a)}}},[e._v(" "+e._s(a.name)+" ")])})),1):e._e()],1):t("div",[e.customerBusinessPersons&&e.customerBusinessPersons.length>0?t("div",e._l(e.customerBusinessPersons,(function(a){return t("el-tag",{key:a.id,staticStyle:{"margin-right":"5px","margin-bottom":"5px"},attrs:{type:"primary",size:"small"}},[e._v(" "+e._s(a.name)+" ")])})),1):t("span",{staticStyle:{color:"#909399"}},[e._v("未分配")])])])],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"价格指数"}},[e.isEditMode?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择价格指数"},model:{value:e.editForm.priceIndex,callback:function(t){e.$set(e.editForm,"priceIndex",t)},expression:"editForm.priceIndex"}},e._l(e.priceIndexOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):t("span",[e._v(e._s(e.getPriceIndexLabel(e.customer.priceIndex)||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"创新指数"}},[e.isEditMode?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择创新指数"},model:{value:e.editForm.innovationIndex,callback:function(t){e.$set(e.editForm,"innovationIndex",t)},expression:"editForm.innovationIndex"}},e._l(e.innovationIndexOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):t("span",[e._v(e._s(e.getInnovationIndexLabel(e.customer.innovationIndex)||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"合同数量"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入合同数量"},model:{value:e.editForm.contractCount,callback:function(t){e.$set(e.editForm,"contractCount",t)},expression:"editForm.contractCount"}}):t("span",[e._v(e._s(e.customer.contractCount||"0"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"最新合同日期"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入最新合同日期"},model:{value:e.editForm.latestContractDate,callback:function(t){e.$set(e.editForm,"latestContractDate",t)},expression:"editForm.latestContractDate"}}):t("span",[e._v(e._s(e.customer.latestContractDate||"无"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"创建人"}},[t("span",[e._v(e._s(e.customer.creator.real_name||"未知"))])])],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"创建日期"}},[t("span",[e._v(e._s(e.customer.createDate||e.customer.createTime||"未知"))])])],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"更新人"}},[t("span",[e._v(e._s(e.customer.updater.real_name||"未知"))])])],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"更新时间"}},[t("span",[e._v(e._s(e.customer.updateTime||"未更新"))])])],1),t("el-col",{attrs:{xs:24,sm:24}},[t("el-form-item",{attrs:{label:"客户资料备注"}},[e.isEditMode?t("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入备注信息"},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}}):t("span",[e._v(e._s(e.customer.remark||"未填写"))])],1)],1)],1)],1)],1),t("el-collapse-item",{attrs:{title:"地址信息",name:"addressInfo"}},[t("el-form",{ref:"addressForm",staticClass:"detail-form",attrs:{model:e.editForm,"label-width":"100px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"国籍"}},[e.isEditMode?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择国籍",filterable:""},model:{value:e.editForm.country,callback:function(t){e.$set(e.editForm,"country",t)},expression:"editForm.country"}},e._l(e.countryOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):t("span",[e._v(e._s(e.customer.country||"中国"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"省市区"}},[e.isEditMode?t("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.areaOptions,props:{value:"value",label:"label",children:"children"},placeholder:"请选择省/市/区（必须选到区县级别）",clearable:"",filterable:""},on:{change:e.handleAreaChange},model:{value:e.editForm.areaCode,callback:function(t){e.$set(e.editForm,"areaCode",t)},expression:"editForm.areaCode"}}):t("span",[e._v(e._s(e.getFullAddress()||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"街道地址"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入详细地址"},model:{value:e.editForm.address,callback:function(t){e.$set(e.editForm,"address",t)},expression:"editForm.address"}}):t("span",[e._v(e._s(e.customer.address||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"英文地址"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入英文地址"},model:{value:e.editForm.addressEn,callback:function(t){e.$set(e.editForm,"addressEn",t)},expression:"editForm.addressEn"}}):t("span",[e._v(e._s(e.customer.addressEn||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"其它地址"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入其它地址"},model:{value:e.editForm.otherAddress,callback:function(t){e.$set(e.editForm,"otherAddress",t)},expression:"editForm.otherAddress"}}):t("span",[e._v(e._s(e.customer.otherAddress||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"产业园区"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入产业园区"},model:{value:e.editForm.industrialPark,callback:function(t){e.$set(e.editForm,"industrialPark",t)},expression:"editForm.industrialPark"}}):t("span",[e._v(e._s(e.customer.industrialPark||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"邮政编码"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入邮政编码"},model:{value:e.editForm.zipCode,callback:function(t){e.$set(e.editForm,"zipCode",t)},expression:"editForm.zipCode"}}):t("span",[e._v(e._s(e.customer.zipCode||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"公司网站"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入公司网站"},model:{value:e.editForm.website,callback:function(t){e.$set(e.editForm,"website",t)},expression:"editForm.website"}}):t("span",[e._v(e._s(e.customer.website||"未填写"))])],1)],1)],1)],1)],1),t("el-collapse-item",{attrs:{title:"费用信息",name:"feeInfo"}},[t("el-form",{ref:"feeForm",staticClass:"detail-form",attrs:{model:e.editForm,"label-width":"100px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"开户名称"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入开户名称"},model:{value:e.editForm.accountName,callback:function(t){e.$set(e.editForm,"accountName",t)},expression:"editForm.accountName"}}):t("span",[e._v(e._s(e.customer.accountName||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"开户银行"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入开户银行"},model:{value:e.editForm.bankName,callback:function(t){e.$set(e.editForm,"bankName",t)},expression:"editForm.bankName"}}):t("span",[e._v(e._s(e.customer.bankName||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"银行账号"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入银行账号"},model:{value:e.editForm.bankAccount,callback:function(t){e.$set(e.editForm,"bankAccount",t)},expression:"editForm.bankAccount"}}):t("span",[e._v(e._s(e.customer.bankAccount||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"开票地址"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入开票地址"},model:{value:e.editForm.invoiceAddress,callback:function(t){e.$set(e.editForm,"invoiceAddress",t)},expression:"editForm.invoiceAddress"}}):t("span",[e._v(e._s(e.customer.invoiceAddress||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"开票电话"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入开票电话"},model:{value:e.editForm.invoicePhone,callback:function(t){e.$set(e.editForm,"invoicePhone",t)},expression:"editForm.invoicePhone"}}):t("span",[e._v(e._s(e.customer.invoicePhone||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"一般纳税人"}},[e.isEditMode?t("el-switch",{model:{value:e.editForm.isGeneralTaxpayer,callback:function(t){e.$set(e.editForm,"isGeneralTaxpayer",t)},expression:"editForm.isGeneralTaxpayer"}}):t("el-tag",{attrs:{type:e.customer.isGeneralTaxpayer?"success":"info"}},[e._v(" "+e._s(e.customer.isGeneralTaxpayer?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"账单地址"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入账单地址"},model:{value:e.editForm.billingAddress,callback:function(t){e.$set(e.editForm,"billingAddress",t)},expression:"editForm.billingAddress"}}):t("span",[e._v(e._s(e.customer.billingAddress||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"开票信用代码"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入开票信用代码"},model:{value:e.editForm.invoiceCreditCode,callback:function(t){e.$set(e.editForm,"invoiceCreditCode",t)},expression:"editForm.invoiceCreditCode"}}):t("span",[e._v(e._s(e.customer.invoiceCreditCode||"未填写"))])],1)],1)],1)],1)],1),t("el-collapse-item",{attrs:{title:"工商信息",name:"businessInfo"}},[t("el-form",{ref:"businessForm",staticClass:"detail-form",attrs:{model:e.editForm,"label-width":"150px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"国民经济门类"}},[e.isEditMode?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择门类"},on:{change:e.handleDoorChange},model:{value:e.editForm.economicDoor,callback:function(t){e.$set(e.editForm,"economicDoor",t)},expression:"editForm.economicDoor"}},e._l(e.economicDoorOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1):t("span",[e._v(e._s(e.customer.economicDoor||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"国民经济大类"}},[e.isEditMode?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择大类",disabled:!e.editForm.economicDoor},on:{change:e.handleBigClassChange},model:{value:e.editForm.economicBigClass,callback:function(t){e.$set(e.editForm,"economicBigClass",t)},expression:"editForm.economicBigClass"}},e._l(e.economicBigClassOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1):t("span",[e._v(e._s(e.customer.economicBigClass||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"国民经济中类"}},[e.isEditMode?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择中类",disabled:!e.editForm.economicBigClass},on:{change:e.handleMidClassChange},model:{value:e.editForm.economicMidClass,callback:function(t){e.$set(e.editForm,"economicMidClass",t)},expression:"editForm.economicMidClass"}},e._l(e.economicMidClassOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1):t("span",[e._v(e._s(e.customer.economicMidClass||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"国民经济小类"}},[e.isEditMode?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择小类",disabled:!e.editForm.economicMidClass},model:{value:e.editForm.economicSmallClass,callback:function(t){e.$set(e.editForm,"economicSmallClass",t)},expression:"editForm.economicSmallClass"}},e._l(e.economicSmallClassOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1):t("span",[e._v(e._s(e.customer.economicSmallClass||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"成立时间"}},[e.isEditMode?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择成立时间","value-format":"yyyy-MM-dd"},model:{value:e.editForm.foundingDate,callback:function(t){e.$set(e.editForm,"foundingDate",t)},expression:"editForm.foundingDate"}}):t("span",[e._v(e._s(e.customer.foundingDate||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"主营业务产品"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.editForm.mainProducts,callback:function(t){e.$set(e.editForm,"mainProducts",t)},expression:"editForm.mainProducts"}}):t("span",[e._v(e._s(e.customer.mainProducts||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"公司人数"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入数字",type:"number"},model:{value:e.editForm.companyStaffCount,callback:function(t){e.$set(e.editForm,"companyStaffCount",t)},expression:"editForm.companyStaffCount"}}):t("span",[e._v(e._s(e.customer.companyStaffCount||e.customer.employeeCount||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"注册资本"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入数字",type:"number"},model:{value:e.editForm.registeredCapital,callback:function(t){e.$set(e.editForm,"registeredCapital",t)},expression:"editForm.registeredCapital"}}):t("span",[e._v(e._s(e.customer.registeredCapital||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"研发人数"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入数字",type:"number"},model:{value:e.editForm.researchStaffCount,callback:function(t){e.$set(e.editForm,"researchStaffCount",t)},expression:"editForm.researchStaffCount"}}):t("span",[e._v(e._s(e.customer.researchStaffCount||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"博士人数"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入数字",type:"number"},model:{value:e.editForm.doctorCount,callback:function(t){e.$set(e.editForm,"doctorCount",t)},expression:"editForm.doctorCount"}}):t("span",[e._v(e._s(e.customer.doctorCount||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"硕士人数"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入数字",type:"number"},model:{value:e.editForm.masterCount,callback:function(t){e.$set(e.editForm,"masterCount",t)},expression:"editForm.masterCount"}}):t("span",[e._v(e._s(e.customer.masterCount||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"本科人数"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入数字",type:"number"},model:{value:e.editForm.bachelorCount,callback:function(t){e.$set(e.editForm,"bachelorCount",t)},expression:"editForm.bachelorCount"}}):t("span",[e._v(e._s(e.customer.bachelorCount||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"海归人数"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入数字",type:"number"},model:{value:e.editForm.overseasReturneeCount,callback:function(t){e.$set(e.editForm,"overseasReturneeCount",t)},expression:"editForm.overseasReturneeCount"}}):t("span",[e._v(e._s(e.customer.overseasReturneeCount||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"中工人数"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入数字",type:"number"},model:{value:e.editForm.middleEngineerCount,callback:function(t){e.$set(e.editForm,"middleEngineerCount",t)},expression:"editForm.middleEngineerCount"}}):t("span",[e._v(e._s(e.customer.middleEngineerCount||"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"高工人数"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.editForm.seniorEngineerCount,callback:function(t){e.$set(e.editForm,"seniorEngineerCount",t)},expression:"editForm.seniorEngineerCount"}}):t("span",[e._v(e._s(e.customer.seniorEngineerCount||"未填写"))])],1)],1),t("el-col",{attrs:{xs:24,sm:24,md:24}},[t("el-form-item",{attrs:{label:"营业范围"}},[e.isEditMode?t("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",rows:3},model:{value:e.editForm.businessScope,callback:function(t){e.$set(e.editForm,"businessScope",t)},expression:"editForm.businessScope"}}):t("span",[e._v(e._s(e.customer.businessScope||"未填写"))])],1)],1)],1)],1)],1),t("el-collapse-item",{attrs:{title:"知识产权信息",name:"ipInfo"}},[t("el-form",{ref:"ipForm",staticClass:"detail-form",attrs:{model:e.editForm,"label-width":"160px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"商标数量/件"}},[e.isEditMode?t("el-input-number",{attrs:{min:0,placeholder:"请输入商标数量"},model:{value:e.editForm.trademarkCount,callback:function(t){e.$set(e.editForm,"trademarkCount",t)},expression:"editForm.trademarkCount"}}):t("span",[e._v(e._s(e.customer.trademarkCount||"0"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"专利数量/件"}},[e.isEditMode?t("el-input-number",{attrs:{min:0,placeholder:"请输入专利数量"},model:{value:e.editForm.patentCount,callback:function(t){e.$set(e.editForm,"patentCount",t)},expression:"editForm.patentCount"}}):t("span",[e._v(e._s(e.customer.patentCount||"0"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"授权发明专利数量/件"}},[e.isEditMode?t("el-input-number",{attrs:{min:0,placeholder:"请输入发明专利数量"},model:{value:e.editForm.inventionPatentCount,callback:function(t){e.$set(e.editForm,"inventionPatentCount",t)},expression:"editForm.inventionPatentCount"}}):t("span",[e._v(e._s(e.customer.inventionPatentCount||"0"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"版权登记数量/件"}},[e.isEditMode?t("el-input-number",{attrs:{min:0,placeholder:"请输入版权登记数量"},model:{value:e.editForm.copyrightCount,callback:function(t){e.$set(e.editForm,"copyrightCount",t)},expression:"editForm.copyrightCount"}}):t("span",[e._v(e._s(e.customer.copyrightCount||"0"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"是否享受过加计扣除"}},[e.isEditMode?t("el-switch",{model:{value:e.editForm.hasAdditionalDeduction,callback:function(t){e.$set(e.editForm,"hasAdditionalDeduction",t)},expression:"editForm.hasAdditionalDeduction"}}):t("el-tag",{attrs:{type:e.customer.hasAdditionalDeduction?"success":"info"}},[e._v(" "+e._s(e.customer.hasAdditionalDeduction?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"是否有校企合作"}},[e.isEditMode?t("el-switch",{model:{value:e.editForm.hasSchoolCooperation,callback:function(t){e.$set(e.editForm,"hasSchoolCooperation",t)},expression:"editForm.hasSchoolCooperation"}}):t("el-tag",{attrs:{type:e.customer.hasSchoolCooperation?"success":"info"}},[e._v(" "+e._s(e.customer.hasSchoolCooperation?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"合作高校名称"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入合作高校名称"},model:{value:e.editForm.cooperationSchool,callback:function(t){e.$set(e.editForm,"cooperationSchool",t)},expression:"editForm.cooperationSchool"}}):t("span",[e._v(e._s(e.customer.cooperationSchool||"无"))])],1)],1)],1)],1)],1),t("el-collapse-item",{attrs:{title:"财务情况",name:"financeInfo"}},[t("el-form",{ref:"financeForm",staticClass:"detail-form",attrs:{model:e.editForm,"label-width":"150px"}},[t("el-divider",{attrs:{"content-position":"left"}},[e._v("年度销售额")]),t("el-row",{attrs:{gutter:20}},e._l(e.recentYears,(function(a){return t("el-col",{key:"sales-"+a,attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"年度销售额"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入销售额",controls:!1},model:{value:e.editForm.salesData[a],callback:function(t){e.$set(e.editForm.salesData,a,t)},expression:"editForm.salesData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.salesData&&e.customer.salesData[a]?e.customer.salesData[a]+"万元":"未填写"))])],1)],1)})),1),t("el-divider",{attrs:{"content-position":"left"}},[e._v("研发费用")]),t("el-row",{attrs:{gutter:20}},e._l(e.recentYears,(function(a){return t("el-col",{key:"rd-"+a,attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"年研发费用"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入研发费用",controls:!1},model:{value:e.editForm.rdCostData[a],callback:function(t){e.$set(e.editForm.rdCostData,a,t)},expression:"editForm.rdCostData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.rdCostData&&e.customer.rdCostData[a]?e.customer.rdCostData[a]+"万元":"未填写"))])],1)],1)})),1),t("el-divider",{attrs:{"content-position":"left"}},[e._v("贷款情况")]),t("el-row",{attrs:{gutter:20}},e._l(e.recentYears,(function(a){return t("el-col",{key:"loan-"+a,attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"年贷款"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入贷款金额",controls:!1},model:{value:e.editForm.loanData[a],callback:function(t){e.$set(e.editForm.loanData,a,t)},expression:"editForm.loanData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.loanData&&e.customer.loanData[a]?e.customer.loanData[a]+"万元":"未填写"))])],1)],1)})),1)],1)],1),t("el-collapse-item",{attrs:{title:"研发投入情况",name:"researchInvestment"}},[t("el-form",{ref:"researchForm",staticClass:"detail-form",attrs:{model:e.editForm,"label-width":"150px"}},e._l(e.recentYears,(function(a){return t("div",{key:"research-"+a},[t("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(a)+"年研发投入")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:24,md:12}},[t("el-form-item",{attrs:{label:a+"有什么研发项目"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入研发项目，多个项目用逗号分隔",type:"textarea",rows:2},model:{value:e.editForm.researchProjectData[a],callback:function(t){e.$set(e.editForm.researchProjectData,a,t)},expression:"editForm.researchProjectData[year]"}}):t("span",[e._v(e._s(e.customer.researchProjectData&&e.customer.researchProjectData[a]||"未填写"))]),t("div",{staticStyle:{"font-size":"12px",color:"#909399","margin-top":"4px"}},[e._v(" 多个项目请用逗号分隔，如：项目A，项目B，项目C ")])],1)],1),t("el-col",{attrs:{xs:24,sm:12,md:12}},[t("el-form-item",{attrs:{label:a+"项目金额"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入项目金额",controls:!1},model:{value:e.editForm.projectAmountData[a],callback:function(t){e.$set(e.editForm.projectAmountData,a,t)},expression:"editForm.projectAmountData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.projectAmountData&&e.customer.projectAmountData[a]?e.customer.projectAmountData[a]+"万元":"未填写"))])],1)],1)],1)],1)})),0)],1),t("el-collapse-item",{attrs:{title:"企业投资情况",name:"investment"}},[t("el-form",{ref:"investmentForm",staticClass:"detail-form",attrs:{model:e.editForm,"label-width":"180px"}},e._l(e.recentYears,(function(a){return t("div",{key:"investment-"+a},[t("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(a)+"年投资情况")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"研发设备原值"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入设备原值",controls:!1},model:{value:e.editForm.rdEquipmentOriginalValueData[a],callback:function(t){e.$set(e.editForm.rdEquipmentOriginalValueData,a,t)},expression:"editForm.rdEquipmentOriginalValueData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.rdEquipmentOriginalValueData&&e.customer.rdEquipmentOriginalValueData[a]?e.customer.rdEquipmentOriginalValueData[a]+"万元":"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"是否有审计报告"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.hasAuditReportData[a],callback:function(t){e.$set(e.editForm.hasAuditReportData,a,t)},expression:"editForm.hasAuditReportData[year]"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:e.customer.hasAuditReportData&&"1"===e.customer.hasAuditReportData[a]?"success":"info"}},[e._v(" "+e._s(e.customer.hasAuditReportData&&"1"===e.customer.hasAuditReportData[a]?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"资产负债率"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:100,precision:2,placeholder:"请输入资产负债率",controls:!1},model:{value:e.editForm.assetLiabilityRatioData[a],callback:function(t){e.$set(e.editForm.assetLiabilityRatioData,a,t)},expression:"editForm.assetLiabilityRatioData[year]"}},[t("template",{slot:"append"},[e._v("%")])],2):t("span",[e._v(e._s(e.customer.assetLiabilityRatioData&&e.customer.assetLiabilityRatioData[a]?e.customer.assetLiabilityRatioData[a]+"%":"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"固定资产投资"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入固定资产投资",controls:!1},model:{value:e.editForm.fixedAssetInvestmentData[a],callback:function(t){e.$set(e.editForm.fixedAssetInvestmentData,a,t)},expression:"editForm.fixedAssetInvestmentData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.fixedAssetInvestmentData&&e.customer.fixedAssetInvestmentData[a]?e.customer.fixedAssetInvestmentData[a]+"万元":"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"设备投资"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入设备投资",controls:!1},model:{value:e.editForm.equipmentInvestmentData[a],callback:function(t){e.$set(e.editForm.equipmentInvestmentData,a,t)},expression:"editForm.equipmentInvestmentData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.equipmentInvestmentData&&e.customer.equipmentInvestmentData[a]?e.customer.equipmentInvestmentData[a]+"万元":"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"智能设备投资"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入智能设备投资",controls:!1},model:{value:e.editForm.smartEquipmentInvestmentData[a],callback:function(t){e.$set(e.editForm.smartEquipmentInvestmentData,a,t)},expression:"editForm.smartEquipmentInvestmentData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.smartEquipmentInvestmentData&&e.customer.smartEquipmentInvestmentData[a]?e.customer.smartEquipmentInvestmentData[a]+"万元":"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"研发设备投资"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入研发设备投资",controls:!1},model:{value:e.editForm.rdEquipmentInvestmentData[a],callback:function(t){e.$set(e.editForm.rdEquipmentInvestmentData,a,t)},expression:"editForm.rdEquipmentInvestmentData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.rdEquipmentInvestmentData&&e.customer.rdEquipmentInvestmentData[a]?e.customer.rdEquipmentInvestmentData[a]+"万元":"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"信息化投资"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入信息化投资",controls:!1},model:{value:e.editForm.itInvestmentData[a],callback:function(t){e.$set(e.editForm.itInvestmentData,a,t)},expression:"editForm.itInvestmentData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.itInvestmentData&&e.customer.itInvestmentData[a]?e.customer.itInvestmentData[a]+"万元":"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"是否进口设备"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.hasImportedEquipmentData[a],callback:function(t){e.$set(e.editForm.hasImportedEquipmentData,a,t)},expression:"editForm.hasImportedEquipmentData[year]"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:e.customer.hasImportedEquipmentData&&"1"===e.customer.hasImportedEquipmentData[a]?"success":"info"}},[e._v(" "+e._s(e.customer.hasImportedEquipmentData&&"1"===e.customer.hasImportedEquipmentData[a]?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"是否有投资备案表"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.hasInvestmentRecordData[a],callback:function(t){e.$set(e.editForm.hasInvestmentRecordData,a,t)},expression:"editForm.hasInvestmentRecordData[year]"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:e.customer.hasInvestmentRecordData&&"1"===e.customer.hasInvestmentRecordData[a]?"success":"info"}},[e._v(" "+e._s(e.customer.hasInvestmentRecordData&&"1"===e.customer.hasInvestmentRecordData[a]?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"备案金额"}},[e.isEditMode?t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入备案金额",controls:!1},model:{value:e.editForm.recordAmountData[a],callback:function(t){e.$set(e.editForm.recordAmountData,a,t)},expression:"editForm.recordAmountData[year]"}},[t("template",{slot:"append"},[e._v("万元")])],2):t("span",[e._v(e._s(e.customer.recordAmountData&&e.customer.recordAmountData[a]?e.customer.recordAmountData[a]+"万元":"未填写"))])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:a+"备案起止时间"}},[e.isEditMode?t("el-input",{attrs:{placeholder:"请输入备案起止时间"},model:{value:e.editForm.recordPeriodData[a],callback:function(t){e.$set(e.editForm.recordPeriodData,a,t)},expression:"editForm.recordPeriodData[year]"}}):t("span",[e._v(e._s(e.customer.recordPeriodData&&e.customer.recordPeriodData[a]||"未填写"))])],1)],1)],1)],1)})),0)],1),t("el-collapse-item",{attrs:{title:"公司资质",name:"qualificationInfo"}},[t("el-form",{ref:"qualificationForm",staticClass:"detail-form",attrs:{model:e.editForm,"label-width":"160px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"经信口是否验收"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.isJinxinVerified,callback:function(t){e.$set(e.editForm,"isJinxinVerified",t)},expression:"editForm.isJinxinVerified"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:"1"===e.customer.isJinxinVerified?"success":"info"}},[e._v(" "+e._s("1"===e.customer.isJinxinVerified?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"经信口验收时间"}},[e.isEditMode?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.jinxinVerifyDate,callback:function(t){e.$set(e.editForm,"jinxinVerifyDate",t)},expression:"editForm.jinxinVerifyDate"}}):t("span",[e._v(e._s(e.customer.jinxinVerifyDate||"未填写"))])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"科技口是否验收"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.isScienceVerified,callback:function(t){e.$set(e.editForm,"isScienceVerified",t)},expression:"editForm.isScienceVerified"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:"1"===e.customer.isScienceVerified?"success":"info"}},[e._v(" "+e._s("1"===e.customer.isScienceVerified?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"科技口验收时间"}},[e.isEditMode?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.scienceVerifyDate,callback:function(t){e.$set(e.editForm,"scienceVerifyDate",t)},expression:"editForm.scienceVerifyDate"}}):t("span",[e._v(e._s(e.customer.scienceVerifyDate||"未填写"))])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"高企"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.highTechEnterprise,callback:function(t){e.$set(e.editForm,"highTechEnterprise",t)},expression:"editForm.highTechEnterprise"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:"1"===e.customer.highTechEnterprise?"success":"info"}},[e._v(" "+e._s("1"===e.customer.highTechEnterprise?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"高企认定时间"}},[e.isEditMode?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.highTechDate,callback:function(t){e.$set(e.editForm,"highTechDate",t)},expression:"editForm.highTechDate"}}):t("span",[e._v(e._s(e.customer.highTechDate||"未填写"))])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"省企"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.provinceEnterprise,callback:function(t){e.$set(e.editForm,"provinceEnterprise",t)},expression:"editForm.provinceEnterprise"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:"1"===e.customer.provinceEnterprise?"success":"info"}},[e._v(" "+e._s("1"===e.customer.provinceEnterprise?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"省企认定时间"}},[e.isEditMode?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.provinceEnterpriseDate,callback:function(t){e.$set(e.editForm,"provinceEnterpriseDate",t)},expression:"editForm.provinceEnterpriseDate"}}):t("span",[e._v(e._s(e.customer.provinceEnterpriseDate||"未填写"))])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"市企"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.cityEnterprise,callback:function(t){e.$set(e.editForm,"cityEnterprise",t)},expression:"editForm.cityEnterprise"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:"1"===e.customer.cityEnterprise?"success":"info"}},[e._v(" "+e._s("1"===e.customer.cityEnterprise?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"市企认定时间"}},[e.isEditMode?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.cityEnterpriseDate,callback:function(t){e.$set(e.editForm,"cityEnterpriseDate",t)},expression:"editForm.cityEnterpriseDate"}}):t("span",[e._v(e._s(e.customer.cityEnterpriseDate||"未填写"))])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"省级工程技术中心"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.provinceTechCenter,callback:function(t){e.$set(e.editForm,"provinceTechCenter",t)},expression:"editForm.provinceTechCenter"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:"1"===e.customer.provinceTechCenter?"success":"info"}},[e._v(" "+e._s("1"===e.customer.provinceTechCenter?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"省级工程技术中心认定时间"}},[e.isEditMode?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.provinceTechCenterDate,callback:function(t){e.$set(e.editForm,"provinceTechCenterDate",t)},expression:"editForm.provinceTechCenterDate"}}):t("span",[e._v(e._s(e.customer.provinceTechCenterDate||"未填写"))])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"知识产权贯标"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.ipStandard,callback:function(t){e.$set(e.editForm,"ipStandard",t)},expression:"editForm.ipStandard"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:"1"===e.customer.ipStandard?"success":"info"}},[e._v(" "+e._s("1"===e.customer.ipStandard?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"知识产权贯标认定时间"}},[e.isEditMode?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.ipStandardDate,callback:function(t){e.$set(e.editForm,"ipStandardDate",t)},expression:"editForm.ipStandardDate"}}):t("span",[e._v(e._s(e.customer.ipStandardDate||"未填写"))])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"两化融合贯标"}},[e.isEditMode?t("el-radio-group",{model:{value:e.editForm.itStandard,callback:function(t){e.$set(e.editForm,"itStandard",t)},expression:"editForm.itStandard"}},[t("el-radio",{attrs:{label:"1"}},[e._v("是")]),t("el-radio",{attrs:{label:"0"}},[e._v("否")])],1):t("el-tag",{attrs:{type:"1"===e.customer.itStandard?"success":"info"}},[e._v(" "+e._s("1"===e.customer.itStandard?"是":"否")+" ")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"两化融合贯标认定时间"}},[e.isEditMode?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd"},model:{value:e.editForm.infoStandardDate,callback:function(t){e.$set(e.editForm,"infoStandardDate",t)},expression:"editForm.infoStandardDate"}}):t("span",[e._v(e._s(e.customer.infoStandardDate||e.customer.itStandardDate||"未填写"))])],1)],1)],1)],1)],1)],1),t("el-divider",{attrs:{"content-position":"left"}},[e._v("备注信息")]),t("div",{staticClass:"info-section remark-section"},[t("el-form",{ref:"remarkForm",staticClass:"detail-form",attrs:{model:e.editForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"备注"}},[e.isEditMode?t("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"请输入备注信息"},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}}):t("span",[e._v(e._s(e.customer.remark||"暂无备注"))])],1)],1)],1)],1)]},proxy:!0},{key:"contact",fn:function(){return[t("div",{staticClass:"tab-content"},[t("CustomerContactsTab",{attrs:{customerId:e.customerId}})],1)]},proxy:!0},{key:"applicant",fn:function(){return[t("div",{staticClass:"tab-content"},[t("CustomerApplicantTab",{attrs:{customerId:e.customerId}})],1)]},proxy:!0},{key:"inventor",fn:function(){return[t("div",{staticClass:"tab-content"},[t("CustomerInventorTab",{attrs:{customerId:e.customerId}})],1)]},proxy:!0},{key:"contract",fn:function(){return[t("div",{staticClass:"tab-content"},[t("CustomerContractTab",{attrs:{customerId:e.customerId}})],1)]},proxy:!0},{key:"file",fn:function(){return[t("div",{staticClass:"tab-content"},[t("CustomerFileTab",{attrs:{customerId:e.customerId}})],1)]},proxy:!0},{key:"case",fn:function(){return[t("div",{staticClass:"tab-content"},[t("CustomerCaseTab",{attrs:{customerId:e.customerId}})],1)]},proxy:!0},{key:"contact-person",fn:function(){return[t("div",{staticClass:"tab-content"},[t("CustomerRelatedPersonTab",{attrs:{customerId:e.customerId}})],1)]},proxy:!0}])}),t("el-dialog",{attrs:{title:"管理业务人员",visible:e.showBusinessPersonDialog,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.showBusinessPersonDialog=t}}},[t("div",{staticClass:"business-person-management"},[t("div",{staticClass:"current-persons"},[t("h4",[e._v("当前业务人员")]),e.customerBusinessPersons&&e.customerBusinessPersons.length>0?t("div",e._l(e.customerBusinessPersons,(function(a){return t("el-tag",{key:a.id,staticStyle:{"margin-right":"8px","margin-bottom":"8px"},attrs:{type:"primary",size:"medium",closable:""},on:{close:function(t){return e.removeBusinessPerson(a)}}},[e._v(" "+e._s(a.name)+" ")])})),1):t("div",{staticStyle:{color:"#909399","font-style":"italic"}},[e._v(" 暂无业务人员 ")])]),t("div",{staticClass:"add-person",staticStyle:{"margin-top":"20px"}},[t("h4",[e._v("添加业务人员")]),t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"",placeholder:"请选择业务人员"},model:{value:e.selectedBusinessPersons,callback:function(t){e.selectedBusinessPersons=t},expression:"selectedBusinessPersons"}},e._l(e.businessPersonOptions,(function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value,disabled:e.isBusinessPersonSelected(a.value)}})})),1)],1)]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.showBusinessPersonDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveBusinessPersons}},[e._v("确 定")])],1)])],1)},i=[],r=(a("d9e2"),a("14d9"),a("e9f5"),a("f665"),a("7d54"),a("ab43"),a("a732"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"tabs-nav-container"},[t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleTabClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(e.tabs,(function(a){return t("el-tab-pane",{key:a.name,attrs:{label:a.label,name:a.name}},[e._t(a.name)],2)})),1)],1)}),o=[],l={name:"TabsNav",props:{tabs:{type:Array,required:!0,default:()=>[]},defaultActive:{type:String,default:""}},data(){return{activeTab:this.defaultActive||(this.tabs.length>0?this.tabs[0].name:"")}},watch:{defaultActive(e){e&&(this.activeTab=e)}},methods:{handleTabClick(e){this.$emit("tab-click",e.name)},setActiveTab(e){this.tabs.some(t=>t.name===e)&&(this.activeTab=e)}}},n=l,c=(a("68872"),a("2877")),d=Object(c["a"])(n,r,o,!1,null,null,null),m=d.exports,p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-file-container"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("文件管理")]),t("div",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload2"},on:{click:e.handleUpload}},[e._v("上传文件")])],1)]),t("div",{staticClass:"search-container"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.queryParams}},[t("el-form-item",[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"文件名称",clearable:""},model:{value:e.queryParams.fileName,callback:function(t){e.$set(e.queryParams,"fileName",t)},expression:"queryParams.fileName"}})],1),t("el-form-item",[t("el-cascader",{staticStyle:{width:"200px"},attrs:{options:e.fileTypeOptions,props:{checkStrictly:!0,value:"code",label:"label",children:"children"},placeholder:"文件类型",clearable:""},model:{value:e.queryParams.fileType,callback:function(t){e.$set(e.queryParams,"fileType",t)},expression:"queryParams.fileType"}})],1),t("el-form-item",[t("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.getFileList}},[e._v("查询")]),t("el-button",{attrs:{plain:"",icon:"el-icon-refresh"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.fileList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),t("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t("el-table-column",{attrs:{label:"文件名称",prop:"fileName","min-width":"200","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"file-name-container"},[t("i",{staticClass:"file-icon",class:e.getFileIcon(a.row.fileExt)}),t("el-tooltip",{attrs:{content:a.row.fileName,placement:"top"}},[t("span",{staticClass:"file-name-text"},[e._v(e._s(a.row.fileName))])])],1)]}}])}),t("el-table-column",{attrs:{label:"文件类型",prop:"fileType",width:"100",align:"center"}}),t("el-table-column",{attrs:{label:"大小",prop:"fileSize",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatFileSize(t.row.fileSize))+" ")]}}])}),t("el-table-column",{attrs:{label:"上传时间",prop:"uploadTime",width:"180",align:"center"}}),t("el-table-column",{attrs:{label:"上传人",prop:"uploader",width:"120",align:"center"}}),t("el-table-column",{attrs:{label:"权限",prop:"permission",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return["公开"===a.row.permission?t("el-tag",{attrs:{type:"success"}},[e._v("公开")]):"部门"===a.row.permission?t("el-tag",{attrs:{type:"warning"}},[e._v("部门")]):t("el-tag",{attrs:{type:"danger"}},[e._v("私有")])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"250",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handlePreview(a.row)}}},[e._v(" "+e._s(e.canPreview(a.row)?"预览":"查看")+" ")]),t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-download"},on:{click:function(t){return e.handleDownload(a.row)}}},[e._v("下载")]),t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-s-tools"},on:{click:function(t){return e.handlePermission(a.row)}}},[e._v("权限")]),t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"上传文件",visible:e.uploadVisible,width:"600px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.uploadVisible=t}}},[t("el-form",{ref:"uploadForm",attrs:{model:e.uploadForm,rules:e.uploadRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"文件类型",prop:"fileType"}},[t("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.fileTypeOptions,props:{checkStrictly:!0,value:"code",label:"label",children:"children"},placeholder:"请选择文件类型",clearable:""},model:{value:e.uploadForm.fileType,callback:function(t){e.$set(e.uploadForm,"fileType",t)},expression:"uploadForm.fileType"}})],1),t("el-form-item",{attrs:{label:"权限设置",prop:"permission"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择文件权限"},on:{change:e.handlePermissionChange},model:{value:e.uploadForm.permission,callback:function(t){e.$set(e.uploadForm,"permission",t)},expression:"uploadForm.permission"}},[t("el-option",{attrs:{label:"公开",value:"公开"}}),t("el-option",{attrs:{label:"部门",value:"部门"}}),t("el-option",{attrs:{label:"私有",value:"私有"}})],1)],1),"部门"===e.uploadForm.permission?t("el-form-item",{attrs:{label:"部门选择",prop:"department"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择部门",multiple:""},model:{value:e.uploadForm.department,callback:function(t){e.$set(e.uploadForm,"department",t)},expression:"uploadForm.department"}},e._l(e.departmentOptions,(function(e){return t("el-option",{key:e.code,attrs:{label:e.label,value:e.code}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入文件备注",rows:2},model:{value:e.uploadForm.remark,callback:function(t){e.$set(e.uploadForm,"remark",t)},expression:"uploadForm.remark"}})],1),t("el-form-item",{attrs:{label:"文件上传",prop:"files"}},[t("el-upload",{staticClass:"upload-demo",attrs:{action:"#","http-request":e.customUpload,"on-preview":e.handleUploadPreview,"on-remove":e.handleUploadRemove,"before-remove":e.beforeUploadRemove,"file-list":e.uploadFileList,limit:5,multiple:""}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持各种格式文件，单个文件不超过20MB")])],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建人",prop:"creator"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.uploadForm.creator,callback:function(t){e.$set(e.uploadForm,"creator",t)},expression:"uploadForm.creator"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建时间",prop:"createTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.uploadForm.createTime,callback:function(t){e.$set(e.uploadForm,"createTime",t)},expression:"uploadForm.createTime"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新人",prop:"updater"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.uploadForm.updater,callback:function(t){e.$set(e.uploadForm,"updater",t)},expression:"uploadForm.updater"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间",prop:"updateTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.uploadForm.updateTime,callback:function(t){e.$set(e.uploadForm,"updateTime",t)},expression:"uploadForm.updateTime"}})],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.uploadVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary",loading:e.uploadLoading},on:{click:e.submitUpload}},[e._v("上 传")])],1)],1),t("el-dialog",{attrs:{title:"权限设置",visible:e.permissionVisible,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.permissionVisible=t}}},[t("el-form",{ref:"permissionForm",attrs:{model:e.permissionForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"文件名称"}},[t("span",[e._v(e._s(e.permissionForm.fileName))])]),t("el-form-item",{attrs:{label:"权限设置",prop:"permission"}},[t("el-radio-group",{model:{value:e.permissionForm.permission,callback:function(t){e.$set(e.permissionForm,"permission",t)},expression:"permissionForm.permission"}},[t("el-radio",{attrs:{label:"公开"}},[e._v("公开（所有人可访问）")]),t("el-radio",{attrs:{label:"部门"}},[e._v("部门（仅部门成员可访问）")]),t("el-radio",{attrs:{label:"私有"}},[e._v("私有（仅创建人可访问）")])],1)],1),"部门"===e.permissionForm.permission?t("el-form-item",{attrs:{label:"部门选择"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择部门"},model:{value:e.permissionForm.departments,callback:function(t){e.$set(e.permissionForm,"departments",t)},expression:"permissionForm.departments"}},e._l(e.departmentOptions,(function(e){return t("el-option",{key:e.code,attrs:{label:e.label,value:e.label}})})),1)],1):e._e(),"私有"===e.permissionForm.permission?t("el-form-item",{attrs:{label:"指定用户"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择用户"},model:{value:e.permissionForm.users,callback:function(t){e.$set(e.permissionForm,"users",t)},expression:"permissionForm.users"}},e._l(e.userOptions,(function(e){return t("el-option",{key:e.code,attrs:{label:e.label,value:e.label}})})),1)],1):e._e()],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.permissionVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitPermission}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"文件预览",visible:e.previewVisible,width:"70%","append-to-body":""},on:{"update:visible":function(t){e.previewVisible=t}}},[e.previewFile?t("div",{staticClass:"preview-container"},[e.canPreview(e.previewFile)?t("div",{staticClass:"preview-content"},["pdf"===e.previewFile.fileExt?t("iframe",{attrs:{src:e.previewFile.url,width:"100%",height:"600"}}):e.isImage(e.previewFile.fileExt)?t("img",{staticStyle:{"max-width":"100%","max-height":"600px"},attrs:{src:e.previewFile.url}}):t("div",{staticClass:"preview-error"},[e._v("该文件类型暂不支持在线预览")])]):t("div",{staticClass:"preview-error"},[t("i",{staticClass:"el-icon-warning-outline"}),t("p",[e._v("该文件类型暂不支持在线预览，请下载后查看")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleDownload(e.previewFile)}}},[e._v("下载文件")])],1),t("div",{staticClass:"preview-info"},[t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("文件名称：")]),t("span",[e._v(e._s(e.previewFile.fileName))])]),t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("文件类型：")]),t("span",[e._v(e._s(e.previewFile.fileType))])]),t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("文件大小：")]),t("span",[e._v(e._s(e.formatFileSize(e.previewFile.fileSize)))])]),t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("上传时间：")]),t("span",[e._v(e._s(e.previewFile.uploadTime))])]),t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("上传人：")]),t("span",[e._v(e._s(e.previewFile.uploader))])]),e.previewFile.remark?t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("备注：")]),t("span",[e._v(e._s(e.previewFile.remark))])]):e._e(),t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("创建人：")]),t("span",[e._v(e._s(e.previewFile.creator||"无"))])]),t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("创建时间：")]),t("span",[e._v(e._s(e.previewFile.createTime||"无"))])]),t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("更新人：")]),t("span",[e._v(e._s(e.previewFile.updater||"无"))])]),t("div",{staticClass:"preview-info-item"},[t("span",{staticClass:"label"},[e._v("更新时间：")]),t("span",[e._v(e._s(e.previewFile.updateTime||"无"))])])])]):e._e()])],1)},u=[],h=(a("88a7"),a("271a"),a("5494"),a("f6b0")),f={name:"CustomerFileTab",props:{customerId:{type:[String,Number],required:!0}},data(){return{loading:!1,fileList:[],pageNum:1,pageSize:10,total:0,dateRange:[],queryParams:{fileName:"",fileType:[],beginDate:"",endDate:""},uploadVisible:!1,uploadLoading:!1,uploadForm:{fileType:[],permission:"公开",remark:"",creator:"",createTime:"",updater:"",updateTime:"",department:[]},uploadRules:{fileType:[{required:!1,message:"请选择文件类型",trigger:"change"}],permission:[{required:!0,message:"请选择文件权限",trigger:"change"}],department:[{required:!1,validator:(e,t,a)=>{"部门"!==this.uploadForm.permission||t&&0!==t.length?a():a(new Error("请选择部门"))},trigger:"change"}]},uploadFileList:[],permissionVisible:!1,permissionForm:{id:void 0,fileName:"",permission:"部门",departments:[],users:[]},previewVisible:!1,previewFile:null,fileTypeOptions:[{code:"document",label:"文档资料",value:"document",children:[{code:"contract",label:"合同协议",value:"contract"},{code:"report",label:"报告文档",value:"report"},{code:"certificate",label:"证书证明",value:"certificate"},{code:"application",label:"申请材料",value:"application"}]},{code:"patent",label:"专利资料",value:"patent",children:[{code:"patent-application",label:"专利申请书",value:"patent-application"},{code:"patent-certificate",label:"专利证书",value:"patent-certificate"},{code:"patent-drawing",label:"专利附图",value:"patent-drawing"},{code:"patent-description",label:"说明书",value:"patent-description"}]},{code:"trademark",label:"商标资料",value:"trademark",children:[{code:"trademark-application",label:"商标申请书",value:"trademark-application"},{code:"trademark-certificate",label:"商标注册证",value:"trademark-certificate"},{code:"trademark-design",label:"商标设计稿",value:"trademark-design"},{code:"trademark-usage",label:"商标使用证明",value:"trademark-usage"}]},{code:"copyright",label:"版权资料",value:"copyright",children:[{code:"copyright-application",label:"版权申请书",value:"copyright-application"},{code:"copyright-certificate",label:"版权登记证",value:"copyright-certificate"},{code:"copyright-work",label:"作品文件",value:"copyright-work"}]},{code:"image",label:"图片资料",value:"image",children:[{code:"design-draft",label:"设计稿",value:"design-draft"},{code:"photo",label:"照片",value:"photo"},{code:"screenshot",label:"截图",value:"screenshot"}]},{code:"other",label:"其他资料",value:"other",children:[{code:"archive",label:"压缩包",value:"archive"},{code:"video",label:"视频文件",value:"video"},{code:"audio",label:"音频文件",value:"audio"},{code:"misc",label:"其他文件",value:"misc"}]}],departmentOptions:[{code:"patent",label:"专利部"},{code:"trademark",label:"商标部"},{code:"copyright",label:"版权部"},{code:"legal",label:"法务部"},{code:"finance",label:"财务部"},{code:"business",label:"业务部"},{code:"market",label:"市场部"},{code:"admin",label:"行政部"}],userOptions:[{code:"zhangsan",label:"张三"},{code:"lisi",label:"李四"},{code:"wangwu",label:"王五"},{code:"zhaoliu",label:"赵六"},{code:"zhangmanager",label:"张经理"},{code:"lispecialist",label:"李专员"},{code:"wangsupervisor",label:"王主管"},{code:"zhaodirector",label:"赵总监"},{code:"zhoumanger",label:"周经理"}]}},watch:{dateRange(e){e?(this.queryParams.beginDate=e[0],this.queryParams.endDate=e[1]):(this.queryParams.beginDate="",this.queryParams.endDate="")},customerId:{handler(e){e&&this.getFileList()},immediate:!0}},created(){this.customerId&&this.getFileList()},methods:{async getFileList(){if(this.customerId){this.loading=!0;try{const e={customer_id:this.customerId,page:this.pageNum,page_size:this.pageSize,file_name:this.queryParams.fileName,file_type:Array.isArray(this.queryParams.fileType)&&this.queryParams.fileType.length>0?this.queryParams.fileType[this.queryParams.fileType.length-1]:void 0,begin_date:this.queryParams.beginDate,end_date:this.queryParams.endDate};Object.keys(e).forEach(t=>(void 0===e[t]||""===e[t])&&delete e[t]);const t=await h["a"].getFileList(e),a=t&&t.data&&t.data.data?t.data.data:{list:[],total:0};this.fileList=(a.list||[]).map(e=>({id:e.id,fileName:e.fileName||e.file_name,fileType:e.fileType||e.file_type,fileExt:(e.fileExt||e.file_type||"").toLowerCase(),fileSize:e.fileSize||e.file_size,uploadTime:e.created_at||e.uploadTime,uploader:e.uploader||e.createUser||e.create_user,permission:e.permission||(void 0===e.isPrivate?"公开":e.isPrivate?"私有":"公开"),permissionType:e.permissionType||e.permission_type||"public",allowedDepartments:e.allowedDepartments||e.allowed_departments||[],allowedUsers:e.allowedUsers||e.allowed_users||[],url:e.downloadUrl||e.download_url||"",remark:e.remark||e.fileDescription||e.file_description||"",creator:e.creator||e.createUser||e.create_user||"",createTime:e.createTime||e.create_time||e.created_at||"",updater:e.updater||e.updateUser||e.update_user||"",updateTime:e.updateTime||e.update_time||e.updated_at||""})),this.total=a.total||0}catch(e){console.error("获取文件列表失败:",e),this.$message.error("获取文件列表失败"),this.fileList=[],this.total=0}finally{this.loading=!1}}},resetQuery(){this.dateRange=[],this.queryParams={fileName:"",fileType:[],beginDate:"",endDate:""},this.getFileList()},getFileIcon(e){const t={pdf:"el-icon-document",doc:"el-icon-document-word",docx:"el-icon-document-word",xls:"el-icon-document-excel",xlsx:"el-icon-document-excel",ppt:"el-icon-document-ppt",pptx:"el-icon-document-ppt",jpg:"el-icon-picture",jpeg:"el-icon-picture",png:"el-icon-picture",gif:"el-icon-picture",zip:"el-icon-folder",rar:"el-icon-folder",txt:"el-icon-document"};return t[e.toLowerCase()]||"el-icon-document"},formatFileSize(e){return e<1024?e+" B":e<1048576?(e/1024).toFixed(2)+" KB":e<1073741824?(e/1048576).toFixed(2)+" MB":(e/1073741824).toFixed(2)+" GB"},canPreview(e){const t=["pdf","jpg","jpeg","png","gif"];return t.includes(e.fileExt.toLowerCase())},isImage(e){return["jpg","jpeg","png","gif"].includes(e.toLowerCase())},getCurrentUser(){return"当前用户"},getCurrentTime(){return(new Date).toLocaleString("zh-CN")},handleUpload(){this.uploadForm={fileType:[],permission:"公开",remark:"",creator:this.getCurrentUser(),createTime:this.getCurrentTime(),updater:this.getCurrentUser(),updateTime:this.getCurrentTime(),department:[]},this.uploadFileList=[],this.uploadVisible=!0,this.$nextTick(()=>{this.$refs.uploadForm&&this.$refs.uploadForm.clearValidate()})},customUpload(e){const{file:t,onSuccess:a,onError:s}=e;t.size>20971520?s("文件大小不能超过20MB"):t&&t.name?(this.uploadFileList.push({name:t.name,size:t.size,raw:t,status:"ready"}),a()):s("无效的文件")},handleUploadPreview(e){console.log("预览文件",e)},handleUploadRemove(e,t){this.uploadFileList=t},beforeUploadRemove(e,t){return this.$confirm(`确定移除 ${e.name}？`)},submitUpload(){0!==this.uploadFileList.length?this.$refs.uploadForm.validate(async(e,t)=>{if(e){this.uploadLoading=!0,this.uploadForm.creator=this.getCurrentUser(),this.uploadForm.createTime=this.getCurrentTime(),this.uploadForm.updater=this.getCurrentUser(),this.uploadForm.updateTime=this.getCurrentTime();const e=new FormData;if(e.append("customer_id",this.customerId),this.uploadForm.fileType&&this.uploadForm.fileType.length>0&&e.append("file_category",this.uploadForm.fileType[this.uploadForm.fileType.length-1]),e.append("is_private","私有"===this.uploadForm.permission?1:0),this.uploadForm.remark&&e.append("file_description",this.uploadForm.remark),0===this.uploadFileList.length)return this.$message.error("请选择要上传的文件"),void(this.uploadLoading=!1);const t=this.uploadFileList[0].raw;if(!t)return this.$message.error("文件对象无效"),void(this.uploadLoading=!1);e.append("file",t);try{await h["a"].uploadFile(e),this.$message.success("文件上传成功"),this.uploadVisible=!1,this.getFileList()}catch(a){console.error("上传失败:",a),this.$message.error("上传失败")}finally{this.uploadLoading=!1}}else this.$message.error("请完善表单信息")}):this.$message.warning("请至少上传一个文件")},async handleDownload(e){try{const t=await h["a"].downloadFile(e.id),a=new Blob([t.data]),s=window.URL.createObjectURL(a),i=document.createElement("a");i.href=s,i.download=e.fileName||"download",document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(s),document.body.removeChild(i)}catch(t){console.error("下载失败:",t),this.$message.error("下载失败")}},handlePermissionChange(e){"部门"!==e&&(this.uploadForm.department=[])},handlePermission(e){this.permissionForm={id:e.id,fileName:e.fileName,permission:e.permission,departments:e.allowedDepartments||("部门"===e.permission?["专利部"]:[]),users:e.allowedUsers||("私有"===e.permission?[e.uploader]:[])},this.permissionVisible=!0},async submitPermission(){try{const e={permission:this.permissionForm.permission,departments:this.permissionForm.departments||[],users:this.permissionForm.users||[]};await h["a"].updateFile(this.permissionForm.id,e),this.$message.success("权限设置成功"),this.permissionVisible=!1,this.getFileList()}catch(e){console.error("权限设置失败:",e),this.$message.error("权限设置失败")}},handlePreview(e){this.previewFile=e,this.previewVisible=!0},async handleDelete(e){this.$confirm(`确认删除文件 ${e.fileName}?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await h["a"].deleteFile(e.id),this.$message.success("删除成功"),this.getFileList()}catch(t){console.error("删除文件失败:",t),this.$message.error("删除失败")}}).catch(()=>{})},handleSizeChange(e){this.pageSize=e,this.getFileList()},handleCurrentChange(e){this.pageNum=e,this.getFileList()}}},b=f,v=(a("2d22"),Object(c["a"])(b,p,u,!1,null,null,null)),_=v.exports,g=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-contacts-container"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("联系人列表")]),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("添加联系人")])],1),t("div",{staticClass:"search-container"},[t("el-input",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"姓名",clearable:""},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}}),t("el-input",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"手机",clearable:""},model:{value:e.queryParams.phone,callback:function(t){e.$set(e.queryParams,"phone",t)},expression:"queryParams.phone"}}),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.getContactList}},[e._v("查询")]),t("el-button",{attrs:{plain:"",icon:"el-icon-refresh"},on:{click:e.resetQuery}},[e._v("重置")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.contactList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),t("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t("el-table-column",{attrs:{label:"姓名",prop:"contact_name",align:"center",width:"100"}}),t("el-table-column",{attrs:{label:"联系人类型",prop:"contact_type",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"手机",prop:"phone",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"性别",prop:"gender",align:"center",width:"60"}}),t("el-table-column",{attrs:{label:"是否在职",prop:"is_on_job",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.is_on_job?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"info"}},[e._v("否")])]}}])}),t("el-table-column",{attrs:{label:"联系人部门",prop:"department",align:"center"}}),t("el-table-column",{attrs:{label:"联系人业务人员",prop:"business_staff_name",align:"center"}}),t("el-table-column",{attrs:{label:"联系人备注",prop:"remark",align:"center"}}),t("el-table-column",{attrs:{label:"工作邮箱",prop:"work_email",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleView(a.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"650px","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"联系人名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"联系人类型",prop:"contactType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.form.contactType,callback:function(t){e.$set(e.form,"contactType",t)},expression:"form.contactType"}},[t("el-option",{attrs:{label:"IPR",value:"IPR"}}),t("el-option",{attrs:{label:"流程人员",value:"流程人员"}}),t("el-option",{attrs:{label:"技术人员",value:"技术人员"}}),t("el-option",{attrs:{label:"财务人员",value:"财务人员"}}),t("el-option",{attrs:{label:"公司负责人",value:"公司负责人"}}),t("el-option",{attrs:{label:"发明人",value:"发明人"}}),t("el-option",{attrs:{label:"文件转送人",value:"文件转送人"}}),t("el-option",{attrs:{label:"商标联系人",value:"商标联系人"}}),t("el-option",{attrs:{label:"其它",value:"其它"}}),t("el-option",{attrs:{label:"技术主导",value:"技术主导"}}),t("el-option",{attrs:{label:"经办人",value:"经办人"}})],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"手机",prop:"phone"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"性别",prop:"gender"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择性别"},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[t("el-option",{attrs:{label:"请选择性别",value:""}}),t("el-option",{attrs:{label:"男",value:"男"}}),t("el-option",{attrs:{label:"女",value:"女"}})],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"座机",prop:"landline"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.landline,callback:function(t){e.$set(e.form,"landline",t)},expression:"form.landline"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"是否在职",prop:"isOnJob"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择是否在职"},model:{value:e.form.isOnJob,callback:function(t){e.$set(e.form,"isOnJob",t)},expression:"form.isOnJob"}},[t("el-option",{attrs:{label:"请选择",value:""}}),t("el-option",{attrs:{label:"是",value:"是"}}),t("el-option",{attrs:{label:"否",value:"否"}})],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"工作邮箱",prop:"workEmail"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.workEmail,callback:function(t){e.$set(e.form,"workEmail",t)},expression:"form.workEmail"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"微信号",prop:"wechat"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.wechat,callback:function(t){e.$set(e.form,"wechat",t)},expression:"form.wechat"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"称呼",prop:"title"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"联系人部门",prop:"department"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.department,callback:function(t){e.$set(e.form,"department",t)},expression:"form.department"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"工作地址",prop:"workAddress"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.workAddress,callback:function(t){e.$set(e.form,"workAddress",t)},expression:"form.workAddress"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",maxlength:"150","show-word-limit":"",rows:"3",placeholder:"请输入"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"联系人业务员",prop:"businessPerson"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择业务人员",clearable:""},model:{value:e.form.businessPersonId,callback:function(t){e.$set(e.form,"businessPersonId",t)},expression:"form.businessPersonId"}},e._l(e.userOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),"编辑联系人"===e.dialogTitle?t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建人",prop:"creator"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.createUserName,callback:function(t){e.$set(e.form,"createUserName",t)},expression:"form.createUserName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建时间",prop:"createTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.createdAt,callback:function(t){e.$set(e.form,"createdAt",t)},expression:"form.createdAt"}})],1)],1)],1):e._e(),"编辑联系人"===e.dialogTitle?t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新人",prop:"updater"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updateUserName,callback:function(t){e.$set(e.form,"updateUserName",t)},expression:"form.updateUserName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间",prop:"updateTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updatedAt,callback:function(t){e.$set(e.form,"updatedAt",t)},expression:"form.updatedAt"}})],1)],1)],1):e._e()],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"联系人详情",visible:e.viewDialogVisible,width:"650px","append-to-body":""},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[t("el-descriptions",{attrs:{border:"",column:2}},[t("el-descriptions-item",{attrs:{label:"联系人名称"}},[e._v(e._s(e.viewForm.name))]),t("el-descriptions-item",{attrs:{label:"联系人类型"}},[e._v(e._s(e.viewForm.contactType))]),t("el-descriptions-item",{attrs:{label:"手机"}},[e._v(e._s(e.viewForm.phone))]),t("el-descriptions-item",{attrs:{label:"性别"}},[e._v(e._s(e.viewForm.gender))]),t("el-descriptions-item",{attrs:{label:"座机"}},[e._v(e._s(e.viewForm.landline||"无"))]),t("el-descriptions-item",{attrs:{label:"是否在职"}},[e.viewForm.isOnJob?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"info"}},[e._v("否")])],1),t("el-descriptions-item",{attrs:{label:"称呼"}},[e._v(e._s(e.viewForm.title||"无"))]),t("el-descriptions-item",{attrs:{label:"联系人部门"}},[e._v(e._s(e.viewForm.department||"无"))]),t("el-descriptions-item",{attrs:{label:"工作地址"}},[e._v(e._s(e.viewForm.workAddress||"无"))]),t("el-descriptions-item",{attrs:{label:"工作邮箱"}},[e._v(e._s(e.viewForm.workEmail||"无"))]),t("el-descriptions-item",{attrs:{label:"微信号"}},[e._v(e._s(e.viewForm.wechat||"无"))]),t("el-descriptions-item",{attrs:{label:"联系人业务员"}},[e._v(e._s(e.viewForm.businessPerson||"无"))]),t("el-descriptions-item",{attrs:{label:"备注",span:2}},[e._v(e._s(e.viewForm.remark||"无"))]),t("el-descriptions-item",{attrs:{label:"创建人"}},[e._v(e._s(e.viewForm.creator||"无"))]),t("el-descriptions-item",{attrs:{label:"创建时间"}},[e._v(e._s(e.viewForm.createTime||"无"))]),t("el-descriptions-item",{attrs:{label:"更新人"}},[e._v(e._s(e.viewForm.updater||"无"))]),t("el-descriptions-item",{attrs:{label:"更新时间"}},[e._v(e._s(e.viewForm.updateTime||"无"))])],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.viewDialogVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},y=[],w=(a("910d"),{name:"CustomerContactsTab",components:{},props:{customerId:{type:[String,Number],required:!0}},data(){return{loading:!1,contactList:[],pageNum:1,pageSize:10,total:0,queryParams:{name:"",phone:""},dialogVisible:!1,dialogTitle:"",viewDialogVisible:!1,viewForm:{},form:{id:null,name:"",contactType:"",phone:"",gender:"男",landline:"",isOnJob:"是",title:"",department:"",workAddress:"",workEmail:"",wechat:"",businessPersonId:"",businessPersonName:"",remark:"",createUserId:"",createUserName:"",createdAt:"",updateUserId:"",updateUserName:"",updatedAt:""},rules:{contactType:[{required:!0,message:"请选择联系人类型",trigger:"blur"}],name:[{required:!0,message:"请输入联系人名称",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"}]},businessPersonName:"",businessPersonDialog:{open:!1,showActive:!0,showInactive:!1,searchText:"",selectedPersons:[]},userOptions:[],organizationTree:[]}},computed:{filteredOrganizationTree(){const e=t=>t.map(t=>{const a={...t};return t.children&&t.children.length>0&&(a.children=e(t.children)),"person"===t.type&&("active"===t.status&&!this.businessPersonDialog.showActive||"inactive"===t.status&&!this.businessPersonDialog.showInactive)?null:a}).filter(e=>null!==e);return e(this.organizationTree)}},created(){this.getContactList(),this.getUserOptions(),this.$root.$on("contact-data-changed",()=>{this.getContactList()})},beforeDestroy(){this.$root.$off("contact-data-changed")},methods:{async getContactList(){try{this.loading=!0;const e={customer_id:this.customerId,page:this.pageNum,page_size:this.pageSize,name:this.queryParams.name,phone:this.queryParams.phone},t=await h["a"].getContactList(e),a=t&&t.data&&t.data.data?t.data.data:{list:[],total:0};this.contactList=(a.list||[]).map(e=>({id:e.id,customer_id:e.customer_id,contact_name:e.name||e.contact_name,contact_type:e.contactType||e.contact_type_text||e.contact_type,phone:e.phone,gender:e.gender,is_on_job:void 0!==e.isOnJob?e.isOnJob:e.is_on_job,department:e.department,title:e.title,business_staff:e.businessStaff||e.business_staff,business_staff_name:e.businessStaffName||e.business_staff_name,landline:e.landline||e.telephone,work_email:e.workEmail||e.work_email||e.email,wechat:e.wechat,work_address:e.workAddress||e.work_address,remark:e.remark||e.remarks,creator:e.createUser||e.creator,created_at:e.createTime||e.created_at,updater:e.updateUser||e.updater,updated_at:e.updateTime||e.updated_at})),this.total=a.total||0}catch(e){console.error("获取联系人列表错误:",e),this.$message.error("获取联系人列表失败"),this.contactList=[],this.total=0}finally{this.loading=!1}},resetQuery(){this.queryParams={name:"",phone:""},this.getContactList()},async getUserOptions(){try{const e=await h["a"].getUserOptions();e&&e.data&&e.data.success?this.userOptions=(e.data.data||[]).map(e=>({id:e.userId,name:e.userName})):this.userOptions=[]}catch(e){console.error("获取用户选项失败:",e),this.userOptions=[]}},handleAdd(){this.form={id:null,name:"",contactType:"",phone:"",gender:"男",landline:"",isOnJob:"是",title:"",department:"",workAddress:"",workEmail:"",wechat:"",businessPersonId:"",businessPersonName:"",remark:"",createUserId:"",createUserName:this.getCurrentUser(),createdAt:this.getCurrentTime(),updateUserId:"",updateUserName:this.getCurrentUser(),updatedAt:this.getCurrentTime()},this.dialogTitle="添加联系人",this.dialogVisible=!0},async handleEdit(e){try{const t=await h["a"].getContact(e.id),a=t.data.data;this.form={id:a.id,name:a.contact_name,contactType:a.contact_type_text||a.contact_type,phone:a.phone,gender:a.gender||"男",landline:a.telephone||a.landline||"",isOnJob:a.is_on_job?"是":"否",title:a.title||"",department:a.department||"",workAddress:a.work_address||a.workAddress||"",workEmail:a.work_email||a.email||"",wechat:a.wechat||"",businessPersonId:a.business_staff_id||"",businessPersonName:a.business_staff_name||"",remark:a.remarks||a.remark||"",createUserId:a.created_by||"",createUserName:a.create_user_name||"无",createdAt:a.created_at||"无",updateUserId:a.updated_by||"",updateUserName:a.update_user_name||"无",updatedAt:a.updated_at||"无"},this.dialogTitle="编辑联系人",this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.form&&this.$refs.form.clearValidate()})}catch(t){console.error("获取联系人详情失败:",t),this.$message.error("获取联系人详情失败")}},async handleView(e){try{const t=await h["a"].getContact(e.id),a=t.data.data;this.viewForm={id:a.id,name:a.contact_name,contactType:a.contact_type_text||a.contact_type,phone:a.phone,gender:a.gender||"无",landline:a.telephone||a.landline||"无",isOnJob:a.is_on_job,title:a.title||"无",department:a.department||"无",workAddress:a.work_address||a.workAddress||"无",workEmail:a.work_email||a.email||"无",wechat:a.wechat||"无",businessPerson:a.business_staff_name||"无",remark:a.remarks||a.remark||"无",creator:a.create_user_name||"无",createTime:a.created_at||"无",updater:a.update_user_name||"无",updateTime:a.updated_at||"无"},this.viewDialogVisible=!0}catch(t){console.error("获取联系人详情失败:",t),this.$message.error("获取联系人详情失败")}},handleDelete(e){this.$confirm("确认删除该联系人?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=await h["a"].deleteContact(e.id);t.data.success?(this.$message.success("删除成功!"),this.getContactList(),this.$emit("contact-updated"),this.$root.$emit&&this.$root.$emit("contact-data-changed")):this.$message.error(t.data.message||"删除失败")}catch(t){console.error("删除联系人错误:",t),this.$message.error("删除失败")}}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},getCurrentUser(){return this.$store&&this.$store.state.user&&this.$store.state.user.name?this.$store.state.user.name:"当前用户"},getCurrentTime(){return(new Date).toLocaleString("zh-CN")},async submitForm(){this.$refs.form.validate(async e=>{if(e)try{const e={customer_id:this.customerId,contact_name:this.form.name,contact_type_text:this.form.contactType,phone:this.form.phone,gender:this.form.gender||null,telephone:this.form.landline||null,is_on_job:"是"===this.form.isOnJob?1:0,position:"",department:this.form.department||null,title:this.form.title||null,email:this.form.workEmail||null,work_email:this.form.workEmail||null,business_staff_id:this.form.businessPersonId||null,work_address:this.form.workAddress||null,wechat:this.form.wechat||null,qq:null,address:null,id_card:null,remarks:this.form.remark||null};let t;t=this.form.id?await h["a"].updateContact(this.form.id,e):await h["a"].createContact(e),t&&t.data&&t.data.success?(this.$message.success("保存成功"),this.dialogVisible=!1,this.getContactList(),this.$emit("contact-updated"),this.$root.$emit&&this.$root.$emit("contact-data-changed")):this.$message.error(t&&t.data&&t.data.message||"保存失败")}catch(t){console.error("保存联系人错误:",t),this.$message.error("保存失败")}})},handleSizeChange(e){this.pageSize=e,this.getContactList()},handleCurrentChange(e){this.pageNum=e,this.getContactList()},openBusinessPersonDialog(){this.businessPersonDialog.open=!0,this.businessPersonDialog.searchText=""},getNodeIcon(e){const t={company:"el-icon-office-building",department:"el-icon-folder",group:"el-icon-folder-opened",person:"el-icon-user"};return t[e.type]||"el-icon-document"},filterBusinessPersonTree(){this.$refs.businessPersonTree&&this.$refs.businessPersonTree.filter(this.businessPersonDialog.searchText)},filterBusinessPersonNode(e,t){return!e||-1!==t.label.indexOf(e)},handleBusinessPersonSearch(){this.filterBusinessPersonTree()},handleBusinessPersonTreeCheck(e,t){if("person"!==e.type)return void this.$nextTick(()=>{this.$refs.businessPersonTree.setChecked(e.id,!1)});const a=t.checkedKeys.filter(e=>{const t=this.findNodeById(e);return t&&"person"===t.type});if(a.length>1){const e=a[a.length-1];this.$refs.businessPersonTree.setCheckedKeys([e]),this.businessPersonDialog.selectedPersons=[e]}else this.businessPersonDialog.selectedPersons=a},findNodeById(e){const t=(e,a)=>{for(const s of e){if(s.id===a)return s;if(s.children&&s.children.length>0){const e=t(s.children,a);if(e)return e}}return null};return t(this.organizationTree,e)},confirmBusinessPersonSelection(){if(0===this.businessPersonDialog.selectedPersons.length)return void this.$message.warning("请选择一个业务员");const e=this.businessPersonDialog.selectedPersons[0],t=this.findNodeById(e);t&&(this.form.businessPersonId=e,this.businessPersonName=t.label,this.$message.success("业务员选择成功")),this.businessPersonDialog.open=!1},cancelBusinessPersonSelection(){this.businessPersonDialog.open=!1,this.businessPersonDialog.selectedPersons=[]},resetBusinessPersonSelection(){this.businessPersonDialog.selectedPersons=[],this.businessPersonDialog.searchText="",this.$refs.businessPersonTree&&this.$refs.businessPersonTree.setCheckedKeys([])}}}),F=w,C=(a("35ff"),Object(c["a"])(F,g,y,!1,null,"7383d572",null)),k=C.exports,D=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-applicant-container"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("申请人列表")]),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增申请人")])],1),t("div",{staticClass:"search-container"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.queryParams}},[t("el-form-item",[t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"申请人名称",clearable:""},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}})],1),t("el-form-item",[t("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"申请人类型",clearable:""},model:{value:e.queryParams.type,callback:function(t){e.$set(e.queryParams,"type",t)},expression:"queryParams.type"}},[t("el-option",{attrs:{label:"工矿企业",value:"工矿企业"}}),t("el-option",{attrs:{label:"个人",value:"个人"}}),t("el-option",{attrs:{label:"大专院校",value:"大专院校"}}),t("el-option",{attrs:{label:"科研单位",value:"科研单位"}}),t("el-option",{attrs:{label:"事业单位",value:"事业单位"}}),t("el-option",{attrs:{label:"协会及合作社",value:"协会及合作社"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.getApplicantList}},[e._v("查询")]),t("el-button",{attrs:{plain:"",icon:"el-icon-refresh"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.applicantList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),t("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t("el-table-column",{attrs:{label:"姓名",prop:"name","min-width":"100",align:"center"}}),t("el-table-column",{attrs:{label:"国籍",prop:"country","min-width":"80",align:"center"}}),t("el-table-column",{attrs:{label:"经常经营地",prop:"address",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"费减备案",prop:"feeReduction","min-width":"100",align:"center"}}),t("el-table-column",{attrs:{label:"费减有效期",prop:"feeReductionPeriod","min-width":"180",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"证件类型",prop:"idType",align:"center"}}),t("el-table-column",{attrs:{label:"证件号",prop:"idNumber",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"申请人备注",prop:"remark","min-width":"120",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"省",prop:"province","min-width":"80",align:"center"}}),t("el-table-column",{attrs:{label:"市",prop:"city","min-width":"80",align:"center"}}),t("el-table-column",{attrs:{label:"区",prop:"district","min-width":"80",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleView(a.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"50%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"140px"}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"申请人名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"申请人名称(英文)",prop:"nameEn"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.nameEn,callback:function(t){e.$set(e.form,"nameEn",t)},expression:"form.nameEn"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"申请人类型",prop:"type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[t("el-option",{attrs:{label:"工矿企业",value:"工矿企业"}}),t("el-option",{attrs:{label:"个人",value:"个人"}}),t("el-option",{attrs:{label:"大专院校",value:"大专院校"}}),t("el-option",{attrs:{label:"科研单位",value:"科研单位"}}),t("el-option",{attrs:{label:"事业单位",value:"事业单位"}}),t("el-option",{attrs:{label:"协会及合作社",value:"协会及合作社"}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"实体类型",prop:"entityType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择实体类型"},model:{value:e.form.entityType,callback:function(t){e.$set(e.form,"entityType",t)},expression:"form.entityType"}},[t("el-option",{attrs:{label:"大实体",value:"大实体"}}),t("el-option",{attrs:{label:"小实体",value:"小实体"}}),t("el-option",{attrs:{label:"微实体",value:"微实体"}})],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"申请人编号",prop:"code"}},[t("el-input",{attrs:{placeholder:"系统自动生成",disabled:""},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"总委托书编号",prop:"totalConditionNo"}},[t("el-input",{attrs:{placeholder:"请输入总委托书编号"},model:{value:e.form.totalConditionNo,callback:function(t){e.$set(e.form,"totalConditionNo",t)},expression:"form.totalConditionNo"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"证件类型",prop:"idType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.form.idType,callback:function(t){e.$set(e.form,"idType",t)},expression:"form.idType"}},[t("el-option",{attrs:{label:"营业执照(信用代码)",value:"营业执照(信用代码)"}}),t("el-option",{attrs:{label:"居民身份证",value:"居民身份证"}}),t("el-option",{attrs:{label:"外国人永久居留身份证",value:"外国人永久居留身份证"}}),t("el-option",{attrs:{label:"普通护照（仅限华侨）",value:"普通护照（仅限华侨）"}}),t("el-option",{attrs:{label:"台湾居民来往内地通行证",value:"台湾居民来往内地通行证"}}),t("el-option",{attrs:{label:"港澳居民来往内地通行证",value:"港澳居民来往内地通行证"}}),t("el-option",{attrs:{label:"非统一社会信用代码",value:"非统一社会信用代码"}}),t("el-option",{attrs:{label:"其它证件",value:"其它证件"}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"证件号",prop:"idNumber"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.idNumber,callback:function(t){e.$set(e.form,"idNumber",t)},expression:"form.idNumber"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"国籍",prop:"country"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择国籍",filterable:""},model:{value:e.form.country,callback:function(t){e.$set(e.form,"country",t)},expression:"form.country"}},e._l(e.countryList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"经常经营地",prop:"address"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"费减备案",prop:"feeReduction"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.feeReduction,callback:function(t){e.$set(e.form,"feeReduction",t)},expression:"form.feeReduction"}},[t("el-option",{attrs:{label:"是",value:"是"}}),t("el-option",{attrs:{label:"否",value:"否"}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"费减有效期",prop:"feeReductionPeriod"}},[t("el-col",{attrs:{span:18}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.form.feeReductionPeriod,callback:function(t){e.$set(e.form,"feeReductionPeriod",t)},expression:"form.feeReductionPeriod"}})],1),t("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("更新费减")])],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"省市区",prop:"areaCode"}},[t("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.areaData,props:{value:"value",label:"label",children:"children"},placeholder:"请选择省市区",clearable:"",filterable:""},on:{change:e.handleFormAreaChange},model:{value:e.form.areaCode,callback:function(t){e.$set(e.form,"areaCode",t)},expression:"form.areaCode"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"街道",prop:"street"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.street,callback:function(t){e.$set(e.form,"street",t)},expression:"form.street"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"邮编",prop:"postalCode"}},[t("el-input",{attrs:{placeholder:"请输入邮编"},model:{value:e.form.postalCode,callback:function(t){e.$set(e.form,"postalCode",t)},expression:"form.postalCode"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"地址（英文）",prop:"addressEn"}},[t("el-input",{attrs:{placeholder:"请输入英文地址"},model:{value:e.form.addressEn,callback:function(t){e.$set(e.form,"addressEn",t)},expression:"form.addressEn"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"经常经营地或营业地",prop:"businessLocation"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.businessLocation,callback:function(t){e.$set(e.form,"businessLocation",t)},expression:"form.businessLocation"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"业务人员",prop:"businessStaff"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择业务人员",filterable:""},on:{change:e.handleBusinessStaffChange},model:{value:e.form.businessStaffId,callback:function(t){e.$set(e.form,"businessStaffId",t)},expression:"form.businessStaffId"}},e._l(e.businessStaffList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.real_name,value:e.id}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"申请人备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建人",prop:"createUser"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.createUser,callback:function(t){e.$set(e.form,"createUser",t)},expression:"form.createUser"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建时间",prop:"create_at"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.create_at,callback:function(t){e.$set(e.form,"create_at",t)},expression:"form.create_at"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新人",prop:"updateUser"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updateUser,callback:function(t){e.$set(e.form,"updateUser",t)},expression:"form.updateUser"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间",prop:"update_at"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.update_at,callback:function(t){e.$set(e.form,"update_at",t)},expression:"form.update_at"}})],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"申请人详情",visible:e.viewDialogVisible,width:"800px","append-to-body":""},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[t("el-descriptions",{attrs:{border:"",column:2}},[t("el-descriptions-item",{attrs:{label:"申请人名称"}},[e._v(e._s(e.viewForm.name))]),t("el-descriptions-item",{attrs:{label:"申请人名称(英文)"}},[e._v(e._s(e.viewForm.nameEn||"无"))]),t("el-descriptions-item",{attrs:{label:"申请人类型"}},[e._v(e._s(e.viewForm.type||"无"))]),t("el-descriptions-item",{attrs:{label:"实体类型"}},[e._v(e._s(e.viewForm.entityType||"无"))]),t("el-descriptions-item",{attrs:{label:"申请人编号"}},[e._v(e._s(e.viewForm.code||"无"))]),t("el-descriptions-item",{attrs:{label:"总委托书编号"}},[e._v(e._s(e.viewForm.totalConditionNo||"无"))]),t("el-descriptions-item",{attrs:{label:"证件类型"}},[e._v(e._s(e.viewForm.idType||"无"))]),t("el-descriptions-item",{attrs:{label:"证件号"}},[e._v(e._s(e.viewForm.idNumber||"无"))]),t("el-descriptions-item",{attrs:{label:"费减备案"}},[e._v(e._s(e.viewForm.feeReduction||"否"))]),t("el-descriptions-item",{attrs:{label:"费减有效期"}},[e._v(e._s(e.viewForm.feeReductionPeriod||"无"))]),t("el-descriptions-item",{attrs:{label:"国籍"}},[e._v(e._s(e.viewForm.country||"无"))]),t("el-descriptions-item",{attrs:{label:"省"}},[e._v(e._s(e.viewForm.province||"无"))]),t("el-descriptions-item",{attrs:{label:"市"}},[e._v(e._s(e.viewForm.city||"无"))]),t("el-descriptions-item",{attrs:{label:"区"}},[e._v(e._s(e.viewForm.district||"无"))]),t("el-descriptions-item",{attrs:{label:"街道"}},[e._v(e._s(e.viewForm.street||"无"))]),t("el-descriptions-item",{attrs:{label:"邮编"}},[e._v(e._s(e.viewForm.postalCode||"无"))]),t("el-descriptions-item",{attrs:{label:"地址（英文）"}},[e._v(e._s(e.viewForm.addressEn||"无"))]),t("el-descriptions-item",{attrs:{label:"经常经营地或营业地"}},[e._v(e._s(e.viewForm.businessLocation||"无"))]),t("el-descriptions-item",{attrs:{label:"业务人员"}},[e._v(e._s(e.viewForm.businessStaff||"无"))]),t("el-descriptions-item",{attrs:{label:"申请人备注",span:2}},[e._v(e._s(e.viewForm.remark||"无"))]),t("el-descriptions-item",{attrs:{label:"创建人"}},[e._v(e._s(e.viewForm.createUser||"无"))]),t("el-descriptions-item",{attrs:{label:"创建时间"}},[e._v(e._s(e.viewForm.create_at||"无"))]),t("el-descriptions-item",{attrs:{label:"更新人"}},[e._v(e._s(e.viewForm.updateUser||"无"))]),t("el-descriptions-item",{attrs:{label:"更新时间"}},[e._v(e._s(e.viewForm.update_at||"无"))])],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.viewDialogVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},x=[],S=a("d3ff"),T=a("ca3a"),P={name:"CustomerApplicantTab",props:{customerId:{type:[String,Number],required:!0}},data(){return{loading:!1,applicantList:[],pageNum:1,pageSize:10,total:0,queryParams:{name:"",type:"",code:""},dialogVisible:!1,dialogTitle:"",viewDialogVisible:!1,viewForm:{},form:{id:null,name:"",nameEn:"",type:"",entityType:"",code:"",idNumber:"",idType:"",totalConditionNo:"",feeReduction:"否",feeReductionPeriod:"",syncDate:"",country:"中国",province:"",city:"",district:"",areaCode:[],street:"",postalCode:"",addressEn:"",businessLocation:"",remark:"",email:"",phone:"",businessStaff:"",businessStaffId:null},rules:{name:[{required:!0,message:"请输入申请人名称",trigger:"blur"}],type:[{required:!0,message:"请选择申请人类型",trigger:"change"}],country:[{required:!0,message:"请选择国籍",trigger:"change"}],province:[{required:!0,message:"请选择省",trigger:"change"}],city:[{required:!0,message:"请选择市",trigger:"change"}],district:[{required:!0,message:"请选择区",trigger:"change"}]},countryList:[],areaData:[],businessStaffList:[]}},async created(){await this.initData(),this.getApplicantList()},methods:{async initData(){this.countryList=S["a"].map(e=>({label:e.cn,value:e.cn})),this.areaData=T,await this.loadBusinessStaffList()},async loadBusinessStaffList(){try{const e=await this.$api.user.getList({status:1,limit:1e3});0===e.data.code?(this.businessStaffList=e.data.data||[],console.log("业务人员列表加载成功:",this.businessStaffList)):console.log("业务人员列表加载失败:",e)}catch(e){console.error("加载业务人员列表失败:",e)}},getCurrentUser(){return"当前用户"},getCurrentTime(){return(new Date).toLocaleString("zh-CN")},async getApplicantList(){this.loading=!0;try{const e={customer_id:this.customerId,page:this.pageNum,page_size:this.pageSize,applicant_name_cn:this.queryParams.name,applicant_type:this.queryParams.type,applicant_code:this.queryParams.code},t=await h["a"].getApplicantList(e),a=t&&t.data&&t.data.data?t.data.data:{list:[],total:0};this.applicantList=(a.list||[]).map(e=>({id:e.id,customer_id:e.customer_id,name:e.applicantName||e.applicant_name_cn,nameEn:e.applicantNameEn||e.applicant_name_en,type:e.applicant_type,code:e.applicant_code,country:e.country,address:e.business_location||e.administrativeArea||"",feeReduction:e.fee_reduction?"是":"否",feeReductionPeriod:e.feeReductionStartDate&&e.feeReductionEndDate?`${e.feeReductionStartDate} 至 ${e.feeReductionEndDate}`:"",email:e.email,idType:e.id_type,idNumber:e.id_number,inventorNote:e.inventor_note,province:e.province,city:e.city,district:e.district,street:e.street,remark:e.remark,createUser:e.createUser||"无",create_at:e.create_at||e.created_at||"无",updateUser:e.updateUser||"无",update_at:e.update_at||e.updated_at||"无"})),this.total=a.total||0,this.loading=!1}catch(e){console.error("获取申请人列表失败:",e),this.$message.error("获取申请人列表失败"),this.applicantList=[],this.loading=!1}},resetQuery(){this.queryParams={name:"",type:"",code:""},this.getApplicantList()},handleFormAreaChange(e){e&&e.length>0?this.setAreaNamesByCode(e):(this.form.province="",this.form.city="",this.form.district="")},setAreaNamesByCode(e){let t="",a="",s="";if(e.length>=1){const i=this.areaData.find(t=>t.value===e[0]);if(i&&(t=i.label,e.length>=2&&i.children)){const t=i.children.find(t=>t.value===e[1]);if(t&&(a=t.label,e.length>=3&&t.children)){const a=t.children.find(t=>t.value===e[2]);a&&(s=a.label)}}}this.form.province=t,this.form.city=a,this.form.district=s},getAreaCodesByNames(e,t,a){const s=[];if(!e)return s;const i=this.areaData.find(t=>t.label===e);if(i&&(s.push(i.value),t&&i.children)){const e=i.children.find(e=>e.label===t);if(e&&(s.push(e.value),a&&e.children)){const t=e.children.find(e=>e.label===a);t&&s.push(t.value)}}return s},handleBusinessStaffChange(e){const t=this.businessStaffList.find(t=>t.id===e);t?(this.form.businessStaff=t.real_name,this.form.businessStaffId=e):(this.form.businessStaff="",this.form.businessStaffId=null)},handleAdd(){this.form={id:null,name:"",nameEn:"",type:"",entityType:"",code:"",idNumber:"",idType:"",totalConditionNo:"",feeReduction:"否",feeReductionPeriod:"",syncDate:"",country:"中国",province:"",city:"",district:"",areaCode:[],street:"",postalCode:"",addressEn:"",businessLocation:"",remark:"",email:"",phone:"",businessStaff:"",businessStaffId:null},this.dialogTitle="添加申请人",this.dialogVisible=!0},async handleEdit(e){try{const t=await h["a"].getApplicant(e.id),a=t.data.data;this.form={id:a.id,name:a.applicant_name_cn,nameEn:a.applicant_name_en,type:a.applicant_type,entityType:a.entity_type,code:a.applicant_code,idNumber:a.id_number,idType:a.id_type,totalConditionNo:a.total_condition_no,feeReduction:a.fee_reduction?"是":"否",feeReductionPeriod:a.fee_reduction_start_date&&a.fee_reduction_end_date?[a.fee_reduction_start_date,a.fee_reduction_end_date]:[],syncDate:a.sync_date,country:a.country,province:a.province,city:a.city,district:a.district,areaCode:this.getAreaCodesByNames(a.province,a.city,a.district),street:a.street,postalCode:a.postal_code,addressEn:a.address_en,businessLocation:a.business_location,remark:a.remark,email:a.email,phone:a.phone,businessStaff:a.business_staff?parseInt(a.business_staff):null,businessStaffId:a.business_staff_id?parseInt(a.business_staff_id):null,createUser:a.createUser||"无",create_at:a.created_at||"无",updateUser:a.updateUser||"无",update_at:a.updated_at||"无"},this.dialogTitle="编辑申请人",this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.form&&this.$refs.form.clearValidate()})}catch(t){console.error("获取申请人详情失败:",t),this.$message.error("获取申请人详情失败")}},async handleView(e){try{const t=await h["a"].getApplicant(e.id),a=t.data.data;this.viewForm={id:a.id,name:a.applicant_name_cn,nameEn:a.applicant_name_en,type:a.applicant_type,entityType:a.entity_type,code:a.applicant_code,totalConditionNo:a.total_condition_no,idNumber:a.id_number,idType:a.id_type,feeReduction:a.fee_reduction?"是":"否",feeReductionPeriod:a.fee_reduction_start_date&&a.fee_reduction_end_date?`${a.fee_reduction_start_date} 至 ${a.fee_reduction_end_date}`:"无",syncDate:a.sync_date,country:a.country,province:a.province,city:a.city,district:a.district,street:a.street,postalCode:a.postal_code,addressEn:a.address_en,businessLocation:a.business_location,businessStaff:a.businessStaff,email:a.email,phone:a.phone,remark:a.remark,createUser:a.createUser||"无",createTime:a.createTime||"无",updateUser:a.updateUser||"无",updateTime:a.updateTime||"无"},this.viewDialogVisible=!0}catch(t){console.error("获取申请人详情失败:",t),this.$message.error("获取申请人详情失败")}},handleDelete(e){this.$confirm("确认删除该申请人?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await h["a"].deleteApplicant(e.id),this.$message({type:"success",message:"删除成功!"}),this.getApplicantList()}catch(t){console.error("删除申请人失败:",t),this.$message.error("删除申请人失败，请重试")}}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},async submitForm(){this.$refs.form.validate(async e=>{if(e)try{const e={customer_id:this.customerId,applicant_name_cn:this.form.name,applicant_name_en:this.form.nameEn,applicant_type:this.form.type,entity_type:this.form.entityType,id_type:this.form.idType,id_number:this.form.idNumber,total_condition_no:this.form.totalConditionNo,fee_reduction:"是"===this.form.feeReduction,fee_reduction_start_date:Array.isArray(this.form.feeReductionPeriod)&&2===this.form.feeReductionPeriod.length?this.form.feeReductionPeriod[0]:null,fee_reduction_end_date:Array.isArray(this.form.feeReductionPeriod)&&2===this.form.feeReductionPeriod.length?this.form.feeReductionPeriod[1]:null,sync_date:this.form.syncDate,country:this.form.country,province:this.form.province,city:this.form.city,district:this.form.district,street:this.form.street,postal_code:this.form.postalCode,address_en:this.form.addressEn,business_location:this.form.businessLocation,business_staff_id:this.form.businessStaffId,email:this.form.email,phone:this.form.phone,remark:this.form.remark};this.form.id?(await h["a"].updateApplicant(this.form.id,e),this.$message.success("申请人更新成功")):(await h["a"].createApplicant(e),this.$message.success("申请人创建成功")),this.dialogVisible=!1,this.getApplicantList()}catch(t){console.error("保存申请人失败:",t),this.$message.error("保存申请人失败，请重试")}})},handleSizeChange(e){this.pageSize=e,this.getApplicantList()},handleCurrentChange(e){this.pageNum=e,this.getApplicantList()}}},$=P,E=(a("c992"),Object(c["a"])($,D,x,!1,null,null,null)),I=E.exports,q=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-inventor-container"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("发明人列表")]),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增发明人")])],1),t("div",{staticClass:"search-container"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.queryParams}},[t("el-form-item",[t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"姓名",clearable:""},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}})],1),t("el-form-item",[t("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"国籍",clearable:"",filterable:""},model:{value:e.queryParams.country,callback:function(t){e.$set(e.queryParams,"country",t)},expression:"queryParams.country"}},e._l(e.countryList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",[t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"联系电话",clearable:""},model:{value:e.queryParams.phone,callback:function(t){e.$set(e.queryParams,"phone",t)},expression:"queryParams.phone"}})],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.getInventorList}},[e._v("查询")]),t("el-button",{attrs:{plain:"",icon:"el-icon-refresh"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.inventorList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),t("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t("el-table-column",{attrs:{label:"姓名",prop:"name",align:"center",width:"100"}}),t("el-table-column",{attrs:{label:"国籍",prop:"country",align:"center",width:"80"}}),t("el-table-column",{attrs:{label:"英文名",prop:"nameEn",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"证件类型",prop:"idType",align:"center"}}),t("el-table-column",{attrs:{label:"证件号码",prop:"idNumber",align:"center",width:"150"}}),t("el-table-column",{attrs:{label:"手机",prop:"phone",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"座机",prop:"landline",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"微信",prop:"wechat",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"省",prop:"province",align:"center"}}),t("el-table-column",{attrs:{label:"市",prop:"city",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleView(a.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"700px","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"国籍",prop:"country"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择国籍",filterable:""},model:{value:e.form.country,callback:function(t){e.$set(e.form,"country",t)},expression:"form.country"}},e._l(e.countryList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"英文名",prop:"nameEn"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.nameEn,callback:function(t){e.$set(e.form,"nameEn",t)},expression:"form.nameEn"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"省市区",prop:"areaCode"}},[t("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.areaData,props:{value:"label",label:"label",children:"children"},placeholder:"请选择省/市/区",clearable:"",filterable:""},on:{change:e.handleAreaChange},model:{value:e.areaSelected,callback:function(t){e.areaSelected=t},expression:"areaSelected"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"街道",prop:"street"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.street,callback:function(t){e.$set(e.form,"street",t)},expression:"form.street"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"证件类型",prop:"idType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择证件类型"},model:{value:e.form.idType,callback:function(t){e.$set(e.form,"idType",t)},expression:"form.idType"}},[t("el-option",{attrs:{label:"营业执照(信用代码)",value:"营业执照(信用代码)"}}),t("el-option",{attrs:{label:"居民身份证",value:"居民身份证"}}),t("el-option",{attrs:{label:"外国人永久居留身份证",value:"外国人永久居留身份证"}}),t("el-option",{attrs:{label:"普通护照（仅限华侨）",value:"普通护照（仅限华侨）"}}),t("el-option",{attrs:{label:"台湾居民来往内地通行证",value:"台湾居民来往内地通行证"}}),t("el-option",{attrs:{label:"港澳居民来往内地通行证",value:"港澳居民来往内地通行证"}}),t("el-option",{attrs:{label:"非统一社会信用代码",value:"非统一社会信用代码"}}),t("el-option",{attrs:{label:"其它证件",value:"其它证件"}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"证件号码",prop:"idNumber"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.idNumber,callback:function(t){e.$set(e.form,"idNumber",t)},expression:"form.idNumber"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"手机",prop:"phone"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"座机",prop:"landline"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.landline,callback:function(t){e.$set(e.form,"landline",t)},expression:"form.landline"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"微信",prop:"wechat"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.wechat,callback:function(t){e.$set(e.form,"wechat",t)},expression:"form.wechat"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"业务人员",prop:"businessStaff"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择业务人员",filterable:""},on:{change:e.handleBusinessStaffChange},model:{value:e.form.businessStaffId,callback:function(t){e.$set(e.form,"businessStaffId",t)},expression:"form.businessStaffId"}},e._l(e.businessStaffList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.real_name,value:e.id}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"发明人备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建人",prop:"creator"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.creator,callback:function(t){e.$set(e.form,"creator",t)},expression:"form.creator"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建时间",prop:"createTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.createTime,callback:function(t){e.$set(e.form,"createTime",t)},expression:"form.createTime"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新人",prop:"updater"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updater,callback:function(t){e.$set(e.form,"updater",t)},expression:"form.updater"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间",prop:"updateTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updateTime,callback:function(t){e.$set(e.form,"updateTime",t)},expression:"form.updateTime"}})],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"发明人详情",visible:e.viewDialogVisible,width:"700px","append-to-body":""},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[t("el-descriptions",{attrs:{border:"",column:2}},[t("el-descriptions-item",{attrs:{label:"姓名"}},[e._v(e._s(e.viewForm.name))]),t("el-descriptions-item",{attrs:{label:"英文名"}},[e._v(e._s(e.viewForm.nameEn||"无"))]),t("el-descriptions-item",{attrs:{label:"国籍"}},[e._v(e._s(e.viewForm.country))]),t("el-descriptions-item",{attrs:{label:"性别"}},[e._v(e._s(e.viewForm.gender||"无"))]),t("el-descriptions-item",{attrs:{label:"省"}},[e._v(e._s(e.viewForm.province||"无"))]),t("el-descriptions-item",{attrs:{label:"市"}},[e._v(e._s(e.viewForm.city||"无"))]),t("el-descriptions-item",{attrs:{label:"区"}},[e._v(e._s(e.viewForm.district||"无"))]),t("el-descriptions-item",{attrs:{label:"街道"}},[e._v(e._s(e.viewForm.street||"无"))]),t("el-descriptions-item",{attrs:{label:"证件类型"}},[e._v(e._s(e.viewForm.idType))]),t("el-descriptions-item",{attrs:{label:"证件号码"}},[e._v(e._s(e.viewForm.idNumber))]),t("el-descriptions-item",{attrs:{label:"手机"}},[e._v(e._s(e.viewForm.phone||"无"))]),t("el-descriptions-item",{attrs:{label:"座机"}},[e._v(e._s(e.viewForm.landline||"无"))]),t("el-descriptions-item",{attrs:{label:"微信"}},[e._v(e._s(e.viewForm.wechat||"无"))]),t("el-descriptions-item",{attrs:{label:"邮箱"}},[e._v(e._s(e.viewForm.email||"无"))]),t("el-descriptions-item",{attrs:{label:"工作单位"}},[e._v(e._s(e.viewForm.workUnit||"无"))]),t("el-descriptions-item",{attrs:{label:"部门"}},[e._v(e._s(e.viewForm.department||"无"))]),t("el-descriptions-item",{attrs:{label:"职务"}},[e._v(e._s(e.viewForm.position||"无"))]),t("el-descriptions-item",{attrs:{label:"业务人员"}},[e._v(e._s(e.viewForm.businessStaff||"无"))]),t("el-descriptions-item",{attrs:{label:"客户名称"}},[e._v(e._s(e.viewForm.customerName||"无"))]),t("el-descriptions-item",{attrs:{label:"客户编码"}},[e._v(e._s(e.viewForm.customerCode||"无"))]),t("el-descriptions-item",{attrs:{label:"客户编号"}},[e._v(e._s(e.viewForm.customerNumber||"无"))]),t("el-descriptions-item",{attrs:{label:"发明人备注",span:2}},[e._v(e._s(e.viewForm.remark||"无"))]),t("el-descriptions-item",{attrs:{label:"创建人"}},[e._v(e._s(e.viewForm.createUser||"无"))]),t("el-descriptions-item",{attrs:{label:"创建时间"}},[e._v(e._s(e.viewForm.createTime||"无"))]),t("el-descriptions-item",{attrs:{label:"更新人"}},[e._v(e._s(e.viewForm.updateUser||"无"))]),t("el-descriptions-item",{attrs:{label:"更新时间"}},[e._v(e._s(e.viewForm.updateTime||"无"))])],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.viewDialogVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},N=[],A=a("c24f"),L={name:"CustomerInventorTab",props:{customerId:{type:[String,Number],required:!0}},data(){return{loading:!1,inventorList:[],countryList:[],areaData:[],businessStaffList:[],areaSelected:[],pageNum:1,pageSize:10,total:0,queryParams:{name:"",country:"",phone:""},dialogVisible:!1,dialogTitle:"",viewDialogVisible:!1,viewForm:{},form:{id:null,name:"",country:"中国",nameEn:"",province:"",city:"",district:"",street:"",idType:"身份证",idNumber:"",phone:"",landline:"",wechat:"",gender:"",email:"",workUnit:"",department:"",position:"",businessStaff:"",businessStaffId:null,remark:"",creator:"",createTime:"",updater:"",updateTime:""},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],country:[{required:!0,message:"请选择国籍",trigger:"change"}],idNumber:[{required:!0,message:"请输入证件号码",trigger:"blur"}]}}},async created(){await this.initData(),this.getInventorList()},methods:{async initData(){this.countryList=S["a"].map(e=>({label:e.cn,value:e.cn})),this.areaData=T,await this.loadBusinessStaffList()},async loadBusinessStaffList(){try{const e=await A["default"].getList({status:1,limit:1e3});e&&e.data&&0===e.data.code?(this.businessStaffList=e.data.data||[],console.log("业务人员列表加载成功:",this.businessStaffList)):console.log("业务人员列表加载失败:",e)}catch(e){console.error("加载业务人员列表失败:",e)}},getCurrentUser(){return"当前用户"},getCurrentTime(){return(new Date).toLocaleString("zh-CN")},async getInventorList(){this.loading=!0;try{const e={customer_id:this.customerId,page:this.pageNum,page_size:this.pageSize,inventor_name_cn:this.queryParams.name,country:this.queryParams.country,phone:this.queryParams.phone},t=await h["a"].getInventorList(e),a=t&&t.data&&t.data.data?t.data.data:{list:[],total:0};this.inventorList=(a.list||[]).map(e=>({id:e.id,customer_id:e.customer_id,name:e.inventorName||e.inventor_name_cn,nameEn:e.inventorNameEn||e.inventor_name_en,country:e.country,phone:e.phone,landline:e.landline,wechat:e.wechat,province:e.province,city:e.city,district:e.district,street:e.street,idType:e.id_type,idNumber:e.idNumber||e.id_number,gender:e.gender,email:e.email,workUnit:e.workUnit||e.work_unit,department:e.department,position:e.position,remark:e.remark,creator:e.createUser||"无",createTime:e.createTime||e.created_at||"无",updater:e.updateUser||"无",updateTime:e.updateTime||e.updated_at||"无"})),this.total=a.total||0,this.loading=!1}catch(e){console.error("获取发明人列表失败:",e),this.$message.error("获取发明人列表失败"),this.inventorList=[],this.loading=!1}},resetQuery(){this.queryParams={name:"",country:"",phone:""},this.getInventorList()},handleAdd(){this.form={id:null,name:"",country:"中国",nameEn:"",province:"",city:"",district:"",street:"",idType:"身份证",idNumber:"",phone:"",landline:"",wechat:"",gender:"",email:"",workUnit:"",department:"",position:"",remark:"",creator:this.getCurrentUser(),createTime:this.getCurrentTime(),updater:this.getCurrentUser(),updateTime:this.getCurrentTime()},this.dialogTitle="添加发明人",this.dialogVisible=!0},async submitForm(){this.$refs.form.validate(async e=>{if(e)try{const e={customer_id:this.customerId,inventor_name_cn:this.form.name,inventor_name_en:this.form.nameEn,inventor_type:"",gender:this.form.gender||null,country:this.form.country,province:this.form.province,city:this.form.city,district:this.form.district,street:this.form.street,address:"",address_en:"",id_type:this.form.idType,id_number:this.form.idNumber,phone:this.form.phone,landline:this.form.landline,wechat:this.form.wechat,email:this.form.email||"",work_unit:this.form.workUnit||"",department:this.form.department||"",position:this.form.position||"",business_staff_id:this.form.businessStaffId,remark:this.form.remark};this.form.id?(await h["a"].updateInventor(this.form.id,e),this.$message.success("发明人更新成功")):(await h["a"].createInventor(e),this.$message.success("发明人创建成功")),this.dialogVisible=!1,this.getInventorList()}catch(t){console.error("保存发明人失败:",t),this.$message.error("保存发明人失败，请重试")}})},async handleEdit(e){try{const t=await h["a"].getInventor(e.id),a=t.data.data;this.form={id:a.id,name:a.inventor_name_cn,nameEn:a.inventor_name_en,country:a.country,province:a.province,city:a.city,district:a.district,street:a.street,idType:a.id_type,idNumber:a.id_number,phone:a.phone,landline:a.landline,wechat:a.wechat,gender:a.gender,email:a.email,workUnit:a.work_unit,department:a.department,position:a.position,businessStaff:a.businessStaff,businessStaffId:a.business_staff_id?parseInt(a.business_staff_id):null,remark:a.remark,creator:a.createUser||"无",createTime:a.created_at||"无",updater:a.updateUser||"无",updateTime:a.updated_at||"无"},a.province||a.city||a.district?this.areaSelected=this.getAreaNamesByValues(a.province,a.city,a.district):this.areaSelected=[],this.dialogTitle="编辑发明人",this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.form&&this.$refs.form.clearValidate()})}catch(t){console.error("获取发明人详情失败:",t),this.$message.error("获取发明人详情失败")}},async handleView(e){try{const t=await h["a"].getInventor(e.id),a=t.data.data;this.viewForm={id:a.id,name:a.inventor_name_cn,nameEn:a.inventor_name_en,country:a.country,gender:a.gender,province:a.province,city:a.city,district:a.district,street:a.street,idType:a.id_type,idNumber:a.id_number,phone:a.phone,landline:a.landline,wechat:a.wechat,email:a.email,workUnit:a.work_unit,department:a.department,position:a.position,businessStaff:a.businessStaff,customerName:a.customerName,customerCode:a.customerCode,customerNumber:a.customerNumber,remark:a.remark,createUser:a.createUser||"无",createTime:a.created_at||"无",updateUser:a.updateUser||"无",updateTime:a.updated_at||"无"},this.viewDialogVisible=!0}catch(t){console.error("获取发明人详情失败:",t),this.$message.error("获取发明人详情失败")}},handleAreaChange(e){e&&e.length>0?(this.form.province=e[0]||"",this.form.city=e[1]||"",this.form.district=e[2]||""):(this.form.province="",this.form.city="",this.form.district="")},handleBusinessStaffChange(e){const t=this.businessStaffList.find(t=>t.id===e);t?(this.form.businessStaff=t.real_name,this.form.businessStaffId=e):(this.form.businessStaff="",this.form.businessStaffId=null)},getAreaNamesByValues(e,t,a){const s=[];if(e){const r=this.getAreaNameByCode(e,this.areaData);if(r){s.push(r);const e=this.areaData.find(e=>e.label===r);if(e&&t){const r=this.getAreaNameByCode(t,e.children||[]);if(r){var i;s.push(r);const t=null===(i=e.children)||void 0===i?void 0:i.find(e=>e.label===r);if(t&&a){const e=this.getAreaNameByCode(a,t.children||[]);e&&s.push(e)}}}}}return s},getAreaNameByCode(e,t){if(!e||!t)return e;const a=t.find(t=>t.label===e);if(a)return e;const s=t.find(t=>t.value===e);return s?s.label:e},handleDelete(e){this.$confirm("确认删除该发明人?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await h["a"].deleteInventor(e.id),this.$message({type:"success",message:"删除成功!"}),this.getInventorList()}catch(t){console.error("删除发明人失败:",t),this.$message.error("删除发明人失败，请重试")}}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},handleSizeChange(e){this.pageSize=e,this.getInventorList()},handleCurrentChange(e){this.pageNum=e,this.getInventorList()}}},z=L,R=(a("0c05"),Object(c["a"])(z,q,N,!1,null,null,null)),V=R.exports,M=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-case-container"},[e._m(0),t("div",{staticClass:"search-container"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.queryParams}},[t("el-form-item",[t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"项目编号",clearable:""},model:{value:e.queryParams.ourRefNumber,callback:function(t){e.$set(e.queryParams,"ourRefNumber",t)},expression:"queryParams.ourRefNumber"}})],1),t("el-form-item",[t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"申请号/注册号",clearable:""},model:{value:e.queryParams.applicationNo,callback:function(t){e.$set(e.queryParams,"applicationNo",t)},expression:"queryParams.applicationNo"}})],1),t("el-form-item",[t("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"项目类型",clearable:""},model:{value:e.queryParams.caseType,callback:function(t){e.$set(e.queryParams,"caseType",t)},expression:"queryParams.caseType"}},[t("el-option",{attrs:{label:"发明专利",value:"发明专利"}}),t("el-option",{attrs:{label:"实用新型",value:"实用新型"}}),t("el-option",{attrs:{label:"外观设计",value:"外观设计"}}),t("el-option",{attrs:{label:"商标",value:"商标"}}),t("el-option",{attrs:{label:"软件著作权",value:"软件著作权"}})],1)],1),t("el-form-item",[t("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"业务类型",clearable:""},model:{value:e.queryParams.businessType,callback:function(t){e.$set(e.queryParams,"businessType",t)},expression:"queryParams.businessType"}},[t("el-option",{attrs:{label:"申请",value:"申请"}}),t("el-option",{attrs:{label:"注册",value:"注册"}}),t("el-option",{attrs:{label:"登记",value:"登记"}}),t("el-option",{attrs:{label:"复审",value:"复审"}}),t("el-option",{attrs:{label:"无效",value:"无效"}})],1)],1),t("el-form-item",[t("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"项目状态",clearable:""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},[t("el-option",{attrs:{label:"准备中",value:"准备中"}}),t("el-option",{attrs:{label:"已申请",value:"已申请"}}),t("el-option",{attrs:{label:"已受理",value:"已受理"}}),t("el-option",{attrs:{label:"实审中",value:"实审中"}}),t("el-option",{attrs:{label:"已授权",value:"已授权"}}),t("el-option",{attrs:{label:"已登记",value:"已登记"}}),t("el-option",{attrs:{label:"已驳回",value:"已驳回"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.getCaseList}},[e._v("查询")]),t("el-button",{attrs:{plain:"",icon:"el-icon-refresh"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.caseList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),t("el-table-column",{attrs:{label:"序号",type:"index",width:"60",align:"center"}}),t("el-table-column",{attrs:{label:"我方文号",prop:"ourRefNumber",width:"120",align:"center"}}),t("el-table-column",{attrs:{label:"申请号/注册号",prop:"applicationNo",width:"150",align:"center"}}),t("el-table-column",{attrs:{label:"申请日",prop:"applicationDate",width:"120",align:"center"}}),t("el-table-column",{attrs:{label:"项目名称",prop:"caseName","min-width":"180","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"项目类型",prop:"caseType",width:"100",align:"center"}}),t("el-table-column",{attrs:{label:"业务类型",prop:"businessType",width:"100",align:"center"}}),t("el-table-column",{attrs:{label:"项目状态",prop:"status",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getCaseStatusType(a.row.status)}},[e._v(e._s(a.row.status))])]}}])}),t("el-table-column",{attrs:{label:"项目处理人",prop:"caseHandler",width:"100",align:"center"}}),t("el-table-column",{attrs:{label:"技术主导",prop:"techLeader",width:"100",align:"center"}}),t("el-table-column",{attrs:{label:"商标类别",prop:"trademarkClass",width:"100",align:"center"}}),t("el-table-column",{attrs:{label:"合同号",prop:"contractNo",width:"120",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleView(a.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleGoToProject(a.row)}}},[e._v("进入项目")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"项目详情",visible:e.viewDialogVisible,width:"700px","append-to-body":""},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[t("el-descriptions",{attrs:{border:"",column:2}},[t("el-descriptions-item",{attrs:{label:"客户名称"}},[e._v(e._s(e.viewForm.clientName))]),t("el-descriptions-item",{attrs:{label:"项目类型"}},[e._v(e._s(e.viewForm.caseType))]),t("el-descriptions-item",{attrs:{label:"项目编号"}},[e._v(e._s(e.viewForm.caseNo))]),t("el-descriptions-item",{attrs:{label:"业务类型"}},[e._v(e._s(e.viewForm.businessType||"无"))]),t("el-descriptions-item",{attrs:{label:"提案名称"}},[e._v(e._s(e.viewForm.caseName))]),t("el-descriptions-item",{attrs:{label:"申请类型"}},[e._v(e._s(e.viewForm.applicationType||"无"))]),t("el-descriptions-item",{attrs:{label:"技术主导"}},[e._v(e._s(e.viewForm.techLeaderName||"无"))]),t("el-descriptions-item",{attrs:{label:"资料对接-技术"}},[e._v(e._s(e.viewForm.techContactName||"无"))]),t("el-descriptions-item",{attrs:{label:"售前支持"}},[e._v(e._s(e.viewForm.presaleSupport||"无"))]),t("el-descriptions-item",{attrs:{label:"项目状态"}},[t("el-tag",{attrs:{type:e.getCaseStatusType(e.viewForm.status)}},[e._v(e._s(e.viewForm.status))])],1),"专利"===e.viewForm.caseType?[t("el-descriptions-item",{attrs:{label:"申请号"}},[e._v(e._s(e.viewForm.applicationNo||"无"))]),t("el-descriptions-item",{attrs:{label:"申请国家(地区)"}},[e._v(e._s(e.viewForm.applicationCountry||"无"))]),t("el-descriptions-item",{attrs:{label:"代理机构"}},[e._v(e._s(e.viewForm.agencyName||"无"))])]:e._e(),"商标"===e.viewForm.caseType?[t("el-descriptions-item",{attrs:{label:"注册号"}},[e._v(e._s(e.viewForm.registrationNo||"无"))]),t("el-descriptions-item",{attrs:{label:"申请国家(地区)"}},[e._v(e._s(e.viewForm.applicationCountry||"无"))]),t("el-descriptions-item",{attrs:{label:"代理机构"}},[e._v(e._s(e.viewForm.agencyName||"无"))])]:e._e(),"版权"===e.viewForm.caseType?[t("el-descriptions-item",{attrs:{label:"申请国家(地区)"}},[e._v(e._s(e.viewForm.applicationCountry||"无"))]),t("el-descriptions-item",{attrs:{label:"代理机构"}},[e._v(e._s(e.viewForm.agencyName||"无"))])]:e._e(),"项目"===e.viewForm.caseType?[t("el-descriptions-item",{attrs:{label:"类别"}},[e._v(e._s(e.viewForm.category||"无"))]),t("el-descriptions-item",{attrs:{label:"项目类型"}},[e._v(e._s(e.viewForm.projectType||"无"))])]:e._e(),t("el-descriptions-item",{attrs:{label:"项目备注",span:2}},[e._v(e._s(e.viewForm.remark||"无"))]),t("el-descriptions-item",{attrs:{label:"创建人"}},[e._v(e._s(e.viewForm.creator||"无"))]),t("el-descriptions-item",{attrs:{label:"创建时间"}},[e._v(e._s(e.viewForm.createTime||"无"))]),t("el-descriptions-item",{attrs:{label:"更新人"}},[e._v(e._s(e.viewForm.updater||"无"))]),t("el-descriptions-item",{attrs:{label:"更新时间"}},[e._v(e._s(e.viewForm.updateTime||"无"))])],2),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.viewDialogVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},O=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"section-header"},[t("h3",[e._v("项目列表")])])}],B={name:"CustomerCaseTab",props:{customerId:{type:[String,Number],required:!0}},data(){return{loading:!1,caseList:[],pageNum:1,pageSize:10,total:0,queryParams:{ourRefNumber:"",applicationNo:"",caseType:"",businessType:"",status:""},viewDialogVisible:!1,viewForm:{}}},created(){this.getCaseList()},methods:{async getCaseList(){this.loading=!0;try{const e={customer_id:this.customerId,page:this.pageNum,page_size:this.pageSize};this.queryParams.ourRefNumber&&(e.case_code=this.queryParams.ourRefNumber),this.queryParams.applicationNo&&(e.application_no=this.queryParams.applicationNo),this.queryParams.caseType&&(e.case_type=this.getCaseTypeValue(this.queryParams.caseType)),this.queryParams.businessType&&(e.case_subtype=this.queryParams.businessType),this.queryParams.status&&(e.case_status=this.getCaseStatusValue(this.queryParams.status)),console.log("请求参数:",e);const t=await h["a"].getCaseList(e);if(console.log("API响应:",t),t&&t.data&&t.data.success){const e=t.data.data||{list:[],total:0};this.caseList=(e.list||[]).map(e=>({id:e.id,ourRefNumber:e.case_code||e.our_ref_number,applicationNo:e.application_no,applicationDate:e.application_date,caseName:e.case_name,caseType:this.getCaseTypeName(e.case_type),businessType:e.case_subtype||"申请",status:this.getCaseStatusName(e.case_status),caseHandler:e.business_person||"未分配",techLeader:e.tech_leader||"未分配",trademarkClass:e.trademark_class||"",contractNo:e.contract_no||""})),this.total=e.total||0}else this.caseList=[],this.total=0}catch(e){console.error("获取项目列表失败:",e),this.$message.error("获取项目列表失败: "+(e.message||"未知错误")),this.caseList=[],this.total=0}finally{this.loading=!1}},resetQuery(){this.queryParams={ourRefNumber:"",applicationNo:"",caseType:"",businessType:"",status:""},this.getCaseList()},getCaseStatusType(e){const t={"准备中":"info","已申请":"primary","已受理":"warning","实审中":"warning","已授权":"success","已驳回":"danger","已登记":"success"};return t[e]||"info"},getCaseTypeName(e){const t={1:"专利",2:"商标",3:"版权",4:"项目"};return t[e]||"未知"},getCaseStatusName(e){const t={1:"准备中",2:"已申请",3:"已受理",4:"实审中",5:"已授权",6:"已驳回",7:"已登记",8:"已失效",9:"已转让",10:"已许可"};return t[e]||"准备中"},getCaseTypeValue(e){const t={"发明专利":1,"实用新型":1,"外观设计":1,"商标":2,"软件著作权":3};return t[e]||null},getCaseStatusValue(e){const t={"准备中":1,"已申请":2,"已受理":3,"实审中":4,"已授权":5,"已驳回":6,"已登记":7,"已失效":8,"已转让":9,"已许可":10};return t[e]||null},handleCaseTypeChange(){this.form.applicationNo="",this.form.registrationNo="",this.form.applicationCountry="项目"!==this.form.caseType?"中国":"",this.form.category="",this.form.projectType="",this.form.agencyName=""},handleGoToProject(e){const t={"专利":"/case/patent/detail","商标":"/case/trademark/detail","版权":"/case/copyright/detail","项目":"/case/project/detail"},a=t[e.caseType]||"/case/project/detail";this.$router.push({path:a,query:{id:e.id,from:"customer"}})},async handleView(e){try{const t=await h["a"].getCase(e.id);if(t&&t.data&&t.data.success){const a=t.data.data;this.viewForm={...e,clientName:a.customerName||"未知客户",caseNo:a.case_code,techLeaderName:a.tech_leader||"未分配",techContactName:a.tech_contact||"未分配",presaleSupport:a.presale_support||"否",applicationCountry:this.getCountryName(a.country_code),agencyName:a.agency_name||"",category:a.category||"",projectType:a.project_type||"",remark:a.remarks||a.case_description||"",creator:a.created_by||"",createTime:a.created_at||"",updater:a.updated_by||"",updateTime:a.updated_at||""}}else this.viewForm=JSON.parse(JSON.stringify(e))}catch(t){console.error("获取项目详情失败:",t),this.viewForm=JSON.parse(JSON.stringify(e))}this.viewDialogVisible=!0},handleSizeChange(e){this.pageSize=e,this.getCaseList()},handleCurrentChange(e){this.pageNum=e,this.getCaseList()},getCountryName(e){const t={CN:"中国",US:"美国",EP:"欧盟",JP:"日本"};return t[e]||"中国"}}},U=B,j=(a("0f52"),Object(c["a"])(U,M,O,!1,null,null,null)),J=j.exports,Q=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-related-person-container"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("相关人员列表")]),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("添加助理/协作人")])],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.groupedPersonList,border:""}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),t("el-table-column",{attrs:{label:"业务人员",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"person-info"},[t("div",{staticClass:"person-name"},[e._v(e._s(a.row.businessPerson.name))]),t("div",{staticClass:"person-contact"},[e._v(" "+e._s(a.row.businessPerson.phone||"无联系电话")+" ")]),t("div",{staticClass:"person-department"},[e._v(" "+e._s(a.row.businessPerson.department||"无部门")+" ")])])]}}])}),t("el-table-column",{attrs:{label:"业务助理",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.assistant?t("div",[t("div",{staticClass:"person-name"},[e._v(e._s(a.row.assistant.name))]),t("div",{staticClass:"person-contact"},[e._v(" "+e._s(a.row.assistant.phone||"无联系电话")+" ")]),t("div",{staticClass:"person-actions"},[e.canEditAssistant(a.row)?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleEdit(a.row.assistant)}}},[e._v("编辑")]):e._e(),e.canDeleteAssistant(a.row)?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleDelete(a.row.assistant)}}},[e._v("移除")]):e._e()],1)]):t("div",{staticClass:"empty-slot"},[t("span",{staticStyle:{color:"#909399"}},[e._v("暂无助理")]),t("br"),e.canAddAssistant(a.row)?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleAddAssistant(a.row.businessPerson)}}},[e._v("添加助理")]):e._e()],1)]}}])}),t("el-table-column",{attrs:{label:"业务协作人",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.collaborator?t("div",[t("div",{staticClass:"person-name"},[e._v(e._s(a.row.collaborator.name))]),t("div",{staticClass:"person-contact"},[e._v(" "+e._s(a.row.collaborator.phone||"无联系电话")+" ")]),t("div",{staticClass:"person-actions"},[e.canEditCollaborator(a.row)?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleEdit(a.row.collaborator)}}},[e._v("编辑")]):e._e(),e.canDeleteCollaborator(a.row)?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleDelete(a.row.collaborator)}}},[e._v("移除")]):e._e()],1)]):t("div",{staticClass:"empty-slot"},[t("span",{staticStyle:{color:"#909399"}},[e._v("暂无协作人")]),t("br"),e.canAddCollaborator(a.row)?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleAddCollaborator(a.row.businessPerson)}}},[e._v("添加协作人")]):e._e()],1)]}}])}),t("el-table-column",{attrs:{label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var s,i;return[t("div",{staticClass:"remarks-info"},[a.row.assistant&&a.row.assistant.remarks?t("div",{staticClass:"remark-item"},[t("span",{staticClass:"remark-label"},[e._v("助理:")]),t("span",{staticClass:"remark-text"},[e._v(e._s(a.row.assistant.remarks))])]):e._e(),a.row.collaborator&&a.row.collaborator.remarks?t("div",{staticClass:"remark-item"},[t("span",{staticClass:"remark-label"},[e._v("协作人:")]),t("span",{staticClass:"remark-text"},[e._v(e._s(a.row.collaborator.remarks))])]):e._e(),null!==(s=a.row.assistant)&&void 0!==s&&s.remarks||null!==(i=a.row.collaborator)&&void 0!==i&&i.remarks?e._e():t("div",{staticStyle:{color:"#909399"}},[e._v(" 无备注 ")])])]}}])})],1)],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"人员类型",prop:"personType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:null!==e.form.id},on:{change:e.handlePersonTypeChange},model:{value:e.form.personType,callback:function(t){e.$set(e.form,"personType",t)},expression:"form.personType"}},[t("el-option",{attrs:{label:"业务助理",value:"业务助理"}}),t("el-option",{attrs:{label:"业务协作人",value:"业务协作人"}})],1)],1),t("el-form-item",{attrs:{label:"关联业务员",prop:"relatedBusinessPerson"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择关联的业务员",disabled:null!==e.form.id},on:{change:e.handleBusinessPersonChange},model:{value:e.form.relatedBusinessPerson,callback:function(t){e.$set(e.form,"relatedBusinessPerson",t)},expression:"form.relatedBusinessPerson"}},e._l(e.businessPersonOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"人员姓名",prop:"selectedPersonId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词搜索用户","remote-method":e.remoteSearchUser,loading:e.searchLoading},on:{change:e.handleUserSelect},model:{value:e.form.selectedPersonId,callback:function(t){e.$set(e.form,"selectedPersonId",t)},expression:"form.selectedPersonId"}},e._l(e.userOptions,(function(a){return t("el-option",{key:a.id,attrs:{label:a.name||a.username,value:a.id}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(a.name||a.username))]),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(a.department||""))])])})),1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"部门"}},[t("el-input",{attrs:{placeholder:"自动获取",disabled:""},model:{value:e.form.department,callback:function(t){e.$set(e.form,"department",t)},expression:"form.department"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"手机"}},[t("el-input",{attrs:{placeholder:"自动获取",disabled:""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"邮箱"}},[t("el-input",{attrs:{placeholder:"自动获取",disabled:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入备注信息"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建人",prop:"creator"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.creator,callback:function(t){e.$set(e.form,"creator",t)},expression:"form.creator"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建时间",prop:"createTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.createTime,callback:function(t){e.$set(e.form,"createTime",t)},expression:"form.createTime"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新人",prop:"updater"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updater,callback:function(t){e.$set(e.form,"updater",t)},expression:"form.updater"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间",prop:"updateTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updateTime,callback:function(t){e.$set(e.form,"updateTime",t)},expression:"form.updateTime"}})],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"人员详情",visible:e.viewDialogVisible,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[t("el-descriptions",{attrs:{border:"",column:2}},[t("el-descriptions-item",{attrs:{label:"姓名"}},[e._v(e._s(e.viewForm.name))]),t("el-descriptions-item",{attrs:{label:"人员类型"}},[e._v(e._s(e.viewForm.personType))]),t("el-descriptions-item",{attrs:{label:"关联业务员"}},[e._v(e._s(e.viewForm.relatedBusinessPersonName||"无"))]),t("el-descriptions-item",{attrs:{label:"部门"}},[e._v(e._s(e.viewForm.department||"无"))]),t("el-descriptions-item",{attrs:{label:"手机"}},[e._v(e._s(e.viewForm.phone||"无"))]),t("el-descriptions-item",{attrs:{label:"邮箱"}},[e._v(e._s(e.viewForm.email||"无"))]),t("el-descriptions-item",{attrs:{label:"备注",span:2}},[e._v(e._s(e.viewForm.remarks||"无"))]),t("el-descriptions-item",{attrs:{label:"创建人"}},[e._v(e._s(e.viewForm.creator||"无"))]),t("el-descriptions-item",{attrs:{label:"创建时间"}},[e._v(e._s(e.viewForm.createTime||"无"))]),t("el-descriptions-item",{attrs:{label:"更新人"}},[e._v(e._s(e.viewForm.updater||"无"))]),t("el-descriptions-item",{attrs:{label:"更新时间"}},[e._v(e._s(e.viewForm.updateTime||"无"))])],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.viewDialogVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},G=[],Y=a("5f87"),H={name:"CustomerRelatedPersonTab",props:{customerId:{type:[String,Number],required:!0}},data(){return{isAdmin:!1,currentUserId:null,loading:!1,searchLoading:!1,businessPersonList:[],relatedPersonList:[],pageNum:1,pageSize:10,total:0,queryParams:{name:"",personType:""},dialogVisible:!1,dialogTitle:"",viewDialogVisible:!1,viewForm:{},form:{id:null,name:"",selectedPersonId:null,personType:"",department:"",position:"",phone:"",email:"",remarks:"",relatedBusinessPerson:null},rules:{selectedPersonId:[{required:!0,message:"请选择人员",trigger:"change"}],personType:[{required:!0,message:"请选择人员类型",trigger:"change"}],relatedBusinessPerson:[{required:!0,message:"请选择关联业务员",trigger:"change"}]},userOptions:[],businessPersonOptions:[]}},computed:{groupedPersonList(){const e=new Map;return this.businessPersonList.forEach(t=>{e.set(t.id,{businessPerson:t,assistant:null,collaborator:null})}),this.relatedPersonList.forEach(t=>{const a=e.get(t.relatedBusinessPerson);a&&("业务助理"===t.personType?a.assistant=t:"业务协作人"===t.personType&&(a.collaborator=t))}),Array.from(e.values())}},created(){this.checkUserRole(),this.getBusinessPersonList(),this.getRelatedPersonList()},methods:{checkUserRole(){const e=Object(Y["j"])();e&&(this.currentUserId=e.id,this.isAdmin=1===e.type||"1"===e.type)},async getBusinessPersonList(){try{const e=await h["a"].getCustomerBusinessPersons({customer_id:this.customerId});e&&e.data&&e.data.success?(this.businessPersonList=(e.data.data||[]).filter(e=>"业务人员"===e.type||"业务人员"===e.role),this.businessPersonOptions=this.businessPersonList.map(e=>({id:e.id,name:e.name}))):(console.error("获取业务人员列表失败:",e.data?e.data.message:"未知错误"),this.businessPersonList=[],this.businessPersonOptions=[])}catch(e){console.error("获取业务人员列表失败:",e),this.businessPersonList=[],this.businessPersonOptions=[]}},async getRelatedPersonList(){this.loading=!0;try{const e={customer_id:this.customerId,page:this.pageNum,page_size:this.pageSize,name:this.queryParams.name,person_type:this.queryParams.personType},t=await h["a"].getRelatedPersonList(e),a=t&&t.data&&t.data.data?t.data.data:{list:[],total:0};this.relatedPersonList=(a.list||[]).map(e=>({id:e.id,customer_id:e.customer_id,name:e.person_name||e.personName,personType:e.person_type,department:e.department,phone:e.phone,email:e.email,remarks:e.remarks||e.remark,relatedBusinessPerson:e.related_business_person_id||e.relatedBusinessPerson,relatedBusinessPersonName:e.related_business_person_name,creator:e.creator||"无",createTime:e.created_at||"无",updater:e.updater||"无",updateTime:e.updated_at||"无"})),this.total=a.total||0}catch(e){console.error("获取相关人员列表失败:",e),this.$message.error("获取相关人员列表失败"),this.relatedPersonList=[],this.total=0}finally{this.loading=!1}},resetQuery(){this.queryParams={name:"",personType:""},this.getRelatedPersonList()},async remoteSearchUser(e){if(""!==e){this.searchLoading=!0;try{const t=await h["a"].searchUsers({keyword:e,limit:20});t&&t.data&&t.data.success?this.userOptions=t.data.data||[]:(console.error("搜索用户失败:",t.data?t.data.message:"未知错误"),this.userOptions=[])}catch(t){console.error("搜索用户失败:",t),this.userOptions=[]}finally{this.searchLoading=!1}}else this.userOptions=[]},handlePersonTypeChange(e){this.form.name="",this.form.selectedPersonId=null,this.form.department="",this.form.phone="",this.form.email="",this.validatePersonTypeForBusinessPerson()},handleBusinessPersonChange(e){this.form.name="",this.form.selectedPersonId=null,this.form.department="",this.form.phone="",this.form.email="",this.validatePersonTypeForBusinessPerson()},validatePersonTypeForBusinessPerson(){if(this.form.relatedBusinessPerson&&this.form.personType){const t=this.relatedPersonList.find(e=>e.personType===this.form.personType&&e.relatedBusinessPerson===this.form.relatedBusinessPerson&&e.id!==this.form.id);if(t){var e;const a="业务助理"===this.form.personType?"助理":"协作人",s=(null===(e=this.businessPersonOptions.find(e=>e.id===this.form.relatedBusinessPerson))||void 0===e?void 0:e.name)||"该业务员";this.$message.warning(`${s}已有${a}（${t.name}），请先移除现有${a}或选择其他业务员`)}}},handleUserSelect(e){const t=this.userOptions.find(t=>t.id===e);t&&(this.form.name=t.name||t.username,this.form.department=t.department||"",this.form.phone=t.phone||"",this.form.email=t.email||"")},handleAdd(){this.form={id:null,name:"",selectedPersonId:null,personType:"",department:"",position:"",phone:"",email:"",remarks:"",relatedBusinessPerson:null},this.dialogTitle="添加助理/协作人",this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.form&&this.$refs.form.clearValidate()})},handleAddAssistant(e){this.form={id:null,name:"",selectedPersonId:null,personType:"业务助理",department:"",position:"",phone:"",email:"",remarks:"",relatedBusinessPerson:e.id},this.dialogTitle=`为${e.name}添加业务助理`,this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.form&&this.$refs.form.clearValidate()})},handleAddCollaborator(e){this.form={id:null,name:"",selectedPersonId:null,personType:"业务协作人",department:"",position:"",phone:"",email:"",remarks:"",relatedBusinessPerson:e.id},this.dialogTitle=`为${e.name}添加业务协作人`,this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.form&&this.$refs.form.clearValidate()})},handleView(e){this.viewForm=JSON.parse(JSON.stringify(e)),this.viewDialogVisible=!0},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.form.selectedPersonId=e.id,this.dialogTitle="编辑相关人员",this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.form&&this.$refs.form.clearValidate()})},handleDelete(e){const t="业务助理"===e.personType?"助理":"协作人";this.$confirm(`确认移除该${t}?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await h["a"].deleteRelatedPerson(e.id),this.$message.success("移除成功"),this.getRelatedPersonList()}catch(t){console.error("删除相关人员失败:",t),this.$message.error("删除失败")}}).catch(()=>{this.$message.info("已取消移除")})},canAddAssistant(e){return this.isAdmin&&!e.assistant},canAddCollaborator(e){return this.isAdmin&&!e.collaborator},canEditAssistant(e){return!this.isAdmin||e.businessPerson.id===this.currentUserId},canEditCollaborator(e){return!this.isAdmin||e.businessPerson.id===this.currentUserId},canDeleteAssistant(e){return this.canEditAssistant(e)},canDeleteCollaborator(e){return this.canEditCollaborator(e)},getCurrentUser(){const e=Object(Y["j"])();return e?e.real_name||e.username:"未知用户"},getCurrentTime(){return(new Date).toLocaleString("zh-CN")},async submitForm(){this.$refs.form.validate(async e=>{if(e)try{const e={customer_id:this.customerId,person_name:this.form.name,person_type:this.form.personType,department:this.form.department,phone:this.form.phone,email:this.form.email,remark:this.form.remarks,related_business_person_id:this.form.relatedBusinessPerson};this.form.id?(await h["a"].updateRelatedPerson(this.form.id,e),this.$message.success("修改成功")):(await h["a"].createRelatedPerson(e),this.$message.success("添加成功")),this.dialogVisible=!1,this.getRelatedPersonList()}catch(t){console.error("保存相关人员失败:",t),this.$message.error("保存失败")}})},handleSizeChange(e){this.pageSize=e,this.getRelatedPersonList()},handleCurrentChange(e){this.pageNum=e,this.getRelatedPersonList()}}},K=H,Z=(a("da30"),Object(c["a"])(K,Q,G,!1,null,"e8dc9bac",null)),W=Z.exports,X=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customer-contract-container"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("合同列表")]),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增合同")])],1),t("div",{staticClass:"search-container"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.queryParams}},[t("el-form-item",[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"合同名称",clearable:""},model:{value:e.queryParams.contractName,callback:function(t){e.$set(e.queryParams,"contractName",t)},expression:"queryParams.contractName"}})],1),t("el-form-item",[t("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"业务服务类型",clearable:""},model:{value:e.queryParams.contractType,callback:function(t){e.$set(e.queryParams,"contractType",t)},expression:"queryParams.contractType"}},[t("el-option",{attrs:{label:"专利申请",value:"专利申请"}}),t("el-option",{attrs:{label:"商标注册",value:"商标注册"}}),t("el-option",{attrs:{label:"版权登记",value:"版权登记"}}),t("el-option",{attrs:{label:"技术咨询",value:"技术咨询"}})],1)],1),t("el-form-item",[t("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"合同状态",clearable:""},model:{value:e.queryParams.contractStatus,callback:function(t){e.$set(e.queryParams,"contractStatus",t)},expression:"queryParams.contractStatus"}},[t("el-option",{attrs:{label:"草稿",value:"草稿"}}),t("el-option",{attrs:{label:"审核中",value:"审核中"}}),t("el-option",{attrs:{label:"已签约",value:"已签约"}}),t("el-option",{attrs:{label:"执行中",value:"执行中"}}),t("el-option",{attrs:{label:"已完成",value:"已完成"}}),t("el-option",{attrs:{label:"已取消",value:"已取消"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.getContractList}},[e._v("查询")]),t("el-button",{attrs:{plain:"",icon:"el-icon-refresh"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.contractList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),t("el-table-column",{attrs:{label:"序号",type:"index",width:"60",align:"center"}}),t("el-table-column",{attrs:{label:"合同编号",prop:"contractCode",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"合同名称",prop:"contractName",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"业务服务类型",prop:"contractType",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"合同状态",prop:"contractStatus",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusType(a.row.contractStatus)}},[e._v(e._s(a.row.contractStatus))])]}}])}),t("el-table-column",{attrs:{label:"技术主导",prop:"techLeader",align:"center",width:"100"}}),t("el-table-column",{attrs:{label:"总服务费",prop:"totalServiceFee",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.totalServiceFee||0)+" ")]}}])}),t("el-table-column",{attrs:{label:"官费",prop:"marketingFee",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.marketingFee||0)+" ")]}}])}),t("el-table-column",{attrs:{label:"实际官费",prop:"actualMarketingFee",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.actualMarketingFee||0)+" ")]}}])}),t("el-table-column",{attrs:{label:"实收服务费",prop:"actualServiceFee",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.actualServiceFee||0)+" ")]}}])}),t("el-table-column",{attrs:{label:"最后收款日期",prop:"lastPaymentDate",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"签订日期",prop:"signDate",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"乙方签约人",prop:"partyBSigner",align:"center",width:"100"}}),t("el-table-column",{attrs:{label:"乙方公司",prop:"partyBCompany",align:"center",width:"120"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handleView(a.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-download"},on:{click:function(t){return e.handleDownload(a.row)}}},[e._v("下载")]),"草稿"===a.row.contractStatus?t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")]):e._e()]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"700px","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"contractForm",attrs:{model:e.form,rules:e.rules,"label-width":"100px",disabled:"view"===e.dialogStatus}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"合同编号",prop:"contractCode"}},[t("el-input",{attrs:{placeholder:"系统自动生成",disabled:""},model:{value:e.form.contractCode,callback:function(t){e.$set(e.form,"contractCode",t)},expression:"form.contractCode"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"合同类型",prop:"contractType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择合同类型"},model:{value:e.form.contractType,callback:function(t){e.$set(e.form,"contractType",t)},expression:"form.contractType"}},[t("el-option",{attrs:{label:"专利申请",value:"专利申请"}}),t("el-option",{attrs:{label:"商标注册",value:"商标注册"}}),t("el-option",{attrs:{label:"版权登记",value:"版权登记"}}),t("el-option",{attrs:{label:"技术咨询",value:"技术咨询"}})],1)],1)],1)],1),t("el-form-item",{attrs:{label:"合同名称",prop:"contractName"}},[t("el-input",{attrs:{placeholder:"请输入合同名称"},model:{value:e.form.contractName,callback:function(t){e.$set(e.form,"contractName",t)},expression:"form.contractName"}})],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"签订日期",prop:"signDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择签订日期","value-format":"yyyy-MM-dd"},model:{value:e.form.signDate,callback:function(t){e.$set(e.form,"signDate",t)},expression:"form.signDate"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"到期日期",prop:"expireDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择到期日期","value-format":"yyyy-MM-dd"},model:{value:e.form.expireDate,callback:function(t){e.$set(e.form,"expireDate",t)},expression:"form.expireDate"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"合同金额",prop:"amount"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,min:0,step:1e3},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"合同状态",prop:"contractStatus"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择合同状态"},model:{value:e.form.contractStatus,callback:function(t){e.$set(e.form,"contractStatus",t)},expression:"form.contractStatus"}},[t("el-option",{attrs:{label:"草稿",value:"草稿"}}),t("el-option",{attrs:{label:"审核中",value:"审核中"}}),t("el-option",{attrs:{label:"已签约",value:"已签约"}}),t("el-option",{attrs:{label:"执行中",value:"执行中"}}),t("el-option",{attrs:{label:"已完成",value:"已完成"}}),t("el-option",{attrs:{label:"已取消",value:"已取消"}})],1)],1)],1)],1),t("el-form-item",{attrs:{label:"合同内容",prop:"content"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入合同内容摘要",rows:4},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息",rows:2},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),"view"===e.dialogStatus?t("el-form-item",{attrs:{label:"附件"}},[e.form.attachments&&e.form.attachments.length>0?t("div",e._l(e.form.attachments,(function(a,s){return t("div",{key:s,staticClass:"file-item"},[t("i",{staticClass:"el-icon-document"}),t("span",{staticClass:"file-name"},[e._v(e._s(a.name))]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.downloadAttachment(a)}}},[e._v("下载")])],1)})),0):t("div",[e._v("暂无附件")])]):t("el-form-item",{attrs:{label:"附件"}},[t("el-upload",{attrs:{action:"#","http-request":e.uploadFile,"file-list":e.fileList,"on-remove":e.handleRemove,multiple:"",limit:5}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传 doc/docx/pdf/zip 文件，且不超过10MB")])],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建人",prop:"creator"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.creator,callback:function(t){e.$set(e.form,"creator",t)},expression:"form.creator"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建时间",prop:"createTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.createTime,callback:function(t){e.$set(e.form,"createTime",t)},expression:"form.createTime"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新人",prop:"updater"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updater,callback:function(t){e.$set(e.form,"updater",t)},expression:"form.updater"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间",prop:"updateTime"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updateTime,callback:function(t){e.$set(e.form,"updateTime",t)},expression:"form.updateTime"}})],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),"view"!==e.dialogStatus?t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]):e._e()],1)],1)],1)},ee=[],te={name:"CustomerContractTab",props:{customerId:{type:[String,Number],required:!0}},data(){return{loading:!1,contractList:[],pageNum:1,pageSize:10,total:0,queryParams:{contractName:"",contractType:"",contractStatus:""},dialogVisible:!1,dialogStatus:"",dialogTitle:"",form:{id:void 0,contractCode:"",contractName:"",contractType:"",amount:0,signDate:"",expireDate:"",contractStatus:"草稿",content:"",remark:"",attachments:[]},rules:{contractName:[{required:!0,message:"请输入合同名称",trigger:"blur"}],contractType:[{required:!0,message:"请选择合同类型",trigger:"change"}],amount:[{required:!0,message:"请输入合同金额",trigger:"blur"}],signDate:[{required:!0,message:"请选择签订日期",trigger:"change"}]},fileList:[]}},created(){this.getContractList()},methods:{async getContractList(){this.loading=!0;try{const e={customer_id:this.customerId,page:this.pageNum,page_size:this.pageSize,contract_name:this.queryParams.contractName,contract_type:this.queryParams.contractType,status:this.queryParams.contractStatus},t=await h["a"].getContractList(e),a=t&&t.data&&t.data.data?t.data.data:{list:[],total:0};this.contractList=(a.list||[]).map(e=>({id:e.id,contractCode:e.contract_code||e.contractCode,contractName:e.contract_name||e.contractName,contractType:e.contract_type||e.contractType||e.service_type,contractStatus:e.contract_status||e.status||"草稿",techLeader:e.tech_leader||e.techLeader||"未分配",totalServiceFee:e.total_service_fee||e.service_amount||0,marketingFee:e.marketing_fee||e.official_fee||0,actualMarketingFee:e.actual_marketing_fee||e.actual_official_fee||0,actualServiceFee:e.actual_service_fee||e.actual_amount||0,lastPaymentDate:e.last_payment_date||e.lastPaymentDate,signDate:e.sign_date||e.signDate,partyBSigner:e.party_b_signer||e.signer_b||"未指定",partyBCompany:e.party_b_company||e.company_b||"未指定"})),this.total=a.total||0}catch(e){console.error("获取合同列表失败:",e),this.$message.error("获取合同列表失败"),this.contractList=[],this.total=0}finally{this.loading=!1}},resetQuery(){this.queryParams={contractName:"",contractType:"",contractStatus:""},this.getContractList()},getStatusType(e){switch(e){case"草稿":return"info";case"审核中":return"warning";case"已签约":return"primary";case"执行中":return"success";case"已完成":return"";case"已取消":return"danger";default:return"info"}},handleAdd(){this.$router.push({path:"/contract/add"})},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.fileList=e.attachments?e.attachments.map(e=>({name:e.name,url:e.url})):[],this.dialogStatus="edit",this.dialogTitle="编辑合同",this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.contractForm.clearValidate()})},handleView(e){this.$router.push({path:"/contract/view",query:{id:e.id}})},async handleDelete(e){this.$confirm("确认删除该合同?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await h["a"].deleteContract(e.id),this.$message.success("删除成功"),this.getContractList()}catch(t){console.error("删除合同失败:",t),this.$message.error("删除失败")}}).catch(()=>{})},handleDownload(e){this.$message.success(e.contractName+"下载成功")},downloadAttachment(e){this.$message.success(e.name+"下载成功")},uploadFile(e){const{file:t}=e;setTimeout(()=>{this.fileList.push({name:t.name,url:URL.createObjectURL(t)}),this.$message.success(t.name+"上传成功")},500)},handleRemove(e,t){this.fileList=t},getCurrentUser(){return"当前用户"},getCurrentTime(){return(new Date).toLocaleString("zh-CN")},submitForm(){this.$refs.contractForm.validate(e=>{if(e){this.form.attachments=this.fileList.map((e,t)=>({id:t+1,name:e.name,url:e.url}));const e=this.getCurrentTime(),t=this.getCurrentUser();this.form.id||(this.form.creator=t,this.form.createTime=e),this.form.updater=t,this.form.updateTime=e,"add"===this.dialogStatus?this.$message.success("添加成功"):this.$message.success("修改成功"),this.dialogVisible=!1,this.getContractList()}})},generateContractNo(){return String(Math.floor(9e3*Math.random())+1e3).padStart(4,"0")},formatDate(e){const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${s}`},handleSizeChange(e){this.pageSize=e,this.getContractList()},handleCurrentChange(e){this.pageNum=e,this.getContractList()}}},ae=te,se=(a("a186"),Object(c["a"])(ae,X,ee,!1,null,null,null)),ie=se.exports,re=a("0656"),oe={name:"CustomerDetail",components:{TabsNav:m,CustomerFileTab:_,CustomerContactsTab:k,CustomerApplicantTab:I,CustomerInventorTab:V,CustomerCaseTab:J,CustomerRelatedPersonTab:W,CustomerContractTab:ie},data(){return{customerId:this.$route.params.id,activeTab:"info",loading:!1,saveLoading:!1,showBusinessPersonDialog:!1,customerBusinessPersons:[],selectedBusinessPersons:[],customer:{id:"",name:"",contactName:"",contactPhone:"",email:"",industry:"",level:"",status:"",owner:"",createTime:"",tags:[],remark:"",avatar:"",rating:0,companyType:"",registeredCapital:"",foundingDate:"",employeeCount:"",customerScale:"",region:"",address:"",zipCode:"",website:"",businessLicense:"",lastContactTime:"",contractCount:0,caseCount:0,cooperationYears:0,totalAmount:0,importantEvents:[],nameEn:"",customerCode:"",creditCode:"",legalRepresentative:"",scale:"",assistant:"",collaborators:"",latestContractDate:"",creator:"",updater:"",updateTime:"",country:"中国",province:"上海市",city:"上海市",district:"浦东新区",addressEn:"No.2 Boyun Road, Zhangjiang Hi-Tech Park, Pudong New District, Shanghai",otherAddress:"上海市徐汇区研发中心",industrialPark:"张江高科技园区",accountName:"上海睿道知识产权有限公司",bankName:"中国工商银行上海张江支行",bankAccount:"62227777888899991234",invoiceAddress:"上海市浦东新区张江高科技园区博云路2号",invoicePhone:"021-88889999",isGeneralTaxpayer:!0,billingAddress:"上海市浦东新区张江高科技园区博云路2号",economicCategory:"科学研究和技术服务业",economicLargeClass:"专业技术服务业",economicMediumClass:"知识产权服务",economicSmallClass:"知识产权代理服务",trademarkCount:25,patentCount:42,inventionPatentCount:18,copyrightCount:13,hasAdditionalDeduction:!0,hasSchoolCooperation:!0,cooperationSchool:"上海交通大学",sales2021:"1580万元",sales2020:"1320万元",sales2019:"980万元",rdCost2021:"320万元",rdCost2020:"280万元",rdCost2019:"210万元",loan2021:"500万元",loan2020:"300万元",loan2019:"200万元",isHighTech:!0,highTechDate:"2020-09-15",isProvinceEnterprise:!0,provinceEnterpriseDate:"2019-11-20",isCityEnterprise:!0,cityEnterpriseDate:"2018-07-12",hasIpStandard:!0,ipStandardDate:"2021-05-18",hasInfoStandard:!1,infoStandardDate:"",businessPerson:"王销售",businessAssistant:"王助理",businessPartner:"张三、李四、王五",companyManager:"李总",processStaff:"张流程",qq:"123456789",wechat:"wx123456",economicDoor:"科学研究和技术服务业",economicBigClass:"专业技术服务业",economicMidClass:"知识产权服务",researchFee2021:"320万元",researchFee2020:"280万元",researchFee2019:"210万元",highTechEnterprise:"",provinceEnterprise:"",cityEnterprise:"",provinceTechCenter:"",provinceTechCenterDate:"2022-03-15",ipStandard:"",itStandard:"",isJinxinVerified:"",jinxinVerifyDate:"2023-05-15",isScienceVerified:"",scienceVerifyDate:"2023-06-15",spare1:"预留字段1",spare2:"预留字段2",spare3:"预留字段3",spare4:"预留字段4",spare5:"预留字段5",priceIndex:"85",innovationIndex:"92",originalSalesperson:"李原销售",publicSeaName:"科技企业公海",mainProducts:"知识产权代理服务，专利服务，商标服务",businessScope:"知识产权代理，企业管理咨询，专利代理，商标代理",researchStaffCount:"25",doctorCount:"5",seniorEngineerCount:"8",masterCount:"12",middleEngineerCount:"15",bachelorCount:"35",overseasReturneeCount:"3",researchProject2019:"专利分析系统研发，专利申请管理系统",projectAmount2019:"150万元",researchProject2020:"知识产权管理平台，商标查询系统",projectAmount2020:"200万元",researchProject2021:"人工智能专利分析，商标图像识别",projectAmount2021:"280万元",rdEquipmentOriginalValue2019:"800万元",hasAuditReport2019:"1",assetLiabilityRatio2019:"45%",fixedAssetInvestment2019:"300万元",equipmentInvestment2019:"200万元",smartEquipmentInvestment2019:"150万元",rdEquipmentInvestment2019:"100万元",itInvestment2019:"80万元",hasImportedEquipment2019:"1",hasInvestmentRecord2019:"1",recordAmount2019:"250万元",recordPeriod2019:"2019-01-01至2019-12-31",rdEquipmentOriginalValue2020:"950万元",hasAuditReport2020:"1",assetLiabilityRatio2020:"42%",fixedAssetInvestment2020:"350万元",equipmentInvestment2020:"230万元",smartEquipmentInvestment2020:"180万元",rdEquipmentInvestment2020:"120万元",itInvestment2020:"100万元",hasImportedEquipment2020:"1",hasInvestmentRecord2020:"1",recordAmount2020:"300万元",recordPeriod2020:"2020-01-01至2020-12-31",rdEquipmentOriginalValue2021:"1100万元",hasAuditReport2021:"1",assetLiabilityRatio2021:"38%",fixedAssetInvestment2021:"400万元",equipmentInvestment2021:"260万元",smartEquipmentInvestment2021:"200万元",rdEquipmentInvestment2021:"150万元",itInvestment2021:"120万元",hasImportedEquipment2021:"1",hasInvestmentRecord2021:"1",recordAmount2021:"350万元",recordPeriod2021:"2021-01-01至2021-12-31",salesData:{},rdCostData:{},loanData:{},researchProjectData:{},projectAmountData:{},rdEquipmentOriginalValueData:{},hasAuditReportData:{},assetLiabilityRatioData:{},fixedAssetInvestmentData:{},equipmentInvestmentData:{},smartEquipmentInvestmentData:{},rdEquipmentInvestmentData:{},itInvestmentData:{},hasImportedEquipmentData:{},hasInvestmentRecordData:{},recordAmountData:{},recordPeriodData:{}},contactList:[],followupList:[],tabOptions:[{name:"info",label:"客户详情"},{name:"contact",label:"联系人"},{name:"applicant",label:"申请人"},{name:"inventor",label:"发明人"},{name:"contract",label:"合同"},{name:"file",label:"客户文件"},{name:"case",label:"客户项目"},{name:"contact-person",label:"相关人员"}],industryOptions:[{value:"it",label:"IT行业"},{value:"finance",label:"金融行业"},{value:"manufacture",label:"制造业"},{value:"education",label:"教育行业"},{value:"medicine",label:"医疗行业"}],levelOptions:[],priceIndexOptions:[],innovationIndexOptions:[],businessPersonOptions:[],countryOptions:[],areaOptions:[],economicDoorOptions:[],economicBigClassOptions:[],economicMidClassOptions:[],economicSmallClassOptions:[],customerScaleOptions:[],statusOptions:[{value:"potential",label:"潜在客户"},{value:"intention",label:"意向客户"},{value:"signed",label:"已签约"},{value:"lost",label:"已流失"}],routeTitle:"客户详情",isEditMode:!0,editForm:{customerCode:"",name:"",nameEn:"",creditCode:"",legalRepresentative:"",companyManager:"",level:"",employeeCount:"",customerScale:"",businessPerson:"",businessAssistant:"",businessPartner:"",priceIndex:"",innovationIndex:"",contractCount:"",latestContractDate:"",remark:"",country:"",province:"",city:"",district:"",areaCode:[],address:"",addressEn:"",otherAddress:"",industrialPark:"",zipCode:"",website:"",accountName:"",bankName:"",bankAccount:"",invoiceAddress:"",invoicePhone:"",isGeneralTaxpayer:!1,billingAddress:"",invoiceCreditCode:"",economicCategory:"",economicDoor:"",economicBigClass:"",economicMidClass:"",economicSmallClass:"",foundingDate:"",mainProducts:"",companyStaffCount:"",registeredCapital:"",researchStaffCount:"",doctorCount:"",masterCount:"",bachelorCount:"",overseasReturneeCount:"",middleEngineerCount:"",seniorEngineerCount:"",businessScope:"",trademarkCount:0,patentCount:0,inventionPatentCount:0,copyrightCount:0,hasAdditionalDeduction:!1,hasSchoolCooperation:!1,cooperationSchool:"",sales2021:"",sales2020:"",sales2019:"",rdCost2021:"",rdCost2020:"",rdCost2019:"",loan2021:"",loan2020:"",loan2019:"",isHighTech:!0,highTechDate:"",isProvinceEnterprise:!0,provinceEnterpriseDate:"",isCityEnterprise:!0,cityEnterpriseDate:"",hasIpStandard:!0,ipStandardDate:"",hasInfoStandard:!1,infoStandardDate:"",researchFee2021:"",researchFee2020:"",researchFee2019:"",highTechEnterprise:"",provinceEnterprise:"",cityEnterprise:"",provinceTechCenter:"",provinceTechCenterDate:"",ipStandard:"",itStandard:"",isJinxinVerified:"",jinxinVerifyDate:"",isScienceVerified:"",scienceVerifyDate:"",spare1:"",spare2:"",spare3:"",spare4:"",spare5:"",originalSalesperson:"",publicSeaName:"",researchProject2019:"",projectAmount2019:"",researchProject2020:"",projectAmount2020:"",researchProject2021:"",projectAmount2021:"",rdEquipmentOriginalValue2019:"",hasAuditReport2019:"",assetLiabilityRatio2019:"",fixedAssetInvestment2019:"",equipmentInvestment2019:"",smartEquipmentInvestment2019:"",rdEquipmentInvestment2019:"",itInvestment2019:"",hasImportedEquipment2019:"",hasInvestmentRecord2019:"",recordAmount2019:"",recordPeriod2019:"",rdEquipmentOriginalValue2020:"",hasAuditReport2020:"",assetLiabilityRatio2020:"",fixedAssetInvestment2020:"",equipmentInvestment2020:"",smartEquipmentInvestment2020:"",rdEquipmentInvestment2020:"",itInvestment2020:"",hasImportedEquipment2020:"",hasInvestmentRecord2020:"",recordAmount2020:"",recordPeriod2020:"",rdEquipmentOriginalValue2021:"",hasAuditReport2021:"",assetLiabilityRatio2021:"",fixedAssetInvestment2021:"",equipmentInvestment2021:"",smartEquipmentInvestment2021:"",rdEquipmentInvestment2021:"",itInvestment2021:"",hasImportedEquipment2021:"",hasInvestmentRecord2021:"",recordAmount2021:"",recordPeriod2021:"",salesData:{},rdCostData:{},loanData:{},researchProjectData:{},projectAmountData:{},rdEquipmentOriginalValueData:{},hasAuditReportData:{},assetLiabilityRatioData:{},fixedAssetInvestmentData:{},equipmentInvestmentData:{},smartEquipmentInvestmentData:{},rdEquipmentInvestmentData:{},itInvestmentData:{},hasImportedEquipmentData:{},hasInvestmentRecordData:{},recordAmountData:{},recordPeriodData:{}},originalData:{},formRules:{name:[{required:!0,message:"请输入客户名称",trigger:"blur"}],creditCode:[{required:!0,message:"请输入统一社会信用代码",trigger:"blur"},{validator:this.validateCreditCode,trigger:"blur"}]}}},async created(){await this.getConfigData(),await this.getCustomerScaleOptions(),this.getCustomerDetail().then(()=>{this.enterEditMode()}),this.getContactList(),this.getFollowupList(),document.title="客户详情 - "+this.customerId;const{tab:e}=this.$route.query;e&&this.tabOptions.some(t=>t.name===e)&&(this.activeTab=e),this.updateRouteTitle()},watch:{"customer.name":{handler(e){e&&(document.title="客户详情 - "+e,this.routeTitle="客户详情 - "+e,this.$store.dispatch("updateVisitedView",{...this.$route,meta:{...this.$route.meta,title:"客户详情 - "+e}}),this.updateRouteTitle())},immediate:!0}},methods:{async getConfigData(){try{const e=await h["a"].getConfigData();if(e.data&&e.data.success){const t=e.data.data;t.levels&&t.levels.length>0&&(this.levelOptions=t.levels.map(e=>({label:e.label,value:e.value}))),t.priceIndices&&t.priceIndices.length>0&&(this.priceIndexOptions=t.priceIndices.map(e=>({label:e.label,value:e.value}))),t.innovationIndices&&t.innovationIndices.length>0&&(this.innovationIndexOptions=t.innovationIndices.map(e=>({label:e.label,value:e.value})))}this.countryOptions=S["a"].map(e=>({label:e.cn,value:e.cn})),this.areaOptions=T,this.initEconomicClassificationOptions(),await this.getBusinessPersonList()}catch(e){console.error("获取配置数据失败:",e),this.$message.warning("获取配置数据失败，请刷新页面重试")}},async getCustomerScaleOptions(){try{const e=await h["a"].getCustomerScaleOptions();e&&e.data&&0===e.data.code&&(this.customerScaleOptions=e.data.data||[])}catch(e){console.error("获取客户规模选项失败:",e),this.$message.warning("获取客户规模选项失败")}},async getBusinessPersonList(){try{const e=await A["default"].getList({status:1,limit:1e3});e&&e.data&&0===e.data.code&&(this.businessPersonOptions=e.data.data.map(e=>({label:e.real_name||e.username,value:e.id})))}catch(e){console.error("获取业务人员列表失败:",e),this.$message.warning("获取业务人员列表失败")}},async getCustomerBusinessPersons(){try{const e=await h["a"].getCustomerBusinessPersons({customer_id:this.customerId});e&&e.data&&e.data.success?this.customerBusinessPersons=e.data.data||[]:this.customerBusinessPersons=[]}catch(e){console.error("获取客户业务人员失败:",e),this.customerBusinessPersons=[]}},isBusinessPersonSelected(e){return this.customerBusinessPersons.some(t=>t.id===e)},async removeBusinessPerson(e){try{await h["a"].removeCustomerBusinessPerson({customer_id:this.customerId,business_person_id:e.id});const t=this.customerBusinessPersons.findIndex(t=>t.id===e.id);t>-1&&this.customerBusinessPersons.splice(t,1),this.$message.success("移除成功")}catch(t){console.error("移除业务人员失败:",t),this.$message.error("移除失败")}},async saveBusinessPersons(){try{this.selectedBusinessPersons.length>0&&(await h["a"].addCustomerBusinessPerson({customer_id:this.customerId,business_person_ids:this.selectedBusinessPersons}),await this.getCustomerBusinessPersons(),this.selectedBusinessPersons=[],this.$message.success("保存成功")),this.showBusinessPersonDialog=!1}catch(e){console.error("保存业务人员失败:",e),this.$message.error("保存失败")}},initEconomicClassificationOptions(){this.economicDoorOptions=re["a"].map(e=>({value:e.value,label:e.label}))},handleDoorChange(e){if(this.editForm.economicBigClass="",this.editForm.economicMidClass="",this.editForm.economicSmallClass="",this.economicBigClassOptions=[],this.economicMidClassOptions=[],this.economicSmallClassOptions=[],e){const t=re["a"].find(t=>t.label===e);t&&t.children&&(this.economicBigClassOptions=t.children.map(e=>({value:e.value,label:e.label})))}},handleBigClassChange(e){if(this.editForm.economicMidClass="",this.editForm.economicSmallClass="",this.economicMidClassOptions=[],this.economicSmallClassOptions=[],e){const t=re["a"].find(e=>e.label===this.editForm.economicDoor);if(t&&t.children){const a=t.children.find(t=>t.label===e);a&&a.children&&(this.economicMidClassOptions=a.children.map(e=>({value:e.value,label:e.label})))}}},handleMidClassChange(e){if(this.editForm.economicSmallClass="",this.economicSmallClassOptions=[],e){const t=re["a"].find(e=>e.label===this.editForm.economicDoor);if(t&&t.children){const a=t.children.find(e=>e.label===this.editForm.economicBigClass);if(a&&a.children){const t=a.children.find(t=>t.label===e);t&&t.children&&(this.economicSmallClassOptions=t.children.map(e=>({value:e.value,label:e.label})))}}}},handleAreaChange(e){e&&e.length>=3?(this.editForm.province=this.getAreaNameByCode(e[0],0),this.editForm.city=this.getAreaNameByCode(e[1],1,e[0]),this.editForm.district=this.getAreaNameByCode(e[2],2,e[0],e[1])):(this.editForm.province="",this.editForm.city="",this.editForm.district="")},getAreaNameByCode(e,t,a=null,s=null){if(0===t){const t=this.areaOptions.find(t=>t.value===e);return t?t.label:""}if(1===t){const t=this.areaOptions.find(e=>e.value===a);if(t&&t.children){const a=t.children.find(t=>t.value===e);return a?a.label:""}}else if(2===t){const t=this.areaOptions.find(e=>e.value===a);if(t&&t.children){const a=t.children.find(e=>e.value===s);if(a&&a.children){const t=a.children.find(t=>t.value===e);return t?t.label:""}}}return""},getFullAddress(){const e=[];return this.customer.province&&e.push(this.customer.province),this.customer.city&&e.push(this.customer.city),this.customer.district&&e.push(this.customer.district),e.join(" ")},getBusinessPersonLabel(e){const t=this.businessPersonOptions.find(t=>t.value===e);return t?t.label:e},getPriceIndexLabel(e){const t=this.priceIndexOptions.find(t=>t.value===e);return t?t.label:e},getInnovationIndexLabel(e){const t=this.innovationIndexOptions.find(t=>t.value===e);return t?t.label:e},async checkCreditCodeUnique(){if(this.editForm.creditCode)try{const e=await h["a"].checkCustomerCodeUnique({customerCode:this.editForm.creditCode,customerId:this.customer.id});e.data&&!e.data.success&&(this.$message.error("该信用代码已存在，请使用其他信用代码"),this.$refs.basicForm.validateField("creditCode"))}catch(e){console.error("验证信用代码失败:",e)}},validateCreditCode(e,t,a){t?t.length<6?a(new Error("信用代码长度不能少于6位")):a():a(new Error("请输入统一社会信用代码"))},parseJsonField(e,t={}){if(!e)return t;try{return"string"===typeof e?JSON.parse(e):e}catch(a){return console.warn("JSON解析失败:",e,a),t}},serializeJsonField(e){if(!e||"string"===typeof e)return e;try{return JSON.stringify(e)}catch(t){return console.warn("JSON序列化失败:",e,t),null}},updateRouteTitle(){try{document.title=this.customer.name?"客户详情 - "+this.customer.name:"客户详情",this.$store&&this.$store.dispatch&&"function"===typeof this.$store.dispatch&&this.$store.state.tagsView&&this.$store.dispatch("tagsView/updateVisitedView",{...this.$route,meta:{...this.$route.meta,title:this.customer.name?"客户详情 - "+this.customer.name:"客户详情"}}).catch(e=>{console.warn("更新路由标题失败:",e)})}catch(e){console.warn("更新路由标题时出错:",e)}},goBack(){this.$router.go(-1)},handleEdit(){this.isEditMode=!0},handleTabClick(e){this.activeTab=e,this.$router.replace({path:this.$route.path,query:{...this.$route.query,tab:e}})},async getCustomerDetail(){try{this.loading=!0;const e=await h["a"].getCustomerDetail(this.customerId),t=e&&e.data&&e.data.data?e.data.data:{};this.customer={id:t.id||this.customerId,name:t.name||"",nameEn:t.name_en||"",customerCode:t.customer_code||"",creditCode:t.credit_code||"",legalRepresentative:t.legal_representative||"",companyManager:t.company_manager||"",level:t.level||"",employeeCount:t.employee_count||"",customerScale:t.customer_scale||"",businessPerson:t.business_person||"",businessAssistant:t.business_assistant||"",businessPartner:t.business_partner||"",priceIndex:t.price_index||"",innovationIndex:t.innovation_index||"",contractCount:t.contract_count||"0",latestContractDate:t.latest_contract_date||"",creator:t.creator||"系统管理员",createTime:t.created_at||t.create_time||"",updater:t.updater||"",updateTime:t.updated_at||t.update_time||"",remark:t.remark||"",contactName:t.contact_name||"",contactPhone:t.contact_phone||"",email:t.email||"",qq:t.qq||"",wechat:t.wechat||"",country:t.country||"中国",province:t.province||"",city:t.city||"",district:t.district||"",address:t.address||"",addressEn:t.address_en||"",otherAddress:t.other_address||"",industrialPark:t.industrial_park||"",zipCode:t.zip_code||"",website:t.website||"",accountName:t.account_name||"",bankName:t.bank_name||"",bankAccount:t.bank_account||"",invoiceAddress:t.invoice_address||"",invoicePhone:t.invoice_phone||"",isGeneralTaxpayer:t.is_general_taxpayer||!1,billingAddress:t.billing_address||"",companyType:t.company_type||"",registeredCapital:t.registered_capital||"",foundingDate:t.founding_date||"",industry:t.industry||"",mainProducts:t.main_products||"",businessScope:t.business_scope||"",economicCategory:t.economic_category||"",economicDoor:t.economic_door||"",economicBigClass:t.economic_big_class||"",economicMidClass:t.economic_mid_class||"",economicSmallClass:t.economic_small_class||"",researchStaffCount:t.research_staff_count||"",doctorCount:t.doctor_count||"",seniorEngineerCount:t.senior_engineer_count||"",masterCount:t.master_count||"",middleEngineerCount:t.middle_engineer_count||"",bachelorCount:t.bachelor_count||"",overseasReturneeCount:t.overseas_returnee_count||"",trademarkCount:t.trademark_count||0,patentCount:t.patent_count||0,inventionPatentCount:t.invention_patent_count||0,copyrightCount:t.copyright_count||0,hasAdditionalDeduction:t.has_additional_deduction||!1,hasSchoolCooperation:t.has_school_cooperation||!1,cooperationSchool:t.cooperation_school||"",status:"signed",owner:t.business_person||"未分配",avatar:"",isJinxinVerified:t.is_jinxin_verified||"0",jinxinVerifyDate:t.jinxin_verify_date||"",isScienceVerified:t.is_science_verified||"0",scienceVerifyDate:t.science_verify_date||"",highTechEnterprise:t.high_tech_enterprise||"0",highTechDate:t.high_tech_date||"",provinceEnterprise:t.province_enterprise||"0",provinceEnterpriseDate:t.province_enterprise_date||"",cityEnterprise:t.city_enterprise||"0",cityEnterpriseDate:t.city_enterprise_date||"",provinceTechCenter:t.province_tech_center||"0",provinceTechCenterDate:t.province_tech_center_date||"",ipStandard:t.ip_standard||"0",ipStandardDate:t.ip_standard_date||"",itStandard:t.it_standard||"0",infoStandardDate:t.info_standard_date||"",spare1:t.spare1||"",spare2:t.spare2||"",spare3:t.spare3||"",spare4:t.spare4||"",spare5:t.spare5||"",originalSalesperson:t.original_salesperson||"",publicSeaName:t.public_sea_name||"",salesData:this.parseJsonField(t.sales_data),rdCostData:this.parseJsonField(t.rd_cost_data),loanData:this.parseJsonField(t.loan_data),researchProjectData:this.parseJsonField(t.research_project_data),projectAmountData:this.parseJsonField(t.project_amount_data),rdEquipmentOriginalValueData:this.parseJsonField(t.rd_equipment_original_value_data),hasAuditReportData:this.parseJsonField(t.has_audit_report_data),assetLiabilityRatioData:this.parseJsonField(t.asset_liability_ratio_data),fixedAssetInvestmentData:this.parseJsonField(t.fixed_asset_investment_data),equipmentInvestmentData:this.parseJsonField(t.equipment_investment_data),smartEquipmentInvestmentData:this.parseJsonField(t.smart_equipment_investment_data),rdEquipmentInvestmentData:this.parseJsonField(t.rd_equipment_investment_data),itInvestmentData:this.parseJsonField(t.it_investment_data),hasImportedEquipmentData:this.parseJsonField(t.has_imported_equipment_data),hasInvestmentRecordData:this.parseJsonField(t.has_investment_record_data),recordAmountData:this.parseJsonField(t.record_amount_data),recordPeriodData:this.parseJsonField(t.record_period_data),tags:this.parseJsonField(t.tags,[]),importantEvents:this.parseJsonField(t.important_events,[]),rating:t.rating||4.5},document.title="客户详情 - "+this.customer.name,await this.getCustomerBusinessPersons()}catch(e){console.error("获取客户详情失败:",e),this.$message.error("获取客户详情失败，请重试")}finally{this.loading=!1}},getContactList(){setTimeout(()=>{this.contactList=[{id:1,name:"张经理",position:"技术总监",phone:"13800138000",email:"zhangsan@example.com",isMain:!0},{id:2,name:"李助理",position:"行政助理",phone:"13900139000",email:"lisi@example.com",isMain:!1},{id:3,name:"王财务",position:"财务主管",phone:"13700137000",email:"wangwu@example.com",isMain:!1}]},300)},getFollowupList(){setTimeout(()=>{this.followupList=[{time:"2023-05-15 14:30",title:"电话沟通",content:"就新项目合作事宜进行了详细沟通，客户表示有意向继续合作",creator:"张三",type:"phone"},{time:"2023-04-20 10:00",title:"现场拜访",content:"拜访客户公司，介绍了我司新产品，客户反馈良好",creator:"李四",type:"visit"},{time:"2023-03-05 16:45",title:"邮件沟通",content:"发送了产品方案和报价单，客户正在研究",creator:"王五",type:"email"}]},300)},getIndustryLabel(e){const t=this.industryOptions.find(t=>t.value===e);return t?t.label:e},getLevelLabel(e){const t=this.levelOptions.find(t=>t.value===e);return t?t.label:e},getCustomerScaleLabel(e){const t=this.customerScaleOptions.find(t=>t.value===e);return t?t.label:e},getStatusLabel(e){const t=this.statusOptions.find(t=>t.value===e);return t?t.label:e},getStatusType(e){const t={potential:"info",intention:"warning",signed:"success",lost:"danger"};return t[e]||"info"},editContact(e){this.$message.info("编辑联系人功能正在开发中")},deleteContact(e){this.$confirm("确认删除该联系人?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.success("删除成功")}).catch(()=>{})},getActivityType(e){const t={phone:"primary",visit:"success",email:"info",meeting:"warning"};return t[e]||"primary"},enterEditMode(){this.isEditMode=!0,this.originalData=JSON.parse(JSON.stringify(this.customer)),Object.keys(this.editForm).forEach(e=>{"object"!==typeof this.editForm[e]||null===this.editForm[e]||Array.isArray(this.editForm[e])?this.editForm[e]=this.customer[e]||"":this.editForm[e]={}}),this.editForm.salesData||this.$set(this.editForm,"salesData",{}),this.editForm.rdCostData||this.$set(this.editForm,"rdCostData",{}),this.editForm.loanData||this.$set(this.editForm,"loanData",{}),this.editForm.researchProjectData||this.$set(this.editForm,"researchProjectData",{}),this.editForm.projectAmountData||this.$set(this.editForm,"projectAmountData",{}),this.editForm.rdEquipmentOriginalValueData||this.$set(this.editForm,"rdEquipmentOriginalValueData",{}),this.editForm.hasAuditReportData||this.$set(this.editForm,"hasAuditReportData",{}),this.editForm.assetLiabilityRatioData||this.$set(this.editForm,"assetLiabilityRatioData",{}),this.editForm.fixedAssetInvestmentData||this.$set(this.editForm,"fixedAssetInvestmentData",{}),this.editForm.equipmentInvestmentData||this.$set(this.editForm,"equipmentInvestmentData",{}),this.editForm.smartEquipmentInvestmentData||this.$set(this.editForm,"smartEquipmentInvestmentData",{}),this.editForm.rdEquipmentInvestmentData||this.$set(this.editForm,"rdEquipmentInvestmentData",{}),this.editForm.itInvestmentData||this.$set(this.editForm,"itInvestmentData",{}),this.editForm.hasImportedEquipmentData||this.$set(this.editForm,"hasImportedEquipmentData",{}),this.editForm.hasInvestmentRecordData||this.$set(this.editForm,"hasInvestmentRecordData",{}),this.editForm.recordAmountData||this.$set(this.editForm,"recordAmountData",{}),this.editForm.recordPeriodData||this.$set(this.editForm,"recordPeriodData",{}),this.recentYears.forEach(e=>{this.$set(this.editForm.salesData,e,this.customer.salesData?this.customer.salesData[e]:null),this.$set(this.editForm.rdCostData,e,this.customer.rdCostData?this.customer.rdCostData[e]:null),this.$set(this.editForm.loanData,e,this.customer.loanData?this.customer.loanData[e]:null),this.$set(this.editForm.researchProjectData,e,this.customer.researchProjectData?this.customer.researchProjectData[e]:""),this.$set(this.editForm.projectAmountData,e,this.customer.projectAmountData?this.customer.projectAmountData[e]:null),this.$set(this.editForm.rdEquipmentOriginalValueData,e,this.customer.rdEquipmentOriginalValueData?this.customer.rdEquipmentOriginalValueData[e]:null),this.$set(this.editForm.hasAuditReportData,e,this.customer.hasAuditReportData?this.customer.hasAuditReportData[e]:"0"),this.$set(this.editForm.assetLiabilityRatioData,e,this.customer.assetLiabilityRatioData?this.customer.assetLiabilityRatioData[e]:null),this.$set(this.editForm.fixedAssetInvestmentData,e,this.customer.fixedAssetInvestmentData?this.customer.fixedAssetInvestmentData[e]:null),this.$set(this.editForm.equipmentInvestmentData,e,this.customer.equipmentInvestmentData?this.customer.equipmentInvestmentData[e]:null),this.$set(this.editForm.smartEquipmentInvestmentData,e,this.customer.smartEquipmentInvestmentData?this.customer.smartEquipmentInvestmentData[e]:null),this.$set(this.editForm.rdEquipmentInvestmentData,e,this.customer.rdEquipmentInvestmentData?this.customer.rdEquipmentInvestmentData[e]:null),this.$set(this.editForm.itInvestmentData,e,this.customer.itInvestmentData?this.customer.itInvestmentData[e]:null),this.$set(this.editForm.hasImportedEquipmentData,e,this.customer.hasImportedEquipmentData?this.customer.hasImportedEquipmentData[e]:"0"),this.$set(this.editForm.hasInvestmentRecordData,e,this.customer.hasInvestmentRecordData?this.customer.hasInvestmentRecordData[e]:"0"),this.$set(this.editForm.recordAmountData,e,this.customer.recordAmountData?this.customer.recordAmountData[e]:null),this.$set(this.editForm.recordPeriodData,e,this.customer.recordPeriodData?this.customer.recordPeriodData[e]:"")})},cancelEdit(){this.$confirm("确认取消编辑？未保存的数据将丢失","提示",{confirmButtonText:"确定",cancelButtonText:"继续编辑",type:"warning"}).then(()=>{this.isEditMode=!1,this.customer=JSON.parse(JSON.stringify(this.originalData)),this.originalData={},this.$nextTick(()=>{this.$refs.basicForm&&this.$refs.basicForm.clearValidate(),this.$refs.addressForm&&this.$refs.addressForm.clearValidate()})}).catch(()=>{})},saveCustomerInfo(){this.saveLoading||this.$refs.basicForm.validate(e=>{e?(Object.keys(this.editForm).forEach(e=>{this.customer[e]=this.editForm[e]}),this.updateCustomerInfo()):this.$message.error("请检查表单填写是否正确")})},async updateCustomerInfo(){try{this.saveLoading=!0;const e={name:this.editForm.name,name_en:this.editForm.nameEn,credit_code:this.editForm.creditCode,legal_representative:this.editForm.legalRepresentative,company_manager:this.editForm.companyManager,level:this.editForm.level,employee_count:this.editForm.employeeCount,customer_scale:this.editForm.customerScale,business_person:this.editForm.businessPerson,business_assistant:this.editForm.businessAssistant,business_partner:this.editForm.businessPartner,price_index:this.editForm.priceIndex,innovation_index:this.editForm.innovationIndex,contract_count:this.editForm.contractCount,latest_contract_date:this.editForm.latestContractDate,remark:this.editForm.remark,contact_name:this.editForm.contactName,contact_phone:this.editForm.contactPhone,email:this.editForm.email,qq:this.editForm.qq,wechat:this.editForm.wechat,country:this.editForm.country,province:this.editForm.province,city:this.editForm.city,district:this.editForm.district,address:this.editForm.address,address_en:this.editForm.addressEn,other_address:this.editForm.otherAddress,industrial_park:this.editForm.industrialPark,zip_code:this.editForm.zipCode,website:this.editForm.website,account_name:this.editForm.accountName,bank_name:this.editForm.bankName,bank_account:this.editForm.bankAccount,invoice_address:this.editForm.invoiceAddress,invoice_phone:this.editForm.invoicePhone,is_general_taxpayer:this.editForm.isGeneralTaxpayer,billing_address:this.editForm.billingAddress,company_type:this.editForm.companyType,registered_capital:this.editForm.registeredCapital,founding_date:this.editForm.foundingDate,industry:this.editForm.industry,main_products:this.editForm.mainProducts,business_scope:this.editForm.businessScope,economic_category:this.editForm.economicCategory,economic_door:this.editForm.economicDoor,economic_big_class:this.editForm.economicBigClass,economic_mid_class:this.editForm.economicMidClass,economic_small_class:this.editForm.economicSmallClass,research_staff_count:this.editForm.researchStaffCount,doctor_count:this.editForm.doctorCount,senior_engineer_count:this.editForm.seniorEngineerCount,master_count:this.editForm.masterCount,middle_engineer_count:this.editForm.middleEngineerCount,bachelor_count:this.editForm.bachelorCount,overseas_returnee_count:this.editForm.overseasReturneeCount,trademark_count:this.editForm.trademarkCount,patent_count:this.editForm.patentCount,invention_patent_count:this.editForm.inventionPatentCount,copyright_count:this.editForm.copyrightCount,has_additional_deduction:this.editForm.hasAdditionalDeduction,has_school_cooperation:this.editForm.hasSchoolCooperation,cooperation_school:this.editForm.cooperationSchool,is_jinxin_verified:this.editForm.isJinxinVerified,jinxin_verify_date:this.editForm.jinxinVerifyDate,is_science_verified:this.editForm.isScienceVerified,science_verify_date:this.editForm.scienceVerifyDate,high_tech_enterprise:this.editForm.highTechEnterprise,high_tech_date:this.editForm.highTechDate,province_enterprise:this.editForm.provinceEnterprise,province_enterprise_date:this.editForm.provinceEnterpriseDate,city_enterprise:this.editForm.cityEnterprise,city_enterprise_date:this.editForm.cityEnterpriseDate,province_tech_center:this.editForm.provinceTechCenter,province_tech_center_date:this.editForm.provinceTechCenterDate,ip_standard:this.editForm.ipStandard,ip_standard_date:this.editForm.ipStandardDate,it_standard:this.editForm.itStandard,info_standard_date:this.editForm.infoStandardDate,sales_data:this.serializeJsonField(this.editForm.salesData),rd_cost_data:this.serializeJsonField(this.editForm.rdCostData),loan_data:this.serializeJsonField(this.editForm.loanData),research_project_data:this.serializeJsonField(this.editForm.researchProjectData),project_amount_data:this.serializeJsonField(this.editForm.projectAmountData),rd_equipment_original_value_data:this.serializeJsonField(this.editForm.rdEquipmentOriginalValueData),has_audit_report_data:this.serializeJsonField(this.editForm.hasAuditReportData),asset_liability_ratio_data:this.serializeJsonField(this.editForm.assetLiabilityRatioData),fixed_asset_investment_data:this.serializeJsonField(this.editForm.fixedAssetInvestmentData),equipment_investment_data:this.serializeJsonField(this.editForm.equipmentInvestmentData),smart_equipment_investment_data:this.serializeJsonField(this.editForm.smartEquipmentInvestmentData),rd_equipment_investment_data:this.serializeJsonField(this.editForm.rdEquipmentInvestmentData),it_investment_data:this.serializeJsonField(this.editForm.itInvestmentData),has_imported_equipment_data:this.serializeJsonField(this.editForm.hasImportedEquipmentData),has_investment_record_data:this.serializeJsonField(this.editForm.hasInvestmentRecordData),record_amount_data:this.serializeJsonField(this.editForm.recordAmountData),record_period_data:this.serializeJsonField(this.editForm.recordPeriodData)},t=await h["a"].updateCustomer(this.customerId,e);t&&t.data&&t.data.success&&(this.$message.success("保存成功"),this.originalData={},this.getCustomerDetail())}catch(e){console.error("保存客户信息失败:",e),this.$message.error("保存失败，请重试")}finally{this.saveLoading=!1}}},computed:{recentYears(){const e=(new Date).getFullYear();return[e-1,e-2,e-3]}}},le=oe,ne=(a("8d29"),a("8e0a"),Object(c["a"])(le,s,i,!1,null,"24eb9080",null));t["default"]=ne.exports},da30:function(e,t,a){"use strict";a("14a4")},f0bf:function(e,t,a){}}]);