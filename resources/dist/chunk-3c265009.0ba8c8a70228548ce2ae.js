(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c265009"],{"98c5":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"manuscript-scoring-config"},[e("div",{staticClass:"body-part-search"},[e("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:t.searchForm}},[e("el-form-item",{attrs:{label:"大类"}},[e("el-input",{staticClass:"filter-item",attrs:{size:"small",placeholder:"请输入大类",clearable:""},model:{value:t.searchForm.majorCategory,callback:function(e){t.$set(t.searchForm,"majorCategory",e)},expression:"searchForm.majorCategory"}})],1),e("el-form-item",{attrs:{label:"小类"}},[e("el-input",{staticClass:"filter-item",attrs:{size:"small",placeholder:"请输入小类",clearable:""},model:{value:t.searchForm.minorCategory,callback:function(e){t.$set(t.searchForm,"minorCategory",e)},expression:"searchForm.minorCategory"}})],1),e("el-form-item",{attrs:{label:"是否有效"}},[e("el-select",{staticClass:"filter-item",attrs:{size:"small",placeholder:"请选择",clearable:""},model:{value:t.searchForm.isValid,callback:function(e){t.$set(t.searchForm,"isValid",e)},expression:"searchForm.isValid"}},[e("el-option",{attrs:{label:"全部",value:""}}),e("el-option",{attrs:{label:"是",value:!0}}),e("el-option",{attrs:{label:"否",value:!1}})],1)],1),e("el-form-item",[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("查询")]),e("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1)],1),e("div",{staticClass:"body-part-content"},[e("div",{staticClass:"part-table-header"},[t._m(0),e("div",{staticClass:"part-table-operations"},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v("新增")])],1)]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",size:"small"}},[e("el-table-column",{attrs:{label:"序号",type:"index",width:"80",align:"center"}}),e("el-table-column",{attrs:{align:"center",prop:"sort",label:"排序",width:"80",sortable:""}}),e("el-table-column",{attrs:{align:"center",prop:"majorCategory",label:"大类","min-width":"120"}}),e("el-table-column",{attrs:{align:"center",prop:"minorCategory",label:"小类"}}),e("el-table-column",{attrs:{align:"center",prop:"description",label:"说明","min-width":"200"}}),e("el-table-column",{attrs:{align:"center",prop:"score",label:"分值",width:"100"}}),e("el-table-column",{attrs:{align:"center",prop:"isValid",label:"是否有效",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:a.row.isValid?"success":"info"}},[t._v(" "+t._s(a.row.isValid?"是":"否")+" ")])]}}])}),e("el-table-column",{attrs:{align:"center",label:"操作",width:"200",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.handleView(a.row)}}},[t._v("查看")]),e("el-button",{attrs:{size:"small"},on:{click:function(e){return t.handleEdit(a.row)}}},[t._v("编辑")])]}}])})],1),e("el-pagination",{attrs:{"current-page":t.pagination.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.pagination.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),e("el-dialog",{attrs:{title:t.manuscriptScoringDialogTitle,visible:t.manuscriptScoringDialogVisible,width:"650px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(e){t.manuscriptScoringDialogVisible=e}}},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px",rules:t.rules}},[e("el-form-item",{attrs:{label:"排序",prop:"sort"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,placeholder:"请输入排序值"},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1),e("el-form-item",{attrs:{label:"大类",prop:"majorCategory"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入大类"},model:{value:t.form.majorCategory,callback:function(e){t.$set(t.form,"majorCategory",e)},expression:"form.majorCategory"}})],1),e("el-form-item",{attrs:{label:"小类",prop:"minorCategory"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入小类"},model:{value:t.form.minorCategory,callback:function(e){t.$set(t.form,"minorCategory",e)},expression:"form.minorCategory"}})],1),e("el-form-item",{attrs:{label:"说明",prop:"description"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",rows:4,placeholder:"请输入说明内容"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),e("el-form-item",{attrs:{label:"分值",prop:"score"}},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:100,step:1},model:{value:t.form.score,callback:function(e){t.$set(t.form,"score",e)},expression:"form.score"}})],1),e("el-form-item",{attrs:{label:"是否有效",prop:"isValid"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"是或否二选一"},model:{value:t.form.isValid,callback:function(e){t.$set(t.form,"isValid",e)},expression:"form.isValid"}},[e("el-option",{attrs:{label:"是",value:!0}}),e("el-option",{attrs:{label:"否",value:!1}})],1)],1),"编辑审核打分项"===t.manuscriptScoringDialogTitle?e("el-form-item",{attrs:{label:"更新人"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"系统记录",disabled:""},model:{value:t.form.updatedBy,callback:function(e){t.$set(t.form,"updatedBy",e)},expression:"form.updatedBy"}})],1):t._e(),"编辑审核打分项"===t.manuscriptScoringDialogTitle?e("el-form-item",{attrs:{label:"更新时间"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"系统记录",disabled:""},model:{value:t.form.updatedAt,callback:function(e){t.$set(t.form,"updatedAt",e)},expression:"form.updatedAt"}})],1):t._e()],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleCancel}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("保存")])],1)],1)],1)},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"part-table-title"},[e("span",[t._v("审核打分项设置")])])}],o=(a("e9f5"),a("ab43"),{name:"ManuscriptScoringConfig",data(){return{loading:!1,manuscriptScoringDialogVisible:!1,manuscriptScoringDialogTitle:"新增审核打分项",searchForm:{majorCategory:"",minorCategory:"",isValid:""},tableData:[],pagination:{currentPage:1,pageSize:10,total:0},form:{id:null,sort:1,majorCategory:"",minorCategory:"",description:"",score:0,isValid:!0},rules:{sort:[{required:!0,message:"请输入排序值",trigger:"blur"}],majorCategory:[{required:!0,message:"请输入大类",trigger:"blur"}],minorCategory:[{required:!0,message:"请输入小类",trigger:"blur"}],description:[{required:!0,message:"请输入说明",trigger:"blur"}],score:[{required:!0,message:"请输入分值",trigger:"change"}],isValid:[{required:!0,message:"请选择是否有效",trigger:"change"}]}}},created(){this.fetchData()},methods:{async fetchData(){this.loading=!0;try{const t={page:this.pagination.currentPage,limit:this.pagination.pageSize,keyword:[this.searchForm.majorCategory,this.searchForm.minorCategory].filter(Boolean).join(" "),status:""!==this.searchForm.isValid?this.searchForm.isValid?1:0:""},e=await this.$api.dataConfig.manuscriptScoring.getList(t);if(e.data&&0===e.data.code){const t=Array.isArray(e.data.data.list)?e.data.data.list:[];this.tableData=t.map(t=>{var e,a,r;return{id:t.id,sort:null!==(e=null!==(a=t.sort)&&void 0!==a?a:t.sort_order)&&void 0!==e?e:1,majorCategory:t.major_category||"",minorCategory:t.minor_category||"",description:t.description||"",score:null!==(r=t.score)&&void 0!==r?r:0,isValid:1===t.status||!0===t.status,updatedBy:t.updated_by,updatedAt:t.updated_at}}),this.pagination.total=e.data.data.total||t.length||0}else this.$message.error(e.data&&e.data.msg||"获取列表失败")}catch(t){console.error("获取审核打分项失败:",t),this.$message.error("获取列表失败")}finally{this.loading=!1}},handleSearch(){this.pagination.currentPage=1,this.fetchData()},resetSearch(){this.searchForm={majorCategory:"",minorCategory:"",isValid:""},this.handleSearch()},handleSizeChange(t){this.pagination.pageSize=t,this.pagination.currentPage=1,this.fetchData()},handleCurrentChange(t){this.pagination.currentPage=t,this.fetchData()},handleAdd(){this.manuscriptScoringDialogTitle="新增审核打分项",this.form={id:null,sort:1,majorCategory:"",minorCategory:"",description:"",score:0,isValid:!0},this.manuscriptScoringDialogVisible=!0},handleEdit(t){this.manuscriptScoringDialogTitle="编辑审核打分项",this.form=JSON.parse(JSON.stringify(t)),this.manuscriptScoringDialogVisible=!0},handleView(t){this.manuscriptScoringDialogTitle="查看审核打分项",this.form=JSON.parse(JSON.stringify(t)),this.manuscriptScoringDialogVisible=!0},async handleSave(){this.$refs.form.validate(async t=>{if(t)try{var e;const t=`${this.form.majorCategory}-${this.form.minorCategory}`,a={name:t,code:t.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_\u4e00-\u9fa5]/g,""),major_category:this.form.majorCategory,minor_category:this.form.minorCategory,description:this.form.description,score:this.form.score,max_score:this.form.score||100,weight:1,status:this.form.isValid?1:0,sort_order:null!==(e=this.form.sort)&&void 0!==e?e:1};let r;r=this.form.id?await this.$api.dataConfig.manuscriptScoring.update(this.form.id,a):await this.$api.dataConfig.manuscriptScoring.create(a),r.data&&0===r.data.code?(this.$message.success("保存成功"),this.manuscriptScoringDialogVisible=!1,this.fetchData()):this.$message.error(r.data&&r.data.msg||"保存失败")}catch(a){console.error("保存失败:",a),this.$message.error("保存失败，请稍后重试")}})},handleCancel(){this.manuscriptScoringDialogVisible=!1},handleExport(){this.$message.success("导出成功")},async handleDelete(t){this.$confirm("确认删除该打分项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=await this.$api.dataConfig.manuscriptScoring.delete(t.id);e.data&&0===e.data.code?(this.$message.success("删除成功"),this.fetchData()):this.$message.error(e.data&&e.data.msg||"删除失败")}catch(e){console.error("删除失败:",e),this.$message.error("删除失败，请稍后重试")}}).catch(()=>{this.$message.info("已取消删除")})}}}),s=o,l=(a("a8e0"),a("2877")),n=Object(l["a"])(s,r,i,!1,null,"36551ad6",null);e["default"]=n.exports},"9d08":function(t,e,a){},a8e0:function(t,e,a){"use strict";a("9d08")}}]);