(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-437099fe"],{"037a":function(e,t,s){"use strict";s("abe8")},"1b89":function(e,t,s){"use strict";s("8670")},"1e5a":function(e,t,s){"use strict";var a=s("23e7"),i=s("9961"),r=s("dad2");a({target:"Set",proto:!0,real:!0,forced:!r("symmetricDifference")},{symmetricDifference:i})},"1e70":function(e,t,s){"use strict";var a=s("23e7"),i=s("a5f7"),r=s("dad2"),n=!r("difference",(function(e){return 0===e.size}));a({target:"Set",proto:!0,real:!0,forced:n},{difference:i})},"384f":function(e,t,s){"use strict";var a=s("e330"),i=s("5388"),r=s("cb27"),n=r.Set,l=r.proto,o=a(l.forEach),c=a(l.keys),u=c(new n).next;e.exports=function(e,t,s){return s?i({iterator:c(e),next:u},t):o(e,t)}},"395e":function(e,t,s){"use strict";var a=s("dc19"),i=s("cb27").has,r=s("8e16"),n=s("7f65"),l=s("5388"),o=s("2a62");e.exports=function(e){var t=a(this),s=n(e);if(r(t)<s.size)return!1;var c=s.getIterator();return!1!==l(c,(function(e){if(!i(t,e))return o(c,"normal",!1)}))}},5388:function(e,t,s){"use strict";var a=s("c65b");e.exports=function(e,t,s){var i,r,n=s?e:e.iterator,l=e.next;while(!(i=a(l,n)).done)if(r=t(i.value),void 0!==r)return r}},"68df":function(e,t,s){"use strict";var a=s("dc19"),i=s("8e16"),r=s("384f"),n=s("7f65");e.exports=function(e){var t=a(this),s=n(e);return!(i(t)>s.size)&&!1!==r(t,(function(e){if(!s.includes(e))return!1}),!0)}},"70e5":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{key:e.componentKey,staticClass:"all-customer-container"},[t("div",{staticClass:"body-part-search"},[t("div",{staticClass:"filter-form"},[t("el-form",{ref:"queryForm",attrs:{model:e.queryParams,"label-width":"100px"}},[t("div",{staticClass:"default-filters"},[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户名称",prop:"name"}},[t("el-input",{staticClass:"filter-item",attrs:{placeholder:"客户名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery.apply(null,arguments)}},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"信用代码",prop:"creditCode"}},[t("el-input",{staticClass:"filter-item",attrs:{placeholder:"信用代码",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery.apply(null,arguments)}},model:{value:e.queryParams.creditCode,callback:function(t){e.$set(e.queryParams,"creditCode",t)},expression:"queryParams.creditCode"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户等级",prop:"level"}},[t("el-select",{staticClass:"filter-item",attrs:{placeholder:"客户等级",clearable:"",size:"small"},model:{value:e.queryParams.level,callback:function(t){e.$set(e.queryParams,"level",t)},expression:"queryParams.level"}},e._l(e.levelOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户规模",prop:"customerScale"}},[t("el-select",{staticClass:"filter-item",attrs:{placeholder:"客户规模",clearable:"",size:"small"},model:{value:e.queryParams.customerScale,callback:function(t){e.$set(e.queryParams,"customerScale",t)},expression:"queryParams.customerScale"}},e._l(e.customerScaleOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"合同数量",prop:"contractCount"}},[t("el-input",{staticStyle:{width:"40%"},attrs:{size:"small"},model:{value:e.queryParams.contractCount1,callback:function(t){e.$set(e.queryParams,"contractCount1",t)},expression:"queryParams.contractCount1"}}),e._v(" 到 "),t("el-input",{staticStyle:{width:"40%"},attrs:{size:"small"},model:{value:e.queryParams.contractCount2,callback:function(t){e.$set(e.queryParams,"contractCount2",t)},expression:"queryParams.contractCount2"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"最新合同日期",prop:"latestContractDate"}},[t("el-date-picker",{staticClass:"filter-item date-range",attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small"},model:{value:e.contractDateRange,callback:function(t){e.contractDateRange=t},expression:"contractDateRange"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"公司负责人",prop:"companyManager"}},[t("el-input",{staticClass:"filter-item",attrs:{placeholder:"公司负责人",clearable:"",size:"small"},model:{value:e.queryParams.companyManager,callback:function(t){e.$set(e.queryParams,"companyManager",t)},expression:"queryParams.companyManager"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"创建人",prop:"creator"}},[t("el-select",{staticClass:"filter-item",attrs:{placeholder:"创建人",clearable:"",size:"small"},model:{value:e.queryParams.creator,callback:function(t){e.$set(e.queryParams,"creator",t)},expression:"queryParams.creator"}},e._l(e.userOptions,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"创建日期",prop:"createDate"}},[t("el-date-picker",{staticClass:"filter-item date-range",attrs:{type:"daterange","range-separator":"至","start-placeholder":"创建开始日期","end-placeholder":"创建结束日期",size:"small"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"省市区",prop:"area"}},[t("el-cascader",{staticClass:"filter-item",staticStyle:{width:"100%"},attrs:{options:e.areaOptions,props:{checkStrictly:!0,value:"value",label:"label",children:"children"},placeholder:"请选择省份/市州/区县",clearable:"",size:"small"},on:{change:e.handleAreaChange},model:{value:e.queryParams.area,callback:function(t){e.$set(e.queryParams,"area",t)},expression:"queryParams.area"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"产业园区",prop:"industrialPark"}},[t("el-select",{staticClass:"filter-item",attrs:{placeholder:"产业园区",clearable:"",size:"small"},model:{value:e.queryParams.industrialPark,callback:function(t){e.$set(e.queryParams,"industrialPark",t)},expression:"queryParams.industrialPark"}},e._l(e.industrialParkOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"创新指数",prop:"innovationIndex"}},[t("el-select",{staticClass:"filter-item",attrs:{placeholder:"创新指数",clearable:"",size:"small"},model:{value:e.queryParams.innovationIndex,callback:function(t){e.$set(e.queryParams,"innovationIndex",t)},expression:"queryParams.innovationIndex"}},e._l(e.innovationIndexOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"价格指数",prop:"priceIndex"}},[t("el-select",{staticClass:"filter-item",attrs:{placeholder:"价格指数",clearable:"",size:"small"},model:{value:e.queryParams.priceIndex,callback:function(t){e.$set(e.queryParams,"priceIndex",t)},expression:"queryParams.priceIndex"}},e._l(e.priceIndexOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1)]),t("div",{staticClass:"part-search-buttons"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("搜索")]),t("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)]),t("div",{staticClass:"body-part-content"},[t("div",{staticClass:"customer-tabs"},[t("el-tabs",{on:{"tab-click":e.handleTabClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"我的客户",name:"myCustomer"}}),t("el-tab-pane",{attrs:{label:"协作客户",name:"assistCustomer"}}),t("el-tab-pane",{attrs:{label:"助理客户",name:"assistantCustomer"}})],1)],1),t("div",{staticClass:"part-table-header"},[e._m(0),t("div",{staticClass:"part-table-operations"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleAdd}},[e._v("新增")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleImport}},[e._v("导入")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleExport}},[e._v("导出")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleAddBusinessPerson}},[e._v("添加业务员")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleTransferBusinessPerson}},[e._v("转业务员")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleSetSort}},[e._v("设置排序")])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"customerTable",attrs:{data:e.customerList,border:"","row-key":"id",size:"small"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"80",align:"center"}}),t("el-table-column",{attrs:{label:"序号",align:"center",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index+1)+" ")]}}])}),e.visibleColumns.name?t("el-table-column",{attrs:{label:"客户名称",align:"center",prop:"name","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("router-link",{staticClass:"customer-link",attrs:{to:"/customer/detail/"+s.row.id}},[e._v(" "+e._s(s.row.name)+" ")])]}}],null,!1,1942673001)}):e._e(),e.visibleColumns.contractCount?t("el-table-column",{attrs:{label:"合同数量",align:"center",prop:"contractCount",width:"90"}}):e._e(),e.visibleColumns.creditCode?t("el-table-column",{attrs:{label:"信用代码",align:"center",prop:"creditCode","min-width":"180"}}):e._e(),e.visibleColumns.level?t("el-table-column",{attrs:{label:"客户等级",align:"center",prop:"level",width:"90"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tag",{attrs:{type:e.getLevelTagType(s.row.level)}},[e._v(e._s(e.getLevelLabel(s.row.level)))])]}}],null,!1,3199978948)}):e._e(),e.visibleColumns.customerScale?t("el-table-column",{attrs:{label:"客户规模",align:"center",prop:"customerScale",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getCustomerScaleLabel(t.row.customerScale))+" ")]}}],null,!1,1499109324)}):e._e(),e.visibleColumns.latestContractDate?t("el-table-column",{attrs:{label:"最新合同日期",align:"center",prop:"latestContractDate","min-width":"120"}}):e._e(),e.visibleColumns.businessPerson?t("el-table-column",{attrs:{label:"业务人员",align:"center","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.businessPerson?t("div",e._l(e.getBusinessPersonList(s.row.businessPerson),(function(s,a){return t("el-tag",{key:a,staticStyle:{"margin-right":"4px","margin-bottom":"2px"},attrs:{size:"mini",type:"primary"}},[e._v(" "+e._s(s)+" ")])})),1):t("span",{staticStyle:{color:"#909399"}},[e._v("未分配")])]}}],null,!1,2339859466)}):e._e(),e.visibleColumns.businessAssistant?t("el-table-column",{attrs:{label:"业务助理",align:"center",prop:"businessAssistant","min-width":"100"}}):e._e(),e.visibleColumns.businessPartner?t("el-table-column",{attrs:{label:"业务协作人",align:"center",prop:"businessPartner","min-width":"100"}}):e._e(),e.visibleColumns.companyManager?t("el-table-column",{attrs:{label:"公司负责人",align:"center",prop:"companyManager","min-width":"100"}}):e._e(),e.visibleColumns.creator?t("el-table-column",{attrs:{label:"创建人",align:"center",prop:"creator","min-width":"100"}}):e._e(),e.visibleColumns.createTime?t("el-table-column",{attrs:{label:"创建日期",align:"center",prop:"createTime","min-width":"120"}}):e._e(),e.visibleColumns.province?t("el-table-column",{attrs:{label:"省",align:"center",prop:"province","min-width":"80"}}):e._e(),e.visibleColumns.city?t("el-table-column",{attrs:{label:"市",align:"center",prop:"city","min-width":"80"}}):e._e(),e.visibleColumns.district?t("el-table-column",{attrs:{label:"区",align:"center",prop:"district","min-width":"80"}}):e._e(),e.visibleColumns.caseCount?t("el-table-column",{attrs:{label:"委案数量",align:"center",prop:"caseCount",width:"90"}}):e._e(),e.visibleColumns.customerNo?t("el-table-column",{attrs:{label:"客户编号",align:"center",prop:"customerNo","min-width":"100"}}):e._e(),e.visibleColumns.customerCode?t("el-table-column",{attrs:{label:"客户代码",align:"center",prop:"customerCode","min-width":"100"}}):e._e(),e.visibleColumns.processStaff?t("el-table-column",{attrs:{label:"流程人员",align:"center",prop:"processStaff","min-width":"100"}}):e._e(),e.visibleColumns.updater?t("el-table-column",{attrs:{label:"更新人",align:"center",prop:"updater","min-width":"100"}}):e._e(),e.visibleColumns.updateTime?t("el-table-column",{attrs:{label:"更新日期",align:"center",prop:"updateTime","min-width":"120"}}):e._e(),e.visibleColumns.remark?t("el-table-column",{attrs:{label:"客户资料备注",align:"center",prop:"remark"}}):e._e(),e.visibleColumns.industrialPark?t("el-table-column",{attrs:{label:"产业园区",align:"center",prop:"industrialPark","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getIndustrialParkLabel(t.row.industrialPark))+" ")]}}],null,!1,3060115468)}):e._e(),e.visibleColumns.economicCategory?t("el-table-column",{attrs:{label:"国民经济行业分类",align:"center",prop:"economicCategory"}}):e._e(),e.visibleColumns.economicDoor?t("el-table-column",{attrs:{label:"国民经济行业分类门类",align:"center",prop:"economicDoor","min-width":"180"}}):e._e(),e.visibleColumns.economicBigClass?t("el-table-column",{attrs:{label:"国民经济行业分类大类",align:"center",prop:"economicBigClass","min-width":"180"}}):e._e(),e.visibleColumns.economicMidClass?t("el-table-column",{attrs:{label:"国民经济行业分类中类",align:"center",prop:"economicMidClass","min-width":"180"}}):e._e(),e.visibleColumns.economicSmallClass?t("el-table-column",{attrs:{label:"国民经济行业分类小类",align:"center",prop:"economicSmallClass","min-width":"180"}}):e._e(),e.visibleColumns.sales2021?t("el-table-column",{attrs:{label:"2021年度销售额",align:"center",prop:"sales2021","min-width":"130"}}):e._e(),e.visibleColumns.researchFee2021?t("el-table-column",{attrs:{label:"2021年研发费用",align:"center",prop:"researchFee2021","min-width":"130"}}):e._e(),e.visibleColumns.loan2021?t("el-table-column",{attrs:{label:"2021贷款",align:"center",prop:"loan2021","min-width":"100"}}):e._e(),e.visibleColumns.highTechEnterprise?t("el-table-column",{attrs:{label:"高企",align:"center",prop:"highTechEnterprise",width:"80"},scopedSlots:e._u([{key:"default",fn:function(s){return["1"===s.row.highTechEnterprise?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"info"}},[e._v("否")])]}}],null,!1,1179149269)}):e._e(),e.visibleColumns.provinceEnterprise?t("el-table-column",{attrs:{label:"省企",align:"center",prop:"provinceEnterprise",width:"80"},scopedSlots:e._u([{key:"default",fn:function(s){return["1"===s.row.provinceEnterprise?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"info"}},[e._v("否")])]}}],null,!1,1977116251)}):e._e(),e.visibleColumns.cityEnterprise?t("el-table-column",{attrs:{label:"市企",align:"center",prop:"cityEnterprise",width:"80"},scopedSlots:e._u([{key:"default",fn:function(s){return["1"===s.row.cityEnterprise?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"info"}},[e._v("否")])]}}],null,!1,3598953094)}):e._e(),e.visibleColumns.provinceTechCenter?t("el-table-column",{attrs:{label:"省级工程技术中心",align:"center",prop:"provinceTechCenter","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(s){return["1"===s.row.provinceTechCenter?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"info"}},[e._v("否")])]}}],null,!1,1557432927)}):e._e(),e.visibleColumns.ipStandard?t("el-table-column",{attrs:{label:"知识产权贯标",align:"center",prop:"ipStandard","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(s){return["1"===s.row.ipStandard?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"info"}},[e._v("否")])]}}],null,!1,3515987606)}):e._e(),e.visibleColumns.itStandard?t("el-table-column",{attrs:{label:"两化融合贯标",align:"center",prop:"itStandard","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(s){return["1"===s.row.itStandard?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"info"}},[e._v("否")])]}}],null,!1,2701820562)}):e._e(),e.visibleColumns.innovationIndex?t("el-table-column",{attrs:{label:"创新指数",align:"center",prop:"innovationIndex","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getInnovationIndexLabel(t.row.innovationIndex))+" ")]}}],null,!1,2479827436)}):e._e(),e.visibleColumns.priceIndex?t("el-table-column",{attrs:{label:"价值指数",align:"center",prop:"priceIndex","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getPriceIndexLabel(t.row.priceIndex))+" ")]}}],null,!1,2650994124)}):e._e(),t("el-table-column",{attrs:{label:"操作",align:"center",width:"120","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handleView(s.row)}}},[e._v("查看")])]}}])})],1),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100]},on:{"update:currentPage":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:current-page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:pageSize":function(t){return e.$set(e.queryParams,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParams,"pageSize",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.upload.title,visible:e.upload.open,width:"400px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.upload,"open",t)}}},[t("el-upload",{ref:"upload",attrs:{limit:1,accept:".xlsx, .xls",headers:e.upload.headers,action:e.upload.url,"before-upload":e.handleBeforeUpload,"on-progress":e.handleFileUploadProgress,"on-success":e.handleFileSuccess,"auto-upload":!1,drag:""}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip text-center",attrs:{slot:"tip"},slot:"tip"},[t("span",[e._v("仅允许导入xls、xlsx格式文件。")]),t("el-link",{staticStyle:{"font-size":"12px","vertical-align":"baseline"},attrs:{type:"primary",underline:!1},on:{click:e.downloadTemplate}},[e._v("下载模板")])],1)]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitFileForm}},[e._v("确 定")]),t("el-button",{on:{click:function(t){e.upload.open=!1}}},[e._v("取 消")])],1)],1),t("el-dialog",{attrs:{title:"客户全量信息",visible:e.infoOpen,width:"800px","append-to-body":""},on:{"update:visible":function(t){e.infoOpen=t}}},[e.currentCustomer?t("div",[t("el-descriptions",{attrs:{title:"基本信息",column:3,border:""}},[t("el-descriptions-item",{attrs:{label:"客户名称"}},[e._v(e._s(e.currentCustomer.name))]),t("el-descriptions-item",{attrs:{label:"联系人"}},[e._v(e._s(e.currentCustomer.contactName))]),t("el-descriptions-item",{attrs:{label:"联系电话"}},[e._v(e._s(e.currentCustomer.contactPhone))]),t("el-descriptions-item",{attrs:{label:"邮箱"}},[e._v(e._s(e.currentCustomer.email||"无"))]),t("el-descriptions-item",{attrs:{label:"所属行业"}},[e._v(e._s(e.getIndustryLabel(e.currentCustomer.industry)))]),t("el-descriptions-item",{attrs:{label:"客户等级"}},[e._v(e._s(e.getLevelLabel(e.currentCustomer.level)))]),t("el-descriptions-item",{attrs:{label:"客户状态"}},[e._v(e._s(e.getStatusLabel(e.currentCustomer.status)))]),t("el-descriptions-item",{attrs:{label:"负责人"}},[e._v(e._s(e.currentCustomer.owner))]),t("el-descriptions-item",{attrs:{label:"客户来源"}},[e._v(e._s(e.getSourceLabel(e.currentCustomer.source)))]),t("el-descriptions-item",{attrs:{label:"创建时间",span:2}},[e._v(e._s(e.currentCustomer.createTime))]),t("el-descriptions-item",{attrs:{label:"最近跟进"}},[e._v(e._s(e.currentCustomer.lastFollowTime||"无"))])],1),t("el-divider",{attrs:{"content-position":"left"}},[e._v("地址信息")]),t("div",{staticClass:"info-section"},[t("p",[e._v("地址："+e._s(e.currentCustomer.address||"无"))])]),t("el-divider",{attrs:{"content-position":"left"}},[e._v("标签信息")]),t("div",{staticClass:"info-section"},[e.currentCustomer.tags&&e.currentCustomer.tags.length>0?t("div",e._l(e.currentCustomer.tags,(function(s){return t("el-tag",{key:s.id,staticStyle:{"margin-right":"8px","margin-bottom":"8px"},attrs:{type:s.type,size:"medium",effect:"plain"}},[e._v(" "+e._s(s.name)+" ")])})),1):t("div",[e._v("暂无标签")])]),t("el-divider",{attrs:{"content-position":"left"}},[e._v("备注信息")]),t("div",{staticClass:"info-section"},[t("p",[e._v(e._s(e.currentCustomer.remark||"暂无备注"))])])],1):t("div",{staticClass:"no-data"},[e._v(" 暂无数据 ")]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.infoOpen=!1}}},[e._v("关 闭")])],1)]),t("el-dialog",{attrs:{title:"转入公海",visible:e.transferToPublicDialog.open,width:"500px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.transferToPublicDialog,"open",t)}}},[t("div",{staticStyle:{"margin-bottom":"20px"}},[t("p",{staticStyle:{color:"#606266","margin-bottom":"10px"}},[e._v(" 将选中的 "),t("strong",[e._v(e._s(e.ids.length))]),e._v(" 条客户记录转入公海，请选择目标公海： ")])]),t("el-form",{attrs:{"label-width":"80px"}},[t("el-form-item",{attrs:{label:"目标公海",required:""}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择要转入的公海"},model:{value:e.transferToPublicDialog.selectedPool,callback:function(t){e.$set(e.transferToPublicDialog,"selectedPool",t)},expression:"transferToPublicDialog.selectedPool"}},e._l(e.publicPoolOptions,(function(s){return t("el-option",{key:s.value,attrs:{label:s.label,value:s.value}},[t("div",[t("div",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(s.label))]),t("div",{staticStyle:{"font-size":"12px",color:"#999"}},[e._v(e._s(s.description))])])])})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelTransferToPublic}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",loading:e.transferToPublicDialog.loading},on:{click:e.confirmTransferToPublic}},[e._v(" 确认转入 ")])],1)],1),t("ExportDialog",{attrs:{visible:e.exportDialog.open,"available-fields":e.availableColumns,"default-fields":e.defaultSelectedColumns,"total-count":e.total,"current-page-count":e.customerList.length,"selected-count":e.ids.length},on:{"update:visible":function(t){return e.$set(e.exportDialog,"open",t)},export:e.handleExportConfirm}}),t("el-dialog",{attrs:{title:"转业务员",visible:e.transferBusinessDialog.open,width:"800px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.transferBusinessDialog,"open",t)}}},[t("div",{staticClass:"business-dialog-content"},[t("div",{staticClass:"current-business-section"},[t("h4",[e._v("现有业务员")]),t("div",{staticClass:"current-business-list"},[e._l(e.currentBusinessPersons,(function(s){return t("el-tag",{key:s.id,staticStyle:{"margin-right":"8px","margin-bottom":"8px"},attrs:{type:"info",size:"medium"}},[e._v(" "+e._s(s.name)+" ("+e._s(s.role)+") ")])})),0===e.currentBusinessPersons.length?t("div",{staticClass:"empty-tip"},[e._v(" 暂无业务员 ")]):e._e()],2)]),t("div",{staticClass:"select-business-section"},[t("h4",[e._v("选择新业务员")]),t("div",{staticClass:"search-input"},[t("el-input",{attrs:{placeholder:"搜索人员姓名","prefix-icon":"el-icon-search",size:"small",clearable:""},model:{value:e.businessTreeFilter,callback:function(t){e.businessTreeFilter=t},expression:"businessTreeFilter"}})],1),t("div",{staticClass:"tree-wrapper"},[t("el-tree",{ref:"transferBusinessTree",staticClass:"business-tree",attrs:{data:e.organizationTree,"filter-node-method":e.filterBusinessNode,"expand-on-click-node":!1,"show-checkbox":"","node-key":"id","default-checked-keys":e.transferBusinessDialog.selectedPersons},on:{check:e.handleTransferBusinessCheck},scopedSlots:e._u([{key:"default",fn:function({node:s,data:a}){return t("span",{staticClass:"tree-node"},[t("i",{class:"dept"===a.type?"el-icon-folder-opened":"el-icon-user",staticStyle:{"margin-right":"5px"}}),t("span",[e._v(e._s(s.label))]),"dept"===a.type&&a.count?t("span",{staticClass:"dept-count"},[e._v("("+e._s(a.count)+"人)")]):e._e()])}}])})],1)]),t("div",{staticClass:"sync-options-section"},[t("h4",[e._v("同步选项")]),t("div",{staticClass:"sync-checkboxes"},[t("el-checkbox",{model:{value:e.transferBusinessDialog.syncCaseBusiness,callback:function(t){e.$set(e.transferBusinessDialog,"syncCaseBusiness",t)},expression:"transferBusinessDialog.syncCaseBusiness"}},[e._v("同步修改项目业务员")]),t("el-checkbox",{model:{value:e.transferBusinessDialog.syncContractBusiness,callback:function(t){e.$set(e.transferBusinessDialog,"syncContractBusiness",t)},expression:"transferBusinessDialog.syncContractBusiness"}},[e._v("同步修改合同业务员")])],1)])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelTransferBusiness}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.transferBusinessDialog.loading},on:{click:e.confirmTransferBusiness}},[e._v("确定")])],1)]),t("el-dialog",{attrs:{title:"添加业务员",visible:e.addBusinessDialog.open,width:"800px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.addBusinessDialog,"open",t)}}},[t("div",{staticClass:"business-dialog-content"},[t("div",{staticClass:"current-business-section"},[t("h4",[e._v("现有业务员")]),t("div",{staticClass:"current-business-list"},[e._l(e.currentBusinessPersons,(function(s){return t("el-tag",{key:s.id,staticStyle:{"margin-right":"8px","margin-bottom":"8px"},attrs:{type:"info",size:"medium"}},[e._v(" "+e._s(s.name)+" ("+e._s(s.role)+") ")])})),0===e.currentBusinessPersons.length?t("div",{staticClass:"empty-tip"},[e._v(" 暂无业务员 ")]):e._e()],2)]),t("div",{staticClass:"select-business-section"},[t("h4",[e._v("选择新业务员")]),t("div",{staticClass:"search-input"},[t("el-input",{attrs:{placeholder:"搜索人员姓名","prefix-icon":"el-icon-search",size:"small",clearable:""},model:{value:e.businessTreeFilter,callback:function(t){e.businessTreeFilter=t},expression:"businessTreeFilter"}})],1),t("div",{staticClass:"tree-wrapper"},[t("el-tree",{ref:"addBusinessTree",staticClass:"business-tree",attrs:{data:e.organizationTree,"filter-node-method":e.filterBusinessNode,"expand-on-click-node":!1,"show-checkbox":"","node-key":"id","default-checked-keys":e.addBusinessDialog.selectedPersons},on:{check:e.handleAddBusinessCheck},scopedSlots:e._u([{key:"default",fn:function({node:s,data:a}){return t("span",{staticClass:"tree-node"},[t("i",{class:"dept"===a.type?"el-icon-folder-opened":"el-icon-user",staticStyle:{"margin-right":"5px"}}),t("span",[e._v(e._s(s.label))]),"dept"===a.type&&a.count?t("span",{staticClass:"dept-count"},[e._v("("+e._s(a.count)+"人)")]):e._e()])}}])})],1)]),t("div",{staticClass:"sync-options-section"},[t("h4",[e._v("同步选项")]),t("div",{staticClass:"sync-checkboxes"},[t("el-checkbox",{model:{value:e.addBusinessDialog.syncCaseBusiness,callback:function(t){e.$set(e.addBusinessDialog,"syncCaseBusiness",t)},expression:"addBusinessDialog.syncCaseBusiness"}},[e._v("同步修改项目业务员")]),t("el-checkbox",{model:{value:e.addBusinessDialog.syncContractBusiness,callback:function(t){e.$set(e.addBusinessDialog,"syncContractBusiness",t)},expression:"addBusinessDialog.syncContractBusiness"}},[e._v("同步修改合同业务员")])],1)])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelAddBusiness}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.addBusinessDialog.loading},on:{click:e.confirmAddBusiness}},[e._v("确定")])],1)]),t("el-dialog",{attrs:{title:"设置排序",visible:e.sortDialog.open,width:"800px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.sortDialog,"open",t)}}},[t("div",{staticClass:"sort-dialog-content"},[t("div",{staticClass:"sort-instructions"},[t("p",[e._v("为选中的客户设置排序序号，序号越小排序越靠前。如果序号相同，后设置的会自动后移。")])]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.sortDialog.customers,border:""}},[t("el-table-column",{attrs:{prop:"customer_name",label:"客户名称",width:"200"}}),t("el-table-column",{attrs:{prop:"credit_code",label:"信用代码",width:"150"}}),t("el-table-column",{attrs:{prop:"current_sort",label:"当前序号",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.current_sort||"-")+" ")]}}])}),t("el-table-column",{attrs:{label:"新序号",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-input-number",{staticStyle:{width:"100px"},attrs:{min:1,max:9999,size:"small"},model:{value:s.row.new_sort,callback:function(t){e.$set(s.row,"new_sort",t)},expression:"scope.row.new_sort"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.clearSort(s.row)}}},[e._v("清除")])]}}])})],1),t("div",{staticClass:"sort-actions",staticStyle:{"margin-top":"20px"}},[t("el-button",{attrs:{size:"small"},on:{click:e.batchSetSort}},[e._v("批量设置")]),t("el-input-number",{staticStyle:{width:"100px","margin-left":"10px"},attrs:{min:1,max:9999,size:"small",placeholder:"起始序号"},model:{value:e.batchSortStart,callback:function(t){e.batchSortStart=t},expression:"batchSortStart"}}),t("span",{staticStyle:{"margin-left":"10px",color:"#666"}},[e._v("从起始序号开始，依次递增设置")])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelSort}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.sortDialog.loading},on:{click:e.confirmSort}},[e._v("确定")])],1)])],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"part-table-title"},[t("span",[e._v("客户列表")])])}],r=(s("14d9"),s("e9f5"),s("910d"),s("f665"),s("7d54"),s("ab43"),s("1e70"),s("79a4"),s("c1a1"),s("8b00"),s("a4e7"),s("1e5a"),s("72c3"),s("88a7"),s("271a"),s("5494"),s("857b")),n=s("f6b0"),l={name:"MyCustomer",components:{ExportDialog:r["a"]},beforeRouteEnter(e,t,s){s(e=>{e.refreshComponent()})},data(){return{componentKey:0,activeTab:"myCustomer",loading:!1,ids:[],single:!0,multiple:!0,total:0,customerList:[],infoOpen:!1,dateRange:[],contractDateRange:[],updateDateRange:[],expandSearchVisible:!1,currentCustomer:null,availableColumns:[{prop:"name",label:"客户名称"},{prop:"contractCount",label:"合同数量"},{prop:"creditCode",label:"信用代码"},{prop:"level",label:"客户等级"},{prop:"latestContractDate",label:"最新合同日期"},{prop:"businessPerson",label:"业务人员"},{prop:"businessAssistant",label:"业务助理"},{prop:"businessPartner",label:"业务协作人"},{prop:"companyManager",label:"公司负责人"},{prop:"creator",label:"创建人"},{prop:"createTime",label:"创建日期"},{prop:"province",label:"省"},{prop:"city",label:"市"},{prop:"district",label:"区"},{prop:"caseCount",label:"委案数量"},{prop:"customerNo",label:"客户编号"},{prop:"customerCode",label:"客户代码"},{prop:"processStaff",label:"流程人员"},{prop:"updater",label:"更新人"},{prop:"updateTime",label:"更新日期"},{prop:"remark",label:"客户资料备注"},{prop:"industrialPark",label:"产业园区"},{prop:"economicCategory",label:"国民经济行业分类"},{prop:"economicDoor",label:"国民经济行业分类门类"},{prop:"economicBigClass",label:"国民经济行业分类大类"},{prop:"economicMidClass",label:"国民经济行业分类中类"},{prop:"economicSmallClass",label:"国民经济行业分类小类"},{prop:"sales2021",label:"2021年度销售额"},{prop:"researchFee2021",label:"2021年研发费用"},{prop:"loan2021",label:"2021贷款"},{prop:"highTechEnterprise",label:"高企"},{prop:"provinceEnterprise",label:"省企"},{prop:"cityEnterprise",label:"市企"},{prop:"provinceTechCenter",label:"省级工程技术中心"},{prop:"ipStandard",label:"知识产权贯标"},{prop:"itStandard",label:"两化融合贯标"},{prop:"innovationIndex",label:"创新指数"},{prop:"priceIndex",label:"价值指数"}],defaultSelectedColumns:["name","contractCount","creditCode","level","customerScale","latestContractDate","businessPerson"],visibleColumns:{name:!0,contractCount:!0,creditCode:!0,level:!0,customerScale:!0,latestContractDate:!0,businessPerson:!0,businessAssistant:!1,businessPartner:!1,companyManager:!1,creator:!1,createTime:!1,province:!1,city:!1,district:!1,caseCount:!1,customerNo:!1,customerCode:!1,processStaff:!1,updater:!1,updateTime:!1,remark:!1,industrialPark:!1,economicCategory:!1,economicDoor:!1,economicBigClass:!1,economicMidClass:!1,economicSmallClass:!1,sales2021:!1,researchFee2021:!1,loan2021:!1,highTechEnterprise:!1,provinceEnterprise:!1,cityEnterprise:!1,provinceTechCenter:!1,ipStandard:!1,itStandard:!1,innovationIndex:!1,priceIndex:!1},queryParams:{pageNum:1,pageSize:10,name:void 0,creditCode:void 0,level:void 0,customerScale:void 0,contractCount:void 0,contractCount1:void 0,contractCount2:void 0,latestContractDate:void 0,businessPerson:void 0,businessAssistant:void 0,businessPartner:void 0,companyManager:void 0,creator:void 0,area:[],province:void 0,city:void 0,district:void 0,caseCount:void 0,customerNo:void 0,customerCode:void 0,processStaff:void 0,updater:void 0,remark:void 0,industrialPark:void 0,economicCategory:void 0,economicDoor:void 0,economicBigClass:void 0,economicMidClass:void 0,economicSmallClass:void 0,sales2021:void 0,researchFee2021:void 0,loan2021:void 0,highTechEnterprise:void 0,provinceEnterprise:void 0,cityEnterprise:void 0,provinceTechCenter:void 0,ipStandard:void 0,itStandard:void 0,innovationIndex:void 0,priceIndex:void 0},industryOptions:[{value:"IT",label:"信息技术"},{value:"金融",label:"金融行业"},{value:"教育",label:"教育行业"},{value:"医疗",label:"医疗行业"},{value:"制造",label:"制造业"},{value:"零售",label:"零售业"},{value:"其他",label:"其他行业"}],levelOptions:[{value:"A",label:"A级",type:"danger"},{value:"B",label:"B级",type:"warning"},{value:"C",label:"C级",type:"success"},{value:"D",label:"D级",type:"info"}],statusOptions:[{value:"0",label:"潜在客户",type:"info"},{value:"1",label:"意向客户",type:"warning"},{value:"2",label:"成交客户",type:"success"},{value:"3",label:"失效客户",type:"danger"}],sourceOptions:[{value:"0",label:"网络推广"},{value:"1",label:"电话营销"},{value:"2",label:"老客户推荐"},{value:"3",label:"合作伙伴"},{value:"4",label:"社交媒体"},{value:"5",label:"其他来源"}],userOptions:[],customerScaleOptions:[],industrialParkOptions:[],innovationIndexOptions:[],priceIndexOptions:[],areaOptions:[],economicCategoryOptions:[{value:"A",label:"A 农、林、牧、渔业"},{value:"B",label:"B 采矿业"},{value:"C",label:"C 制造业"},{value:"D",label:"D 电力、热力、燃气及水生产和供应业"}],economicDoorOptions:[{value:"A",label:"A 农、林、牧、渔业"},{value:"B",label:"B 采矿业"},{value:"C",label:"C 制造业"},{value:"D",label:"D 电力、热力、燃气及水生产和供应业"}],economicBigClassOptions:[{value:"C1",label:"C1 食品制造业"},{value:"C2",label:"C2 纺织业"},{value:"C3",label:"C3 造纸和纸制品业"},{value:"C4",label:"C4 化学原料和化学制品制造业"}],economicMidClassOptions:[{value:"C13",label:"C13 农副食品加工业"},{value:"C14",label:"C14 食品制造业"},{value:"C15",label:"C15 酒、饮料和精制茶制造业"},{value:"C16",label:"C16 烟草制品业"}],economicSmallClassOptions:[{value:"C131",label:"C131 谷物磨制"},{value:"C132",label:"C132 饲料加工"},{value:"C133",label:"C133 植物油加工"},{value:"C134",label:"C134 制糖业"}],upload:{open:!1,title:"导入客户数据",url:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_API+"/customer/importData",headers:{Authorization:"Bearer "+this.$store.getters.token},isUploading:!1},exportDialog:{open:!1},sortDialog:{open:!1,loading:!1,customers:[]},batchSortStart:1,transferToPublicDialog:{open:!1,selectedPool:void 0,loading:!1},transferBusinessDialog:{open:!1,selectedPersons:[],syncCaseBusiness:!1,syncContractBusiness:!1,loading:!1},addBusinessDialog:{open:!1,selectedPersons:[],syncCaseBusiness:!1,syncContractBusiness:!1,loading:!1},currentBusinessPersons:[],businessTreeFilter:"",organizationTree:[{id:1,label:"部门1",type:"dept",children:[{id:11,label:"张某",type:"user",parentId:1},{id:12,label:"李某",type:"user",parentId:1}]},{id:2,label:"部门2",type:"dept",children:[{id:21,label:"王某",type:"user",parentId:2},{id:22,label:"赵某",type:"user",parentId:2}]},{id:3,label:"部门3",type:"dept",children:[{id:31,label:"刘某",type:"user",parentId:3}]},{id:4,label:"部门4",type:"dept",children:[{id:41,label:"陈某",type:"user",parentId:4},{id:42,label:"周某",type:"user",parentId:4}]}],publicPoolOptions:[{value:"pool_general",label:"通用公海",description:"适用于一般性客户资源"},{value:"pool_high_value",label:"高价值公海",description:"适用于高价值潜在客户"},{value:"pool_enterprise",label:"企业公海",description:"适用于企业级客户"},{value:"pool_regional",label:"区域公海",description:"按区域划分的客户资源"},{value:"pool_industry",label:"行业公海",description:"按行业划分的客户资源"}],hasCustomSort:!1}},computed:{currentRoute(){return this.$route.path+"?t="+Date.now()}},watch:{currentRoute:{handler(){this.refreshComponent(),this.getList()},immediate:!0},$route:{handler(){this.refreshComponent()},immediate:!0,deep:!0},businessTreeFilter(e){this.$refs.businessTree&&this.$refs.businessTree.filter(e),this.$refs.addBusinessTree&&this.$refs.addBusinessTree.filter(e)}},created(){this.refreshComponent(),Promise.all([this.getList(),this.getUserOptions(),this.getConfigData(),this.getOrganizationTree(),this.loadAreaData()]).catch(e=>{console.error("初始化数据加载失败:",e)}),this.$router&&this.$router.options&&(this.$router.options.scrollBehavior=()=>({y:0}))},mounted(){window.addEventListener("popstate",this.handlePopState),window.addEventListener("resize",this.refreshComponent),this.setupMutationObserver(),setTimeout(()=>{this.refreshComponent()},500)},activated(){this.refreshComponent(),this.getList();const e=document.title;document.title="客户列表",setTimeout(()=>{document.title=e},100)},beforeDestroy(){window.removeEventListener("popstate",this.handlePopState),window.removeEventListener("resize",this.refreshComponent),this.observer&&this.observer.disconnect()},methods:{handleTabClick(){this.queryParams.pageNum=1,this.getList()},setupMutationObserver(){const e={attributes:!0,childList:!0,subtree:!0};this.observer=new MutationObserver(e=>{this.$nextTick(()=>{this.$forceUpdate()})}),this.$nextTick(()=>{this.$el&&this.observer.observe(this.$el,e)})},refreshComponent(){this.componentKey=Date.now(),this.$nextTick(()=>{this.$forceUpdate()})},handlePopState(){this.refreshComponent(),this.getList()},async getList(){this.loading=!0;try{const e={page:this.queryParams.pageNum,per_page:this.queryParams.pageSize,name:this.queryParams.name,credit_code:this.queryParams.creditCode,level:this.queryParams.level,customer_scale:this.queryParams.customerScale,industry:this.queryParams.industry,source:this.queryParams.source,status:this.queryParams.status,business_assistant:this.queryParams.businessAssistant,business_partner:this.queryParams.businessPartner,company_manager:this.queryParams.companyManager,creator:this.queryParams.creator,province:this.queryParams.province,city:this.queryParams.city,district:this.queryParams.district,customer_no:this.queryParams.customerNo,customer_code:this.queryParams.customerCode,process_staff:this.queryParams.processStaff,remark:this.queryParams.remark,industrial_park:this.queryParams.industrialPark,park_id:this.queryParams.industrialPark,economic_category:this.queryParams.economicCategory,economic_door:this.queryParams.economicDoor,economic_big_class:this.queryParams.economicBigClass,economic_mid_class:this.queryParams.economicMidClass,economic_small_class:this.queryParams.economicSmallClass,sales_2021:this.queryParams.sales2021,research_fee_2021:this.queryParams.researchFee2021,loan_2021:this.queryParams.loan2021,high_tech_enterprise:this.queryParams.highTechEnterprise,province_enterprise:this.queryParams.provinceEnterprise,city_enterprise:this.queryParams.cityEnterprise,province_tech_center:this.queryParams.provinceTechCenter,ip_standard:this.queryParams.ipStandard,it_standard:this.queryParams.itStandard,innovation_index:this.queryParams.innovationIndex,price_index:this.queryParams.priceIndex,my_customers_only:!0,tab_type:this.activeTab};this.queryParams.contractCount1&&(e.contract_count1=this.queryParams.contractCount1),this.queryParams.contractCount2&&(e.contract_count2=this.queryParams.contractCount2),this.contractDateRange&&2===this.contractDateRange.length&&(e.latest_contract_date_start=this.contractDateRange[0],e.latest_contract_date_end=this.contractDateRange[1]),this.dateRange&&2===this.dateRange.length&&(e.create_date_start=this.dateRange[0],e.create_date_end=this.dateRange[1]),Object.keys(e).forEach(t=>{""!==e[t]&&void 0!==e[t]&&null!==e[t]||delete e[t]});const t=await n["a"].getList(e),s=t&&t.data&&t.data.data?t.data.data:{list:[],total:0};t&&t.data?(this.customerList=s.list||[],this.total=s.total||0):(this.customerList=[],this.total=0),this.loading=!1,this.$nextTick(()=>{this.$forceUpdate()})}catch(e){console.error("获取客户列表失败:",e),this.$message.error("获取客户列表失败，请重试"),this.customerList=[],this.total=0,this.loading=!1}},handleSizeChange(e){this.queryParams.pageSize=e,this.getList()},handleCurrentChange(e){this.queryParams.pageNum=e,this.getList()},getRandomDate(e=!1){const t=new Date,s=t.getFullYear(),a=t.getMonth(),i=t.getDate(),r=e?Math.floor(12*Math.random())+1:Math.floor(2*Math.random()),n=Math.floor(28*Math.random())+1,l=new Date(s,a-r,i-n);return l.getFullYear()+"-"+String(l.getMonth()+1).padStart(2,"0")+"-"+String(l.getDate()).padStart(2,"0")+" "+String(l.getHours()).padStart(2,"0")+":"+String(l.getMinutes()).padStart(2,"0")},getRandomTags(){const e=["","success","info","warning","danger"],t=["重点客户","新客户","合作伙伴","战略客户","普通客户","流失风险","长期合作"],s=Math.floor(3*Math.random()),a=[];for(let i=0;i<s;i++){const s=Math.floor(Math.random()*t.length),r=e[Math.floor(Math.random()*e.length)];a.push({id:i+1,name:t[s],type:r})}return a},async getUserOptions(){try{const e=await n["a"].getUserOptions();e.data&&e.data.success&&(this.userOptions=e.data.data)}catch(e){console.error("获取用户选项失败:",e),this.userOptions=[{userId:1,userName:"张三"},{userId:2,userName:"李四"},{userId:3,userName:"王五"},{userId:4,userName:"赵六"},{userId:5,userName:"公海"}]}},async getConfigData(){try{const e=await n["a"].getConfigData();if(e.data&&e.data.success){const t=e.data.data;console.log("获取到的配置数据:",t),t.levels&&t.levels.length>0&&(this.levelOptions=t.levels,console.log("客户等级选项:",this.levelOptions)),t.customerScales&&t.customerScales.length>0&&(this.customerScaleOptions=t.customerScales,console.log("客户规模选项:",this.customerScaleOptions)),this.industryOptions=t.industries||this.industryOptions,this.industrialParkOptions=t.industrialParks||this.industrialParkOptions,this.innovationIndexOptions=t.innovationIndices||this.innovationIndexOptions,this.priceIndexOptions=t.priceIndices||this.priceIndexOptions,this.provinceOptions=t.provinces||this.provinceOptions,this.cityOptions=t.cities||this.cityOptions,this.districtOptions=t.districts||this.districtOptions}}catch(e){console.error("获取配置数据失败:",e)}},async getCustomerScaleOptions(){try{const e=await n["a"].getCustomerScaleOptions();e.data&&0===e.data.code&&(this.customerScaleOptions=e.data.data||[])}catch(e){console.error("获取客户规模选项失败:",e),this.customerScaleOptions=[{value:"1",label:"大型企业"},{value:"2",label:"中型企业"},{value:"3",label:"小型企业"},{value:"4",label:"微型企业"},{value:"5",label:"央企"},{value:"6",label:"国企"}]}},async getOrganizationTree(){try{const e=await n["a"].getOrganizationTree();e.data&&e.data.success&&(this.organizationTree=e.data.data)}catch(e){console.error("获取组织架构失败:",e)}},async loadAreaData(){try{const e=await s.e("chunk-2d221462").then(s.t.bind(null,"ca3a",3));this.areaOptions=e.default||e,console.log("地区数据已加载，共",this.areaOptions.length,"个省份")}catch(e){console.error("加载地区数据失败:",e),this.areaOptions=[]}},handleAreaChange(e){e&&e.length>0?(this.queryParams.province=e[0]||void 0,this.queryParams.city=e[1]||void 0,this.queryParams.district=e[2]||void 0):(this.queryParams.province=void 0,this.queryParams.city=void 0,this.queryParams.district=void 0)},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.dateRange=[],this.contractDateRange=[],this.updateDateRange=[],this.queryParams={pageNum:1,pageSize:10,name:void 0,creditCode:void 0,level:void 0,customerScale:void 0,contractCount:void 0,contractCount1:void 0,contractCount2:void 0,latestContractDate:void 0,businessPerson:void 0,businessAssistant:void 0,businessPartner:void 0,companyManager:void 0,creator:void 0,province:void 0,city:void 0,district:void 0,caseCount:void 0,customerNo:void 0,customerCode:void 0,processStaff:void 0,updater:void 0,remark:void 0,industrialPark:void 0,economicCategory:void 0,economicDoor:void 0,economicBigClass:void 0,economicMidClass:void 0,economicSmallClass:void 0,sales2021:void 0,researchFee2021:void 0,loan2021:void 0,highTechEnterprise:void 0,provinceEnterprise:void 0,cityEnterprise:void 0,provinceTechCenter:void 0,ipStandard:void 0,itStandard:void 0,innovationIndex:void 0,priceIndex:void 0},this.handleQuery()},handleSelectionChange(e){this.ids=e.map(e=>e.id),this.single=1!==e.length,this.multiple=!e.length},handleAdd(){this.$router.push("/customer/add")},handleView(e){this.$router.push("/customer/detail/"+e.id)},handleInfo(e){this.currentCustomer=e,this.infoOpen=!0},handleFollowup(e){this.$router.push(`/customer/followup/${e.id}?name=${encodeURIComponent(e.name)}`)},handleExport(){this.exportDialog.open=!0},async handleExportConfirm(e){try{const t={...this.queryParams,fields:e.fields,filename:e.filename,format:e.format,scope:e.scope};"selected"===e.scope&&this.ids.length>0&&(t.ids=this.ids),this.dateRange&&2===this.dateRange.length&&(t.create_date_start=this.dateRange[0],t.create_date_end=this.dateRange[1]),this.contractDateRange&&2===this.contractDateRange.length&&(t.latest_contract_date_start=this.contractDateRange[0],t.latest_contract_date_end=this.contractDateRange[1]);const s=await n["a"].exportData(t),a=new Blob([s.data],{type:"xlsx"===e.format?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv"}),i=window.URL.createObjectURL(a),r=document.createElement("a");r.href=i,r.download=`${e.filename}.${e.format}`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i),this.$message.success("导出成功"),this.exportDialog.open=!1}catch(t){console.error("导出失败:",t),this.$message.error("导出失败，请重试")}},handleImport(){this.upload.open=!0},async downloadTemplate(){try{const e=await n["a"].downloadTemplate(),t=new Blob([e.data],{type:"application/csv"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`客户导入模板_${(new Date).toISOString().slice(0,10)}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(s),this.$message.success("模板下载成功")}catch(e){console.error("模板下载失败:",e),this.$message.error("模板下载失败，请重试")}},handleFileUploadProgress(){this.upload.isUploading=!0},handleFileSuccess(e,t,s){if(this.upload.open=!1,this.upload.isUploading=!1,this.$refs.upload.clearFiles(),e&&e.success){const t=e.data;let s=e.message||"导入成功";t&&t.error_count>0&&(s+=`，但有${t.error_count}条记录导入失败`),this.$message.success(s),this.getList()}else this.$message.error((null===e||void 0===e?void 0:e.message)||"导入失败")},async submitFileForm(){const e=this.$refs.upload.uploadFiles;if(e&&0!==e.length)try{this.upload.isUploading=!0;const t=new FormData;t.append("file",e[0].raw);const s=await n["a"].importData(t);this.handleFileSuccess(s.data,e[0],e)}catch(t){console.error("文件上传失败:",t),this.$message.error("导入失败，请重试"),this.upload.isUploading=!1}else this.$message.warning("请选择要上传的文件")},getLevelTagType(e){if(e){const t=this.levelOptions.find(t=>t.value===e);if(t&&t.type)return t.type}const t={1:"danger",2:"warning",3:"success",A:"danger",B:"warning",C:"success",D:"info"};return t[e]||"info"},getLevelLabel(e){if("string"===typeof e&&""!==e.trim())return e;if(e){const t=this.levelOptions.find(t=>t.value===e);if(t)return t.label}const t={1:"重要客户",2:"一般客户",3:"潜在客户",A:"A级",B:"B级",C:"C级",D:"D级"};return t[e]||e||""},getCustomerScaleLabel(e){if("string"===typeof e&&""!==e.trim())return e;if(e){const t=this.customerScaleOptions.find(t=>t.value===e);if(t)return t.label}const t={1:"大型企业",2:"中型企业",3:"小微企业",4:"初创企业",5:"央企",6:"国企"};return t[e]||e||""},getIndustrialParkLabel(e){const t=this.industrialParkOptions.find(t=>t.value===e);return t?t.label:e},getInnovationIndexLabel(e){const t=this.innovationIndexOptions.find(t=>t.value===e);return t?t.label:e},getPriceIndexLabel(e){const t=this.priceIndexOptions.find(t=>t.value===e);return t?t.label:e},getStatusTagType(e){const t={0:"info",1:"warning",2:"success",3:"danger"};return t[e]||""},getStatusLabel(e){const t={0:"潜在客户",1:"意向客户",2:"成交客户",3:"失效客户"};return t[e]||e},getIndustryLabel(e){const t=this.industryOptions.find(t=>t.value===e);return t?t.label:e},getSourceLabel(e){const t=this.sourceOptions.find(t=>t.value===e);return t?t.label:e},handleAddBusinessPerson(){0!==this.ids.length?(this.getCurrentBusinessPersons(),this.addBusinessDialog.open=!0,this.addBusinessDialog.selectedPersons=[],this.addBusinessDialog.syncCaseBusiness=!1,this.addBusinessDialog.syncContractBusiness=!1,this.businessTreeFilter=""):this.$message.warning("请至少选择一条记录")},handleTransferBusinessPerson(){0!==this.ids.length?(this.getCurrentBusinessPersons(),this.transferBusinessDialog.open=!0,this.transferBusinessDialog.selectedPersons=[],this.transferBusinessDialog.syncCaseBusiness=!1,this.transferBusinessDialog.syncContractBusiness=!1,this.businessTreeFilter=""):this.$message.warning("请至少选择一条记录")},async getCurrentBusinessPersons(){try{const e=await n["a"].getCustomerBusinessPersons({customer_ids:this.ids});if(e.data&&e.data.success)this.currentBusinessPersons=e.data.data||[];else{const e=this.customerList.filter(e=>this.ids.includes(e.id)),t=new Set;e.forEach(e=>{e.businessPerson&&t.add(e.businessPerson)}),this.currentBusinessPersons=Array.from(t).map((e,t)=>({id:t+1,name:e}))}}catch(e){console.error("获取业务员信息失败:",e);const t=this.customerList.filter(e=>this.ids.includes(e.id)),s=new Set;t.forEach(e=>{e.businessPerson&&s.add(e.businessPerson)}),this.currentBusinessPersons=Array.from(s).map((e,t)=>({id:t+1,name:e}))}},filterBusinessNode(e,t){return!e||-1!==t.label.indexOf(e)},handleTransferBusinessCheck(e,t){"dept"!==e.type?this.transferBusinessDialog.selectedPersons=t.checkedKeys.filter(e=>{const t=this.findNodeById(e);return t&&"user"===t.type}):this.$nextTick(()=>{this.$refs.transferBusinessTree.setChecked(e.id,!1)})},handleAddBusinessCheck(e,t){"dept"!==e.type?this.addBusinessDialog.selectedPersons=t.checkedKeys.filter(e=>{const t=this.findNodeById(e);return t&&"user"===t.type}):this.$nextTick(()=>{this.$refs.addBusinessTree.setChecked(e.id,!1)})},findNodeById(e){const t=(e,s)=>{for(const a of e){if(a.id===s)return a;if(a.children&&a.children.length>0){const e=t(a.children,s);if(e)return e}}return null};return t(this.organizationTree,e)},async confirmTransferBusiness(){if(0!==this.transferBusinessDialog.selectedPersons.length){this.transferBusinessDialog.loading=!0;try{const t=await n["a"].batchTransferBusiness({customer_ids:this.ids,selected_persons:this.transferBusinessDialog.selectedPersons,sync_case_business:this.transferBusinessDialog.syncCaseBusiness,sync_contract_business:this.transferBusinessDialog.syncContractBusiness});var e;if(t.data&&t.data.success)this.$message.success(t.data.message||"转业务员成功"),this.transferBusinessDialog.open=!1,this.getList();else this.$message.error((null===(e=t.data)||void 0===e?void 0:e.message)||"转业务员失败")}catch(t){console.error("转业务员失败:",t),this.$message.error("转业务员失败，请重试")}finally{this.transferBusinessDialog.loading=!1}}else this.$message.warning("请至少选择一个业务员")},cancelTransferBusiness(){this.transferBusinessDialog.open=!1,this.transferBusinessDialog.selectedPersons=[],this.transferBusinessDialog.syncCaseBusiness=!1,this.transferBusinessDialog.syncContractBusiness=!1},async confirmAddBusiness(){if(0!==this.addBusinessDialog.selectedPersons.length){this.addBusinessDialog.loading=!0;try{const t=await n["a"].batchAddBusiness({customer_ids:this.ids,selected_persons:this.addBusinessDialog.selectedPersons,sync_case_business:this.addBusinessDialog.syncCaseBusiness,sync_contract_business:this.addBusinessDialog.syncContractBusiness});var e;if(t.data&&t.data.success)this.$message.success(t.data.message||"添加业务员成功"),this.addBusinessDialog.open=!1,this.getList();else this.$message.error((null===(e=t.data)||void 0===e?void 0:e.message)||"添加业务员失败")}catch(t){console.error("添加业务员失败:",t),this.$message.error("添加业务员失败，请重试")}finally{this.addBusinessDialog.loading=!1}}else this.$message.warning("请至少选择一个业务员")},cancelAddBusiness(){this.addBusinessDialog.open=!1,this.addBusinessDialog.selectedPersons=[],this.addBusinessDialog.syncCaseBusiness=!1,this.addBusinessDialog.syncContractBusiness=!1},getBusinessPersonList(e){return e?"string"===typeof e?e.split(",").map(e=>e.trim()).filter(e=>e):[e]:[]},handleChangeProcessStaff(){0!==this.ids.length?this.$prompt("请输入流程人员姓名","修改流程人员",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S+/,inputErrorMessage:"流程人员姓名不能为空"}).then(({value:e})=>{this.$message({type:"success",message:`已成功为${this.ids.length}条记录修改流程人员为：${e}`})}).catch(()=>{}):this.$message.warning("请至少选择一条记录")},handleTransferToPublic(){0!==this.ids.length?(this.transferToPublicDialog.open=!0,this.transferToPublicDialog.selectedPool=void 0):this.$message.warning("请至少选择一条记录")},async confirmTransferToPublic(){if(this.transferToPublicDialog.selectedPool){this.transferToPublicDialog.loading=!0;try{const t=await n["a"].moveToPublic({customer_ids:this.ids,pool_type:this.transferToPublicDialog.selectedPool});var e;if(t.data&&t.data.success)this.$message.success(t.data.message||"转入公海成功"),this.transferToPublicDialog.open=!1,this.getList();else this.$message.error((null===(e=t.data)||void 0===e?void 0:e.message)||"转入公海失败")}catch(t){console.error("转入公海失败:",t),this.$message.error("转入公海失败，请重试")}finally{this.transferToPublicDialog.loading=!1}}else this.$message.warning("请选择要转入的公海")},cancelTransferToPublic(){this.transferToPublicDialog.open=!1,this.transferToPublicDialog.selectedPool=void 0},handleBeforeUpload(e){const t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||"application/vnd.ms-excel"===e.type;return!!t||(this.$message.warning("仅允许导入Excel文件!"),!1)},updateVisibleColumns(e){this.visibleColumns=e},handleSetSort(){if(0===this.ids.length)return void this.$message.warning("请至少选择一条记录");const e=this.customerList.filter(e=>this.ids.includes(e.id));this.sortDialog.customers=e.map(e=>({id:e.id,customer_name:e.name,credit_code:e.creditCode,current_sort:e.sort_order||null,new_sort:e.sort_order||null})),this.sortDialog.open=!0},batchSetSort(){!this.batchSortStart||this.batchSortStart<1?this.$message.warning("请输入有效的起始序号"):this.sortDialog.customers.forEach((e,t)=>{e.new_sort=this.batchSortStart+t})},clearSort(e){e.new_sort=null},async confirmSort(){const e=this.sortDialog.customers.filter(e=>null!==e.new_sort&&void 0!==e.new_sort).map(e=>({customer_id:e.id,sort_order:e.new_sort}));if(0!==e.length){this.sortDialog.loading=!0;try{const s=await n["a"].setCustomerSort({sort_data:e,list_type:"allCustomer"});var t;if(s.data&&s.data.success)this.$message.success("排序设置成功"),this.sortDialog.open=!1,this.hasCustomSort=!0,this.getList();else this.$message.error((null===(t=s.data)||void 0===t?void 0:t.message)||"排序设置失败")}catch(s){console.error("排序设置失败:",s),this.$message.error("排序设置失败，请重试")}finally{this.sortDialog.loading=!1}}else this.$message.warning("请至少为一个客户设置排序序号")},cancelSort(){this.sortDialog.open=!1,this.sortDialog.customers=[]},handleResetSort(){this.$confirm("确定要重置自定义排序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=await n["a"].resetCustomerSort({list_type:"allCustomer"});e.data&&e.data.success?(this.hasCustomSort=!1,this.getList(),this.$message.success("排序已重置")):this.$message.error("重置排序失败")}catch(e){console.error("重置排序失败:",e);const t="customer_sort_allCustomer_"+(this.$store.getters.userId||"default");localStorage.removeItem(t),this.hasCustomSort=!1,this.getList(),this.$message.success("排序已重置")}}).catch(()=>{})}}},o=l,c=(s("1b89"),s("2877")),u=Object(c["a"])(o,a,i,!1,null,null,null);t["default"]=u.exports},7282:function(e,t,s){"use strict";var a=s("e330"),i=s("59ed");e.exports=function(e,t,s){try{return a(i(Object.getOwnPropertyDescriptor(e,t)[s]))}catch(r){}}},"72c3":function(e,t,s){"use strict";var a=s("23e7"),i=s("e9bc"),r=s("dad2");a({target:"Set",proto:!0,real:!0,forced:!r("union")},{union:i})},"79a4":function(e,t,s){"use strict";var a=s("23e7"),i=s("d039"),r=s("953b"),n=s("dad2"),l=!n("intersection",(function(e){return 2===e.size&&e.has(1)&&e.has(2)}))||i((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}));a({target:"Set",proto:!0,real:!0,forced:l},{intersection:r})},"7f65":function(e,t,s){"use strict";var a=s("59ed"),i=s("825a"),r=s("c65b"),n=s("5926"),l=s("46c4"),o="Invalid size",c=RangeError,u=TypeError,d=Math.max,p=function(e,t){this.set=e,this.size=d(t,0),this.has=a(e.has),this.keys=a(e.keys)};p.prototype={getIterator:function(){return l(i(r(this.keys,this.set)))},includes:function(e){return r(this.has,this.set,e)}},e.exports=function(e){i(e);var t=+e.size;if(t!==t)throw new u(o);var s=n(t);if(s<0)throw new c(o);return new p(e,s)}},"83b9e":function(e,t,s){"use strict";var a=s("cb27"),i=s("384f"),r=a.Set,n=a.add;e.exports=function(e){var t=new r;return i(e,(function(e){n(t,e)})),t}},"857b":function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"导出数据",visible:e.dialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[t("div",{staticClass:"export-dialog-content"},[t("div",{staticClass:"field-selection"},[t("div",{staticClass:"section-title"},[e._v("选择导出字段")]),t("div",{staticClass:"field-grid"},[t("el-checkbox-group",{model:{value:e.selectedFields,callback:function(t){e.selectedFields=t},expression:"selectedFields"}},e._l(e.availableFields,(function(s){return t("el-checkbox",{key:s.prop,staticClass:"field-checkbox",attrs:{label:s.prop}},[e._v(" "+e._s(s.label)+" ")])})),1)],1)]),t("div",{staticClass:"quick-actions"},[t("el-button",{attrs:{size:"small"},on:{click:e.selectAll}},[e._v("全选")]),t("el-button",{attrs:{size:"small"},on:{click:e.selectNone}},[e._v("全不选")]),t("el-button",{attrs:{size:"small"},on:{click:e.selectDefault}},[e._v("默认字段")])],1),t("div",{staticClass:"export-options"},[t("div",{staticClass:"section-title"},[e._v("导出选项")]),t("el-form",{attrs:{model:e.exportOptions,"label-width":"100px",size:"small"}},[t("el-form-item",{attrs:{label:"文件名称"}},[t("el-input",{attrs:{placeholder:"请输入文件名称"},model:{value:e.exportOptions.filename,callback:function(t){e.$set(e.exportOptions,"filename",t)},expression:"exportOptions.filename"}})],1),t("el-form-item",{attrs:{label:"导出格式"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.exportOptions.format,callback:function(t){e.$set(e.exportOptions,"format",t)},expression:"exportOptions.format"}},[t("el-option",{attrs:{label:"Excel (.xlsx)",value:"xlsx"}}),t("el-option",{attrs:{label:"CSV (.csv)",value:"csv"}})],1)],1),t("el-form-item",{attrs:{label:"导出范围"}},[t("el-radio-group",{model:{value:e.exportOptions.scope,callback:function(t){e.$set(e.exportOptions,"scope",t)},expression:"exportOptions.scope"}},[t("el-radio",{attrs:{label:"current"}},[e._v("当前页数据")]),t("el-radio",{attrs:{label:"all"}},[e._v("全部数据")]),t("el-radio",{attrs:{label:"selected"}},[e._v("选中数据")])],1)],1)],1)],1),t("div",{staticClass:"preview-info"},[t("div",{staticClass:"info-item"},[t("span",{staticClass:"label"},[e._v("导出字段数：")]),t("span",{staticClass:"value"},[e._v(e._s(e.selectedFields.length))])]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"label"},[e._v("预计数据量：")]),t("span",{staticClass:"value"},[e._v(e._s(e.getEstimatedCount())+" 条")])])])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.exporting,disabled:0===e.selectedFields.length},on:{click:e.handleExport}},[e._v(" "+e._s(e.exporting?"导出中...":"确认导出")+" ")])],1)])},i=[],r=(s("e9f5"),s("ab43"),{name:"ExportDialog",props:{visible:{type:Boolean,default:!1},availableFields:{type:Array,default:()=>[]},defaultFields:{type:Array,default:()=>[]},totalCount:{type:Number,default:0},currentPageCount:{type:Number,default:0},selectedCount:{type:Number,default:0}},data(){return{dialogVisible:!1,selectedFields:[],exporting:!1,exportOptions:{filename:"",format:"xlsx",scope:"current"}}},watch:{visible:{immediate:!0,handler(e){this.dialogVisible=e,e&&this.initDialog()}}},methods:{initDialog(){this.selectedFields=[...this.defaultFields];const e=new Date,t=e.getFullYear()+String(e.getMonth()+1).padStart(2,"0")+String(e.getDate()).padStart(2,"0")+"_"+String(e.getHours()).padStart(2,"0")+String(e.getMinutes()).padStart(2,"0");this.exportOptions.filename="客户列表_"+t},selectAll(){this.selectedFields=this.availableFields.map(e=>e.prop)},selectNone(){this.selectedFields=[]},selectDefault(){this.selectedFields=[...this.defaultFields]},getEstimatedCount(){switch(this.exportOptions.scope){case"current":return this.currentPageCount;case"all":return this.totalCount;case"selected":return this.selectedCount;default:return 0}},async handleExport(){if(0!==this.selectedFields.length){this.exporting=!0;try{const e={fields:this.selectedFields,filename:this.exportOptions.filename,format:this.exportOptions.format,scope:this.exportOptions.scope};this.$emit("export",e)}catch(e){console.error("导出失败:",e),this.$message.error("导出失败，请重试")}finally{this.exporting=!1}}else this.$message.warning("请至少选择一个导出字段")},handleClose(){this.dialogVisible=!1,this.$emit("update:visible",!1)},setExportComplete(){this.exporting=!1,this.handleClose()}}}),n=r,l=(s("037a"),s("2877")),o=Object(l["a"])(n,a,i,!1,null,"74b4e734",null);t["a"]=o.exports},8670:function(e,t,s){},"8b00":function(e,t,s){"use strict";var a=s("23e7"),i=s("68df"),r=s("dad2"),n=!r("isSubsetOf",(function(e){return e}));a({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:i})},"8e16":function(e,t,s){"use strict";var a=s("7282"),i=s("cb27");e.exports=a(i.proto,"size","get")||function(e){return e.size}},"953b":function(e,t,s){"use strict";var a=s("dc19"),i=s("cb27"),r=s("8e16"),n=s("7f65"),l=s("384f"),o=s("5388"),c=i.Set,u=i.add,d=i.has;e.exports=function(e){var t=a(this),s=n(e),i=new c;return r(t)>s.size?o(s.getIterator(),(function(e){d(t,e)&&u(i,e)})):l(t,(function(e){s.includes(e)&&u(i,e)})),i}},9961:function(e,t,s){"use strict";var a=s("dc19"),i=s("cb27"),r=s("83b9e"),n=s("7f65"),l=s("5388"),o=i.add,c=i.has,u=i.remove;e.exports=function(e){var t=a(this),s=n(e).getIterator(),i=r(t);return l(s,(function(e){c(t,e)?u(i,e):o(i,e)})),i}},a4e7:function(e,t,s){"use strict";var a=s("23e7"),i=s("395e"),r=s("dad2"),n=!r("isSupersetOf",(function(e){return!e}));a({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:i})},a5f7:function(e,t,s){"use strict";var a=s("dc19"),i=s("cb27"),r=s("83b9e"),n=s("8e16"),l=s("7f65"),o=s("384f"),c=s("5388"),u=i.has,d=i.remove;e.exports=function(e){var t=a(this),s=l(e),i=r(t);return n(t)<=s.size?o(t,(function(e){s.includes(e)&&d(i,e)})):c(s.getIterator(),(function(e){u(t,e)&&d(i,e)})),i}},abe8:function(e,t,s){},b4bc:function(e,t,s){"use strict";var a=s("dc19"),i=s("cb27").has,r=s("8e16"),n=s("7f65"),l=s("384f"),o=s("5388"),c=s("2a62");e.exports=function(e){var t=a(this),s=n(e);if(r(t)<=s.size)return!1!==l(t,(function(e){if(s.includes(e))return!1}),!0);var u=s.getIterator();return!1!==o(u,(function(e){if(i(t,e))return c(u,"normal",!1)}))}},c1a1:function(e,t,s){"use strict";var a=s("23e7"),i=s("b4bc"),r=s("dad2"),n=!r("isDisjointFrom",(function(e){return!e}));a({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:i})},cb27:function(e,t,s){"use strict";var a=s("e330"),i=Set.prototype;e.exports={Set:Set,add:a(i.add),has:a(i.has),remove:a(i["delete"]),proto:i}},dad2:function(e,t,s){"use strict";var a=s("d066"),i=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}};e.exports=function(e,t){var s=a("Set");try{(new s)[e](i(0));try{return(new s)[e](i(-1)),!1}catch(l){if(!t)return!0;try{return(new s)[e](r(-1/0)),!1}catch(o){var n=new s;return n.add(1),n.add(2),t(n[e](r(1/0)))}}}catch(o){return!1}}},dc19:function(e,t,s){"use strict";var a=s("cb27").has;e.exports=function(e){return a(e),e}},e9bc:function(e,t,s){"use strict";var a=s("dc19"),i=s("cb27").add,r=s("83b9e"),n=s("7f65"),l=s("5388");e.exports=function(e){var t=a(this),s=n(e).getIterator(),o=r(t);return l(s,(function(e){i(o,e)})),o}}}]);