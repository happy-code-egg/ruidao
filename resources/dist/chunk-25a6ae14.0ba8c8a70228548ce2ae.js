(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25a6ae14"],{"1dbe":function(t,e,a){"use strict";a("c4d3")},c4d3:function(t,e,a){},eaf34:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"write-off-pending-container"},[e("div",{staticClass:"body-part-search"},[e("el-form",{ref:"searchForm",attrs:{model:t.searchForm,"label-width":"100px"}},[e("el-row",[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"到款单号",prop:"paymentNo"}},[e("el-input",{attrs:{placeholder:"到款单号",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.searchForm.paymentNo,callback:function(e){t.$set(t.searchForm,"paymentNo",e)},expression:"searchForm.paymentNo"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"请款单号",prop:"requestNo"}},[e("el-input",{attrs:{placeholder:"请款单号",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.searchForm.requestNo,callback:function(e){t.$set(t.searchForm,"requestNo",e)},expression:"searchForm.requestNo"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"客户名称",prop:"customerName"}},[e("el-input",{attrs:{placeholder:"客户名称",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.searchForm.customerName,callback:function(e){t.$set(t.searchForm,"customerName",e)},expression:"searchForm.customerName"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"合同号",prop:"contractNo"}},[e("el-input",{attrs:{placeholder:"合同号",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.searchForm.contractNo,callback:function(e){t.$set(t.searchForm,"contractNo",e)},expression:"searchForm.contractNo"}})],1)],1)],1),t.expandVisible?e("el-row",[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"到账时间",prop:"receivedTimeRange"}},[e("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small","value-format":"yyyy-MM-dd"},model:{value:t.searchForm.receivedTimeRange,callback:function(e){t.$set(t.searchForm,"receivedTimeRange",e)},expression:"searchForm.receivedTimeRange"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"金额范围",prop:"amountRange"}},[e("div",{staticClass:"amount-range"},[e("el-input",{staticStyle:{width:"45%"},attrs:{placeholder:"最小",size:"small"},model:{value:t.searchForm.minAmount,callback:function(e){t.$set(t.searchForm,"minAmount",e)},expression:"searchForm.minAmount"}}),e("span",{staticStyle:{margin:"0 2%"}},[t._v("-")]),e("el-input",{staticStyle:{width:"45%"},attrs:{placeholder:"最大",size:"small"},model:{value:t.searchForm.maxAmount,callback:function(e){t.$set(t.searchForm,"maxAmount",e)},expression:"searchForm.maxAmount"}})],1)])],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"认领人",prop:"claimedBy"}},[e("el-input",{attrs:{placeholder:"认领人",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.searchForm.claimedBy,callback:function(e){t.$set(t.searchForm,"claimedBy",e)},expression:"searchForm.claimedBy"}})],1)],1)],1):t._e()],1),e("div",{staticClass:"part-search-buttons"},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("搜索")]),e("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:t.handleReset}},[t._v("重置")])],1)],1),e("div",{staticClass:"stats-container"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card"},[e("div",{staticClass:"stat-value"},[t._v(t._s(t.statistics.totalCount))]),e("div",{staticClass:"stat-label"},[t._v("待核销笔数")])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card"},[e("div",{staticClass:"stat-value",staticStyle:{color:"#e6a23c"}},[t._v("¥"+t._s(t.statistics.totalAmount))]),e("div",{staticClass:"stat-label"},[t._v("可核销金额")])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card"},[e("div",{staticClass:"stat-value",staticStyle:{color:"#67c23a"}},[t._v(t._s(t.statistics.matchedCount))]),e("div",{staticClass:"stat-label"},[t._v("已匹配请款")])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card"},[e("div",{staticClass:"stat-value",staticStyle:{color:"#f56c6c"}},[t._v(t._s(t.statistics.unmatchedCount))]),e("div",{staticClass:"stat-label"},[t._v("未匹配请款")])])])],1)],1),e("div",{staticClass:"body-part-content"},[e("div",{staticClass:"part-table-header"},[e("div",{staticClass:"part-table-title"},[t._v("待核销列表")]),e("div",{staticClass:"part-table-operations"},[e("el-button",{attrs:{size:"small",type:"success",disabled:0===t.selectedRows.length},on:{click:t.handleBatchWriteOff}},[t._v("批量核销")]),e("el-button",{attrs:{size:"small",type:"info"},on:{click:t.handleExport}},[t._v("导出")])],1)]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",size:"small","row-key":"id","row-class-name":t.tableRowClassName},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"80"}}),e("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),e("el-table-column",{attrs:{prop:"paymentNo",label:"到款单号",width:"140","show-overflow-tooltip":"",fixed:"left"}}),e("el-table-column",{attrs:{prop:"customerName",label:"客户名称","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"link-text",on:{click:function(e){return t.handleViewCustomer(a.row.customerId)}}},[t._v(" "+t._s(a.row.customerName)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"contractNo",label:"合同号",width:"130","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.contractNo?e("span",{staticClass:"link-text",on:{click:function(e){return t.handleViewContract(a.row.contractNo)}}},[t._v(" "+t._s(a.row.contractNo)+" ")]):e("span",{staticStyle:{color:"#c0c4cc"}},[t._v("-")])]}}])}),e("el-table-column",{attrs:{prop:"totalAmount",label:"到款总额",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"amount-text"},[t._v("¥"+t._s(a.row.totalAmount))])]}}])}),e("el-table-column",{attrs:{prop:"usedAmount",label:"已核销金额",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"amount-text",staticStyle:{color:"#67c23a"}},[t._v("¥"+t._s(a.row.usedAmount))])]}}])}),e("el-table-column",{attrs:{prop:"remainingAmount",label:"待核销金额",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"amount-text remaining-amount",class:{"low-balance":a.row.remainingAmount<.1*a.row.totalAmount}},[t._v(" ¥"+t._s(a.row.remainingAmount)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"receivedTime",label:"到账时间"}}),e("el-table-column",{attrs:{prop:"claimedBy",label:"认领人"}}),e("el-table-column",{attrs:{prop:"matchedRequests",label:"匹配请款单",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.matchedRequests&&a.row.matchedRequests.length>0?e("div",t._l(a.row.matchedRequests,(function(a,s){return e("el-tag",{key:s,staticClass:"link-tag",staticStyle:{margin:"2px"},attrs:{size:"mini"},on:{click:function(e){return t.handleViewRequest(a.requestNo)}}},[t._v(" "+t._s(a.requestNo)+" (¥"+t._s(a.amount)+") ")])})),1):e("span",{staticStyle:{color:"#c0c4cc"}},[t._v("未匹配")])]}}])}),e("el-table-column",{attrs:{prop:"waitingDays",label:"等待天数",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getWaitingDaysType(a.row.waitingDays),size:"small"}},[t._v(" "+t._s(a.row.waitingDays)+"天 ")])]}}])}),e("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.handleView(a.row)}}},[t._v("查看")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.handleWriteOff(a.row)}}},[t._v("核销")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.handleMatch(a.row)}}},[t._v("匹配请款单")])]}}])})],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,50],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),e("el-dialog",{attrs:{title:"核销到款",visible:t.writeOffDialogVisible,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(e){t.writeOffDialogVisible=e}}},[e("el-form",{ref:"writeOffFormRef",attrs:{model:t.writeOffForm,rules:t.writeOffRules,"label-width":"120px"}},[e("el-descriptions",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"到款信息",column:2,border:""}},[e("el-descriptions-item",{attrs:{label:"到款单号"}},[t._v(t._s(t.currentWriteOffRow.paymentNo))]),e("el-descriptions-item",{attrs:{label:"客户名称"}},[t._v(t._s(t.currentWriteOffRow.customerName))]),e("el-descriptions-item",{attrs:{label:"到款总额"}},[e("span",{staticClass:"amount-highlight"},[t._v("¥"+t._s(t.currentWriteOffRow.totalAmount))])]),e("el-descriptions-item",{attrs:{label:"待核销金额"}},[e("span",{staticClass:"amount-highlight"},[t._v("¥"+t._s(t.currentWriteOffRow.remainingAmount))])])],1),"request"===t.writeOffForm.writeOffType?e("el-form-item",{attrs:{label:"关联请款单",prop:"requestId"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择请款单",filterable:""},on:{change:t.handleRequestChange},model:{value:t.writeOffForm.requestId,callback:function(e){t.$set(t.writeOffForm,"requestId",e)},expression:"writeOffForm.requestId"}},t._l(t.requestList,(function(t){return e("el-option",{key:t.id,attrs:{label:`${t.requestNo} - ¥${t.amount} (${t.customerName})`,value:t.id}})})),1)],1):t._e(),"contract"===t.writeOffForm.writeOffType?e("el-form-item",{attrs:{label:"关联合同",prop:"contractId"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择合同",filterable:""},model:{value:t.writeOffForm.contractId,callback:function(e){t.$set(t.writeOffForm,"contractId",e)},expression:"writeOffForm.contractId"}},t._l(t.contractList,(function(t){return e("el-option",{key:t.id,attrs:{label:`${t.contractNo} - ${t.contractName}`,value:t.id}})})),1)],1):t._e(),e("el-form-item",{attrs:{label:"核销金额",prop:"writeOffAmount"}},[e("el-input",{attrs:{placeholder:"请输入核销金额"},model:{value:t.writeOffForm.writeOffAmount,callback:function(e){t.$set(t.writeOffForm,"writeOffAmount",e)},expression:"writeOffForm.writeOffAmount"}},[e("template",{slot:"prepend"},[t._v("¥")])],2),e("div",{staticStyle:{color:"#999","font-size":"12px","margin-top":"5px"}},[t._v(" 最大可核销金额: ¥"+t._s(t.currentWriteOffRow.remainingAmount)+" ")])],1),e("el-form-item",{attrs:{label:"核销备注",prop:"remark"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入核销备注"},model:{value:t.writeOffForm.remark,callback:function(e){t.$set(t.writeOffForm,"remark",e)},expression:"writeOffForm.remark"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.writeOffDialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary",loading:t.submitting},on:{click:t.handleConfirmWriteOff}},[t._v("确认核销")])],1)],1),e("el-dialog",{attrs:{title:"匹配请款单",visible:t.matchDialogVisible,width:"900px","close-on-click-modal":!1},on:{"update:visible":function(e){t.matchDialogVisible=e}}},[e("div",{staticClass:"match-content"},[e("div",{staticClass:"payment-info"},[e("h4",[t._v("到款信息")]),e("el-descriptions",{attrs:{column:3,border:""}},[e("el-descriptions-item",{attrs:{label:"到款单号"}},[t._v(t._s(t.currentMatchRow.paymentNo))]),e("el-descriptions-item",{attrs:{label:"客户名称"}},[t._v(t._s(t.currentMatchRow.customerName))]),e("el-descriptions-item",{attrs:{label:"待核销金额"}},[e("span",{staticClass:"amount-highlight"},[t._v("¥"+t._s(t.currentMatchRow.remainingAmount))])])],1)],1),e("div",{staticClass:"request-search"},[e("h4",[t._v("搜索请款单")]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:"请款单号",clearable:"",size:"small"},model:{value:t.matchSearch.requestNo,callback:function(e){t.$set(t.matchSearch,"requestNo",e)},expression:"matchSearch.requestNo"}})],1),e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:"客户名称",clearable:"",size:"small"},model:{value:t.matchSearch.customerName,callback:function(e){t.$set(t.matchSearch,"customerName",e)},expression:"matchSearch.customerName"}})],1),e("el-col",{attrs:{span:8}},[e("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.searchRequests}},[t._v("搜索")])],1)],1)],1),e("div",{staticClass:"request-list"},[e("h4",[t._v("可匹配的请款单")]),e("el-table",{attrs:{data:t.availableRequests,border:"",size:"small",height:"300"}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),e("el-table-column",{attrs:{prop:"requestNo",label:"请款单号",width:"140"}}),e("el-table-column",{attrs:{prop:"customerName",label:"客户名称"}}),e("el-table-column",{attrs:{prop:"amount",label:"请款金额",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" ¥"+t._s(e.row.amount)+" ")]}}])}),e("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:"approved"===a.row.status?"success":"warning",size:"mini"}},[t._v(" "+t._s("approved"===a.row.status?"已通过":"待审核")+" ")])]}}])}),e("el-table-column",{attrs:{prop:"createTime",label:"申请时间"}}),e("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.addToMatch(a.row)}}},[t._v("匹配")])]}}])})],1)],1)]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.matchDialogVisible=!1}}},[t._v("关闭")])],1)]),e("el-dialog",{attrs:{title:"到款详情",visible:t.viewDialogVisible,width:"90%"},on:{"update:visible":function(e){t.viewDialogVisible=e}}},[e("div",{staticClass:"payment-detail"},[e("div",{staticClass:"detail-section"},[e("h4",[t._v("到款信息")]),e("el-descriptions",{attrs:{column:3,border:""}},[e("el-descriptions-item",{attrs:{label:"到款单号"}},[t._v(t._s(t.viewData.paymentNo))]),e("el-descriptions-item",{attrs:{label:"客户名称"}},[t._v(t._s(t.viewData.customerName))]),e("el-descriptions-item",{attrs:{label:"合同号"}},[t._v(t._s(t.viewData.contractNo||"-"))]),e("el-descriptions-item",{attrs:{label:"到款总额"}},[e("span",{staticClass:"amount-highlight"},[t._v("¥"+t._s(t.viewData.totalAmount))])]),e("el-descriptions-item",{attrs:{label:"已核销金额"}},[e("span",{staticClass:"amount-text",staticStyle:{color:"#67c23a"}},[t._v("¥"+t._s(t.viewData.usedAmount))])]),e("el-descriptions-item",{attrs:{label:"待核销金额"}},[e("span",{staticClass:"amount-text remaining-amount"},[t._v("¥"+t._s(t.viewData.remainingAmount))])]),e("el-descriptions-item",{attrs:{label:"到账时间"}},[t._v(t._s(t.viewData.receivedTime))]),e("el-descriptions-item",{attrs:{label:"认领人"}},[t._v(t._s(t.viewData.claimedBy))]),e("el-descriptions-item",{attrs:{label:"等待天数"}},[t._v(t._s(t.viewData.waitingDays)+"天")])],1)],1),t.viewData.writeOffRecords&&t.viewData.writeOffRecords.length>0?e("div",{staticClass:"detail-section"},[e("h4",[t._v("核销记录")]),e("el-table",{attrs:{data:t.viewData.writeOffRecords,border:"",size:"small"}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),e("el-table-column",{attrs:{prop:"writeOffNo",label:"核销单号",width:"140"}}),e("el-table-column",{attrs:{prop:"writeOffAmount",label:"核销金额",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" ¥"+t._s(e.row.writeOffAmount)+" ")]}}],null,!1,1141070246)}),e("el-table-column",{attrs:{prop:"purpose",label:"核销用途"}}),e("el-table-column",{attrs:{prop:"writeOffDate",label:"核销日期",width:"120"}}),e("el-table-column",{attrs:{prop:"writeOffBy",label:"核销人"}}),e("el-table-column",{attrs:{prop:"remark",label:"备注"}})],1)],1):t._e()]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.viewDialogVisible=!1}}},[t._v("关闭")])],1)])],1)},r=[],i=(a("14d9"),a("e9f5"),a("f665"),a("ab43"),{name:"WriteOffPending",data(){return{loading:!1,submitting:!1,expandVisible:!0,searchForm:{paymentNo:"",requestNo:"",customerName:"",contractNo:"",receivedTimeRange:[],minAmount:"",maxAmount:"",claimedBy:""},tableData:[],selectedRows:[],currentPage:1,pageSize:10,total:0,statistics:{totalCount:0,totalAmount:"0",matchedCount:0,unmatchedCount:0},writeOffDialogVisible:!1,writeOffForm:{writeOffType:"request",requestId:"",contractId:"",writeOffAmount:"",purpose:"",remark:""},writeOffRules:{writeOffType:[{required:!0,message:"请选择核销类型",trigger:"change"}],writeOffAmount:[{required:!0,message:"请输入核销金额",trigger:"blur"},{pattern:/^\d+(\.\d{1,2})?$/,message:"请输入正确的金额格式",trigger:"blur"}],purpose:[{required:!0,message:"请输入核销用途",trigger:"blur"}]},currentWriteOffRow:{},requestList:[],contractList:[],matchDialogVisible:!1,currentMatchRow:{},matchSearch:{requestNo:"",customerName:""},availableRequests:[],viewDialogVisible:!1,viewData:{}}},created(){this.getList(),this.getStatistics(),this.initData()},methods:{getList(){this.loading=!0,setTimeout(()=>{this.tableData=Array.from({length:18}).map((t,e)=>{const a=parseFloat((1e4+5e4*Math.random()).toFixed(2)),s=a*Math.random()*.8,r=a-s,i=new Date(Date.now()-30*Math.random()*24*60*60*1e3),l=Math.floor((Date.now()-i.getTime())/864e5);return{id:e+1,paymentNo:"DK"+String(Date.now()+e).slice(-8),customerName:"客户公司"+(e+1),customerId:"cust_"+(e+1),contractNo:Math.random()>.3?"HT"+String(1e4+e).padStart(6,"0"):"",totalAmount:a.toFixed(2),usedAmount:s.toFixed(2),remainingAmount:r.toFixed(2),receivedTime:i.toLocaleString(),claimedBy:"商务员"+(e+1),waitingDays:l,matchedRequests:Math.random()>.4?[{requestNo:"QK"+String(Date.now()+e).slice(-8),amount:(1e4*Math.random()+5e3).toFixed(2)}]:[],writeOffRecords:s>0?[{writeOffNo:"HX"+String(Date.now()+e).slice(-8),writeOffAmount:s.toFixed(2),purpose:"请款核销",writeOffDate:new Date(i.getTime()+2592e5).toLocaleDateString(),writeOffBy:"财务员"+(e+1),remark:"核销备注"}]:[]}}),this.total=this.tableData.length,this.loading=!1},500)},getStatistics(){this.statistics={totalCount:62,totalAmount:"2,458,900.00",matchedCount:38,unmatchedCount:24}},initData(){this.requestList=Array.from({length:10}).map((t,e)=>({id:"req_"+(e+1),requestNo:"QK"+String(Date.now()+e+100).slice(-8),customerName:"客户公司"+(e+1),amount:(5e3+15e3*Math.random()).toFixed(2),status:"approved"})),this.contractList=Array.from({length:8}).map((t,e)=>({id:"contract_"+(e+1),contractNo:"HT"+String(1e4+e).padStart(6,"0"),contractName:"知识产权服务合同"+(e+1)}))},handleSearch(){this.currentPage=1,this.getList()},handleReset(){this.searchForm={paymentNo:"",requestNo:"",customerName:"",contractNo:"",receivedTimeRange:[],minAmount:"",maxAmount:"",claimedBy:""},this.getList()},handleSelectionChange(t){this.selectedRows=t},handleSizeChange(t){this.pageSize=t,this.getList()},handleCurrentChange(t){this.currentPage=t,this.getList()},tableRowClassName({row:t}){const e=parseFloat(t.remainingAmount),a=parseFloat(t.totalAmount);return e<.1*a?"low-balance-row":t.waitingDays>=15?"overdue-row":""},getWaitingDaysType(t){return t>=30?"danger":t>=15?"warning":""},handleView(t){this.viewData={...t},this.viewDialogVisible=!0},handleWriteOff(t){this.currentWriteOffRow=t,this.writeOffForm={writeOffType:"request",requestId:"",contractId:"",writeOffAmount:"",purpose:"",remark:""},this.writeOffDialogVisible=!0},handleRequestChange(t){const e=this.requestList.find(e=>e.id===t);e&&(this.writeOffForm.writeOffAmount=e.amount,this.writeOffForm.purpose=`请款单${e.requestNo}核销`)},handleConfirmWriteOff(){this.$refs.writeOffFormRef.validate(t=>{if(t){const t=parseFloat(this.currentWriteOffRow.remainingAmount),e=parseFloat(this.writeOffForm.writeOffAmount);if(e>t)return void this.$message.error("核销金额不能超过待核销金额");this.submitting=!0,setTimeout(()=>{this.$message.success("核销成功"),this.writeOffDialogVisible=!1,this.submitting=!1,this.getList(),this.getStatistics()},1e3)}})},handleMatch(t){this.currentMatchRow=t,this.matchSearch={requestNo:"",customerName:t.customerName},this.searchRequests(),this.matchDialogVisible=!0},searchRequests(){this.availableRequests=Array.from({length:6}).map((t,e)=>({id:"avail_"+(e+1),requestNo:"QK"+String(Date.now()+e+200).slice(-8),customerName:this.currentMatchRow.customerName,amount:(3e3+8e3*Math.random()).toFixed(2),status:Math.random()>.3?"approved":"pending",createTime:new Date(Date.now()-15*Math.random()*24*60*60*1e3).toLocaleString()}))},addToMatch(t){this.$confirm(`确认将请款单 ${t.requestNo} 与到款单 ${this.currentMatchRow.paymentNo} 进行匹配吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.success("匹配成功"),this.matchDialogVisible=!1,this.getList()})},handleCommand(t,e){switch(t){case"history":this.$message.info("查看核销记录功能开发中");break;case"split":this.$message.info("拆分核销功能开发中");break;case"transfer":this.$message.info("转移功能开发中");break}},handleBatchWriteOff(){this.$confirm(`确认批量核销选中的 ${this.selectedRows.length} 条记录吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.info("批量核销功能开发中")})},handleViewCustomer(t){this.$message.info("查看客户详情: "+t)},handleViewContract(t){this.$message.info("查看合同详情: "+t)},handleViewRequest(t){this.$router.push("/finance/payment-request/detail/"+t)},handleExport(){this.$message.info("导出功能开发中")}}}),l=i,o=(a("1dbe"),a("2877")),n=Object(o["a"])(l,s,r,!1,null,"0ce6498b",null);e["default"]=n.exports}}]);