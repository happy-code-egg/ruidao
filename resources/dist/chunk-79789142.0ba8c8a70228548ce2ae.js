(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-79789142"],{3741:function(e,t,l){},"3b9c":function(e,t,l){"use strict";l("9b8a")},"9b8a":function(e,t,l){},b40b:function(e,t,l){"use strict";l.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"opportunity-container"},[t("div",{staticClass:"filter-container"},[t("div",{staticClass:"filter-form"},[t("div",{staticClass:"default-filters"},[t("el-form",{ref:"queryForm",attrs:{model:e.queryParams,"label-width":"100px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"客户名称",prop:"customerName"}},[t("el-input",{attrs:{placeholder:"客户名称",clearable:""},model:{value:e.queryParams.customerName,callback:function(t){e.$set(e.queryParams,"customerName",t)},expression:"queryParams.customerName"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"商机名称",prop:"opportunityName"}},[t("el-input",{attrs:{placeholder:"商机名称",clearable:""},model:{value:e.queryParams.opportunityName,callback:function(t){e.$set(e.queryParams,"opportunityName",t)},expression:"queryParams.opportunityName"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"项目类型",prop:"caseType"}},[t("el-select",{attrs:{placeholder:"项目类型",clearable:""},model:{value:e.queryParams.caseType,callback:function(t){e.$set(e.queryParams,"caseType",t)},expression:"queryParams.caseType"}},[t("el-option",{attrs:{label:"发明专利",value:"发明专利"}}),t("el-option",{attrs:{label:"实用新型",value:"实用新型"}}),t("el-option",{attrs:{label:"外观设计",value:"外观设计"}}),t("el-option",{attrs:{label:"商标",value:"商标"}}),t("el-option",{attrs:{label:"软著",value:"软著"}}),t("el-option",{attrs:{label:"检索分析",value:"检索分析"}}),t("el-option",{attrs:{label:"专利布局",value:"专利布局"}})],1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"预计代理费",prop:"estimatedCostMin"}},[t("div",{staticClass:"estimated-cost-container"},[t("el-input",{staticClass:"estimated-cost-input",attrs:{placeholder:"数字",clearable:""},model:{value:e.queryParams.estimatedCostMin,callback:function(t){e.$set(e.queryParams,"estimatedCostMin",t)},expression:"queryParams.estimatedCostMin"}}),t("span",{staticClass:"estimated-cost-separator"},[e._v("到")]),t("el-input",{staticClass:"estimated-cost-input",attrs:{placeholder:"数字",clearable:""},model:{value:e.queryParams.estimatedCostMax,callback:function(t){e.$set(e.queryParams,"estimatedCostMax",t)},expression:"queryParams.estimatedCostMax"}})],1)])],1),t("el-col",{attrs:{xs:24,sm:12,md:12,lg:10,xl:8}},[t("el-form-item",{attrs:{label:"预计签约时间",prop:"expectedSigningStartDate"}},[t("div",{staticClass:"date-range-container"},[t("el-date-picker",{staticClass:"date-input",attrs:{type:"date",placeholder:"年/月/日",clearable:""},model:{value:e.queryParams.expectedSigningStartDate,callback:function(t){e.$set(e.queryParams,"expectedSigningStartDate",t)},expression:"queryParams.expectedSigningStartDate"}}),t("span",{staticClass:"date-separator"},[e._v("到")]),t("el-date-picker",{staticClass:"date-input",attrs:{type:"date",placeholder:"年/月/日",clearable:""},model:{value:e.queryParams.expectedSigningEndDate,callback:function(t){e.$set(e.queryParams,"expectedSigningEndDate",t)},expression:"queryParams.expectedSigningEndDate"}})],1)])],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"商机类型",prop:"opportunityType"}},[t("el-select",{attrs:{placeholder:"商机类型",clearable:""},model:{value:e.queryParams.opportunityType,callback:function(t){e.$set(e.queryParams,"opportunityType",t)},expression:"queryParams.opportunityType"}},[t("el-option",{attrs:{label:"专利申请",value:"专利申请"}}),t("el-option",{attrs:{label:"商标注册",value:"商标注册"}}),t("el-option",{attrs:{label:"著作权登记",value:"著作权登记"}}),t("el-option",{attrs:{label:"专利分析",value:"专利分析"}}),t("el-option",{attrs:{label:"专利咨询",value:"专利咨询"}})],1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"更新人",prop:"updater"}},[t("el-select",{attrs:{placeholder:"更新人",clearable:""},model:{value:e.queryParams.updater,callback:function(t){e.$set(e.queryParams,"updater",t)},expression:"queryParams.updater"}},[t("el-option",{attrs:{label:"张三",value:"张三"}}),t("el-option",{attrs:{label:"李四",value:"李四"}}),t("el-option",{attrs:{label:"王五",value:"王五"}}),t("el-option",{attrs:{label:"赵六",value:"赵六"}})],1)],1)],1),t("el-col",{attrs:{xs:24,sm:12,md:12,lg:10,xl:8}},[t("el-form-item",{attrs:{label:"更新时间",prop:"updateStartDate"}},[t("div",{staticClass:"date-range-container"},[t("el-date-picker",{staticClass:"date-input",attrs:{type:"date",placeholder:"年/月/日",clearable:""},model:{value:e.queryParams.updateStartDate,callback:function(t){e.$set(e.queryParams,"updateStartDate",t)},expression:"queryParams.updateStartDate"}}),t("span",{staticClass:"date-separator"},[e._v("到")]),t("el-date-picker",{staticClass:"date-input",attrs:{type:"date",placeholder:"年/月/日",clearable:""},model:{value:e.queryParams.updateEndDate,callback:function(t){e.$set(e.queryParams,"updateEndDate",t)},expression:"queryParams.updateEndDate"}})],1)])],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"所属部门",prop:"department"}},[t("el-select",{attrs:{placeholder:"所属部门",clearable:""},model:{value:e.queryParams.department,callback:function(t){e.$set(e.queryParams,"department",t)},expression:"queryParams.department"}},[t("el-option",{attrs:{label:"专利部",value:"专利部"}}),t("el-option",{attrs:{label:"商标部",value:"商标部"}}),t("el-option",{attrs:{label:"版权部",value:"版权部"}}),t("el-option",{attrs:{label:"法务部",value:"法务部"}})],1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"创建人",prop:"creator"}},[t("el-select",{attrs:{placeholder:"创建人",clearable:""},model:{value:e.queryParams.creator,callback:function(t){e.$set(e.queryParams,"creator",t)},expression:"queryParams.creator"}},[t("el-option",{attrs:{label:"张三",value:"张三"}}),t("el-option",{attrs:{label:"李四",value:"李四"}}),t("el-option",{attrs:{label:"王五",value:"王五"}}),t("el-option",{attrs:{label:"赵六",value:"赵六"}})],1)],1)],1),t("el-col",{attrs:{xs:24,sm:12,md:12,lg:10,xl:8}},[t("el-form-item",{attrs:{label:"创建时间",prop:"createStartDate"}},[t("div",{staticClass:"date-range-container"},[t("el-date-picker",{staticClass:"date-input",attrs:{type:"date",placeholder:"年/月/日",clearable:""},model:{value:e.queryParams.createStartDate,callback:function(t){e.$set(e.queryParams,"createStartDate",t)},expression:"queryParams.createStartDate"}}),t("span",{staticClass:"date-separator"},[e._v("到")]),t("el-date-picker",{staticClass:"date-input",attrs:{type:"date",placeholder:"年/月/日",clearable:""},model:{value:e.queryParams.createEndDate,callback:function(t){e.$set(e.queryParams,"createEndDate",t)},expression:"queryParams.createEndDate"}})],1)])],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"业务人员",prop:"businessPerson"}},[t("el-select",{attrs:{placeholder:"业务人员",clearable:""},model:{value:e.queryParams.businessPerson,callback:function(t){e.$set(e.queryParams,"businessPerson",t)},expression:"queryParams.businessPerson"}},[t("el-option",{attrs:{label:"张三",value:"张三"}}),t("el-option",{attrs:{label:"李四",value:"李四"}}),t("el-option",{attrs:{label:"王五",value:"王五"}}),t("el-option",{attrs:{label:"赵六",value:"赵六"}})],1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"商机状态",prop:"status"}},[t("el-select",{attrs:{placeholder:"商机状态",clearable:""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},[t("el-option",{attrs:{label:"初期沟通",value:"初期沟通"}}),t("el-option",{attrs:{label:"需求确认",value:"需求确认"}}),t("el-option",{attrs:{label:"方案制定",value:"方案制定"}}),t("el-option",{attrs:{label:"商务谈判",value:"商务谈判"}}),t("el-option",{attrs:{label:"合同签署",value:"合同签署"}}),t("el-option",{attrs:{label:"已成交",value:"已成交"}}),t("el-option",{attrs:{label:"已失败",value:"已失败"}})],1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"商机编号",prop:"opportunityNumber"}},[t("el-input",{attrs:{clearable:""},model:{value:e.queryParams.opportunityNumber,callback:function(t){e.$set(e.queryParams,"opportunityNumber",t)},expression:"queryParams.opportunityNumber"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"是否转合同",prop:"isContract"}},[t("el-select",{attrs:{placeholder:"是否转合同",clearable:""},model:{value:e.queryParams.isContract,callback:function(t){e.$set(e.queryParams,"isContract",t)},expression:"queryParams.isContract"}},[t("el-option",{attrs:{label:"是",value:"true"}}),t("el-option",{attrs:{label:"否",value:"false"}})],1)],1)],1)],1)],1)],1),t("div",{staticClass:"search-buttons"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("查询")]),t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.resetQuery}},[e._v("重置")])],1)])]),t("div",{staticClass:"table-container"},[t("div",{staticClass:"table-header"},[e._m(0),t("div",{staticClass:"table-operations"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleAdd}},[e._v("新增商机")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.exportData}},[e._v("导出")]),t("el-button",{attrs:{type:"danger",size:"small"}},[e._v("批量删除")]),t("column-filter",{attrs:{"storage-key":"opportunity",columns:e.availableColumns,"default-selected":e.defaultSelectedColumns},on:{"update:visible-columns":e.updateVisibleColumns}})],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.opportunityList,border:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"80",align:"center"}}),e.visibleColumns.index?t("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}):e._e(),e.visibleColumns.opportunityName?t("el-table-column",{attrs:{label:"商机名称",prop:"opportunityName",align:"left","min-width":"180","show-overflow-tooltip":""}}):e._e(),e.visibleColumns.customerName?t("el-table-column",{attrs:{label:"客户名称",prop:"customerName",align:"left","min-width":"180","show-overflow-tooltip":""}}):e._e(),e.visibleColumns.caseType?t("el-table-column",{attrs:{label:"项目类型",prop:"caseType",align:"center",width:"120"}}):e._e(),e.visibleColumns.opportunityType?t("el-table-column",{attrs:{label:"商机类型",prop:"opportunityType",align:"center",width:"120"}}):e._e(),e.visibleColumns.status?t("el-table-column",{attrs:{label:"商机状态",prop:"status",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-tag",{attrs:{type:e.getStatusType(l.row.status)}},[e._v(e._s(l.row.status))])]}}],null,!1,151477139)}):e._e(),e.visibleColumns.expectedAmount?t("el-table-column",{attrs:{label:"预计代理费",prop:"expectedAmount",align:"center",width:"100"}}):e._e(),e.visibleColumns.expectedSigningDate?t("el-table-column",{attrs:{label:"预计签约时间",prop:"expectedSigningDate",align:"center",width:"130"}}):e._e(),e.visibleColumns.opportunityNumber?t("el-table-column",{attrs:{label:"商机编号",prop:"opportunityNumber",align:"center",width:"130"}}):e._e(),e.visibleColumns.updater?t("el-table-column",{attrs:{label:"更新人",prop:"updater",align:"center",width:"100"}}):e._e(),e.visibleColumns.updateTime?t("el-table-column",{attrs:{label:"更新时间",prop:"updateTime",align:"center",width:"130"}}):e._e(),e.visibleColumns.isContract?t("el-table-column",{attrs:{label:"是否转合同",prop:"isContract",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(l){return[l.row.isContract?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"info"}},[e._v("否")])]}}],null,!1,708707024)}):e._e(),e.visibleColumns.background?t("el-table-column",{attrs:{label:"商机背景",prop:"background",align:"center",width:"160","show-overflow-tooltip":""}}):e._e(),e.visibleColumns.principal?t("el-table-column",{attrs:{label:"负责人",prop:"principal",align:"center",width:"100"}}):e._e(),e.visibleColumns.followUpCount?t("el-table-column",{attrs:{label:"跟进次数",prop:"followUpCount",align:"center",width:"100"}}):e._e(),e.visibleColumns.lastFollowUpDate?t("el-table-column",{attrs:{label:"最后跟进时间",prop:"lastFollowUpDate",align:"center",width:"130"}}):e._e(),e.visibleColumns.createDate?t("el-table-column",{attrs:{label:"创建时间",prop:"createDate",align:"center",width:"120"}}):e._e(),e.visibleColumns.remark?t("el-table-column",{attrs:{label:"备注",prop:"remark",align:"center",width:"160","show-overflow-tooltip":""}}):e._e(),t("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handleView(l.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-edit"},on:{click:function(t){return e.handleEdit(l.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-message"},on:{click:function(t){return e.handleFollowUpEdit(l.row)}}},[e._v("跟进")]),t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(l.row)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,30,50]},on:{"update:currentPage":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:current-page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:pageSize":function(t){return e.$set(e.queryParams,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParams,"pageSize",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.title,visible:e.open,width:"800px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"客户名称",prop:"customerName"}},[t("el-input",{attrs:{placeholder:"请输入",disabled:e.isView},model:{value:e.form.customerName,callback:function(t){e.$set(e.form,"customerName",t)},expression:"form.customerName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"商机编号",prop:"opportunityNumber"}},[t("el-input",{attrs:{placeholder:"系统自动生成",disabled:""},model:{value:e.form.opportunityNumber,callback:function(t){e.$set(e.form,"opportunityNumber",t)},expression:"form.opportunityNumber"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"商机名称",prop:"opportunityName"}},[t("el-input",{attrs:{placeholder:"请输入",disabled:e.isView},model:{value:e.form.opportunityName,callback:function(t){e.$set(e.form,"opportunityName",t)},expression:"form.opportunityName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"跟进方式",prop:"followUpMethod"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择跟进方式",disabled:e.isView},model:{value:e.form.followUpMethod,callback:function(t){e.$set(e.form,"followUpMethod",t)},expression:"form.followUpMethod"}},[t("el-option",{attrs:{label:"电话",value:"电话"}}),t("el-option",{attrs:{label:"上门拜访",value:"上门拜访"}}),t("el-option",{attrs:{label:"商务洽谈",value:"商务洽谈"}}),t("el-option",{attrs:{label:"邮件",value:"邮件"}}),t("el-option",{attrs:{label:"视频会议",value:"视频会议"}})],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"跟进地点",prop:"followUpLocation"}},[t("el-input",{attrs:{placeholder:"请输入",disabled:e.isView},model:{value:e.form.followUpLocation,callback:function(t){e.$set(e.form,"followUpLocation",t)},expression:"form.followUpLocation"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"跟进联系人",prop:"followUpContact"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择联系人",disabled:e.isView},model:{value:e.form.followUpContact,callback:function(t){e.$set(e.form,"followUpContact",t)},expression:"form.followUpContact"}},[t("el-option",{attrs:{label:"请选择联系人",value:""}}),t("el-option",{attrs:{label:"张教授",value:"张教授"}}),t("el-option",{attrs:{label:"王教授",value:"王教授"}}),t("el-option",{attrs:{label:"李总监",value:"李总监"}})],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"联系人电话",prop:"contactPhone"}},[t("el-input",{attrs:{placeholder:"请输入",disabled:e.isView},model:{value:e.form.contactPhone,callback:function(t){e.$set(e.form,"contactPhone",t)},expression:"form.contactPhone"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"负责人",prop:"principal"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择负责人",disabled:e.isView},model:{value:e.form.principal,callback:function(t){e.$set(e.form,"principal",t)},expression:"form.principal"}},[t("el-option",{attrs:{label:"李明",value:"李明"}}),t("el-option",{attrs:{label:"张华",value:"张华"}}),t("el-option",{attrs:{label:"王敏",value:"王敏"}})],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"下次跟进",prop:"nextFollowUpTime"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期时间",disabled:e.isView},model:{value:e.form.nextFollowUpTime,callback:function(t){e.$set(e.form,"nextFollowUpTime",t)},expression:"form.nextFollowUpTime"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"项目类型",prop:"caseType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目类型",disabled:e.isView},model:{value:e.form.caseType,callback:function(t){e.$set(e.form,"caseType",t)},expression:"form.caseType"}},[t("el-option",{attrs:{label:"发明专利",value:"发明专利"}}),t("el-option",{attrs:{label:"实用新型",value:"实用新型"}}),t("el-option",{attrs:{label:"外观设计",value:"外观设计"}}),t("el-option",{attrs:{label:"商标",value:"商标"}}),t("el-option",{attrs:{label:"软著",value:"软著"}}),t("el-option",{attrs:{label:"检索分析",value:"检索分析"}}),t("el-option",{attrs:{label:"专利布局",value:"专利布局"}})],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"商机类型",prop:"opportunityType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择商机类型",disabled:e.isView},model:{value:e.form.opportunityType,callback:function(t){e.$set(e.form,"opportunityType",t)},expression:"form.opportunityType"}},[t("el-option",{attrs:{label:"专利申请",value:"专利申请"}}),t("el-option",{attrs:{label:"商标注册",value:"商标注册"}}),t("el-option",{attrs:{label:"著作权登记",value:"著作权登记"}}),t("el-option",{attrs:{label:"专利分析",value:"专利分析"}}),t("el-option",{attrs:{label:"专利咨询",value:"专利咨询"}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"预计代理费",prop:"expectedAmount"}},[t("el-input",{attrs:{placeholder:"请输入",disabled:e.isView},model:{value:e.form.expectedAmount,callback:function(t){e.$set(e.form,"expectedAmount",t)},expression:"form.expectedAmount"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"预计签约时间",prop:"expectedSigningDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",disabled:e.isView},model:{value:e.form.expectedSigningDate,callback:function(t){e.$set(e.form,"expectedSigningDate",t)},expression:"form.expectedSigningDate"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"商机状态",prop:"status"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择商机状态",disabled:e.isView},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[t("el-option",{attrs:{label:"初期沟通",value:"初期沟通"}}),t("el-option",{attrs:{label:"需求确认",value:"需求确认"}}),t("el-option",{attrs:{label:"方案制定",value:"方案制定"}}),t("el-option",{attrs:{label:"商务谈判",value:"商务谈判"}}),t("el-option",{attrs:{label:"合同签署",value:"合同签署"}}),t("el-option",{attrs:{label:"已成交",value:"已成交"}}),t("el-option",{attrs:{label:"已失败",value:"已失败"}})],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"是否转合同",prop:"isContract"}},[t("el-switch",{attrs:{"active-text":"是","inactive-text":"否",disabled:e.isView},model:{value:e.form.isContract,callback:function(t){e.$set(e.form,"isContract",t)},expression:"form.isContract"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新人",prop:"updater"}},[t("el-input",{attrs:{placeholder:"系统自动填充",disabled:""},model:{value:e.form.updater,callback:function(t){e.$set(e.form,"updater",t)},expression:"form.updater"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"跟进内容",prop:"followUpContent"}},[t("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入跟进内容",disabled:e.isView},model:{value:e.form.followUpContent,callback:function(t){e.$set(e.form,"followUpContent",t)},expression:"form.followUpContent"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"商机背景",prop:"background"}},[t("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入商机背景信息",disabled:e.isView},model:{value:e.form.background,callback:function(t){e.$set(e.form,"background",t)},expression:"form.background"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入备注",disabled:e.isView},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"把握度",prop:"confidence"}},[t("el-input",{attrs:{placeholder:"请输入",disabled:e.isView},model:{value:e.form.confidence,callback:function(t){e.$set(e.form,"confidence",t)},expression:"form.confidence"}})],1)],1)],1)],1),e.isView?t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v("关 闭")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleEdit(e.form)}}},[e._v("编 辑")])],1):t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:e.followDialogTitle,visible:e.followDialogVisible,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.followDialogVisible=t}}},[t("el-form",{ref:"followupFormRef",attrs:{model:e.followForm,rules:e.followFormRules,"label-width":"100px",disabled:"view"===e.followDialogStatus}},[t("el-form-item",{attrs:{label:"跟进方式",prop:"followType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择跟进方式"},model:{value:e.followForm.followType,callback:function(t){e.$set(e.followForm,"followType",t)},expression:"followForm.followType"}},[t("el-option",{attrs:{label:"电话",value:"电话"}}),t("el-option",{attrs:{label:"邮件",value:"邮件"}}),t("el-option",{attrs:{label:"微信",value:"微信"}}),t("el-option",{attrs:{label:"面谈",value:"面谈"}}),t("el-option",{attrs:{label:"视频会议",value:"视频会议"}})],1)],1),t("el-form-item",{attrs:{label:"跟进时间",prop:"followTime"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择跟进时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.followForm.followTime,callback:function(t){e.$set(e.followForm,"followTime",t)},expression:"followForm.followTime"}})],1),t("el-form-item",{attrs:{label:"商机",prop:"opportunityId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择商机",clearable:""},model:{value:e.followForm.opportunityId,callback:function(t){e.$set(e.followForm,"opportunityId",t)},expression:"followForm.opportunityId"}},e._l(e.opportunityOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),t("div",{staticClass:"form-tip"},[e._v("不选择商机将直接跟进客户")])],1),t("el-form-item",{attrs:{label:"跟进内容",prop:"content"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入跟进内容",rows:4},model:{value:e.followForm.content,callback:function(t){e.$set(e.followForm,"content",t)},expression:"followForm.content"}})],1),t("el-form-item",{attrs:{label:"下次跟进",prop:"nextFollowTime"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择下次跟进时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.followForm.nextFollowTime,callback:function(t){e.$set(e.followForm,"nextFollowTime",t)},expression:"followForm.nextFollowTime"}})],1),t("el-form-item",{attrs:{label:"下次内容",prop:"nextContent"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入下次跟进内容",rows:2},model:{value:e.followForm.nextContent,callback:function(t){e.$set(e.followForm,"nextContent",t)},expression:"followForm.nextContent"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息",rows:2},model:{value:e.followForm.remark,callback:function(t){e.$set(e.followForm,"remark",t)},expression:"followForm.remark"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.followDialogVisible=!1}}},[e._v("取 消")]),"view"!==e.followDialogStatus?t("el-button",{attrs:{type:"primary"},on:{click:e.submitFollowForm}},[e._v("确 定")]):e._e()],1)],1),t("el-dialog",{attrs:{title:"跟进记录",visible:e.followListDialogVisible,width:"900px","append-to-body":""},on:{"update:visible":function(t){e.followListDialogVisible=t}}},[t("div",{staticClass:"follow-list-header"},[t("div",{staticClass:"title"},[t("span",[e._v("跟进列表")]),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAddFollow}},[e._v("新增跟进")])],1),t("div",{staticClass:"search-container"},[t("el-form",{staticClass:"search-form",attrs:{inline:!0,model:e.followQueryParams}},[t("el-form-item",[t("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.followQueryParams.dateRange,callback:function(t){e.$set(e.followQueryParams,"dateRange",t)},expression:"followQueryParams.dateRange"}})],1),t("el-form-item",[t("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"跟进方式",clearable:""},model:{value:e.followQueryParams.followType,callback:function(t){e.$set(e.followQueryParams,"followType",t)},expression:"followQueryParams.followType"}},[t("el-option",{attrs:{label:"电话",value:"电话"}}),t("el-option",{attrs:{label:"邮件",value:"邮件"}}),t("el-option",{attrs:{label:"微信",value:"微信"}}),t("el-option",{attrs:{label:"面谈",value:"面谈"}}),t("el-option",{attrs:{label:"视频会议",value:"视频会议"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.getFollowupList}},[e._v("查询")]),t("el-button",{attrs:{plain:"",icon:"el-icon-refresh"},on:{click:e.resetFollowQuery}},[e._v("重置")])],1)],1)],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.followLoading,expression:"followLoading"}],staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.followupList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),t("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t("el-table-column",{attrs:{label:"跟进方式",prop:"followType",align:"center",width:"100"}}),t("el-table-column",{attrs:{label:"跟进时间",prop:"followTime",align:"center",width:"150"}}),t("el-table-column",{attrs:{label:"商机名称",prop:"opportunityName",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(l){return[l.row.opportunityName?t("span",[e._v(e._s(l.row.opportunityName))]):t("span",{staticClass:"gray-text"},[e._v("无关联商机")])]}}])}),t("el-table-column",{attrs:{label:"跟进内容",prop:"content","show-overflow-tooltip":"","min-width":"200",align:"center"}}),t("el-table-column",{attrs:{label:"下次跟进时间",prop:"nextFollowTime",align:"center",width:"150"}}),t("el-table-column",{attrs:{label:"跟进人",prop:"followUser",align:"center",width:"100"}}),t("el-table-column",{attrs:{label:"备注",prop:"remark",align:"center","show-overflow-tooltip":"","min-width":"120"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handleViewFollow(l.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-edit"},on:{click:function(t){return e.handleEditFollow(l.row)}}},[e._v("修改")]),t("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(t){return e.handleDeleteFollow(l.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"","current-page":e.followPageNum,"page-sizes":[10,20,30,50],"page-size":e.followPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.followTotal},on:{"size-change":e.handleFollowSizeChange,"current-change":e.handleFollowCurrentChange}})],1)],1)],1)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-title"},[t("span",[e._v("商机列表")])])}],r=(l("e9f5"),l("d866"),l("910d"),l("f665"),l("7d54"),l("ab43"),l("c4b3")),s={name:"OpportunityList",components:{ColumnFilter:r["a"]},data(){return{loading:!1,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,opportunityList:[{id:1,opportunityName:"发明专利申请代理",customerName:"四川大学",opportunityType:"专利申请",caseType:"发明专利",status:"方案制定",expectedAmount:"25000",expectedSigningDate:"2024-06-30",principal:"李明",followUpMethod:"电话",followUpLocation:"办公室",followUpContact:"张教授",contactPhone:"13912345678",followUpContent:"与客户沟通专利申请方案细节，客户对方案基本满意，需要进一步完善",nextFollowUpTime:"2024-06-05 10:00",followUpCount:3,lastFollowUpDate:"2024-05-25",createDate:"2024-05-15",updateTime:"2024-05-26",updater:"张华",background:"客户有多项技术创新需要申请专利保护",isContract:!1,remark:"客户需求明确，正在准备方案",opportunityNumber:"BIZ20240515001",department:"专利部",creator:"张三"},{id:2,opportunityName:"商标注册代理",customerName:"成都某某科技有限公司",opportunityType:"商标注册",caseType:"商标",status:"商务谈判",expectedAmount:"12000",expectedSigningDate:"2024-06-15",principal:"张华",followUpMethod:"上门拜访",followUpLocation:"客户公司",followUpContact:"李总监",contactPhone:"13887654321",followUpContent:"与客户商谈商标注册事宜，客户对价格有疑问",nextFollowUpTime:"2024-06-10 14:00",followUpCount:5,lastFollowUpDate:"2024-05-28",createDate:"2024-05-10",updateTime:"2024-05-28",updater:"王敏",background:"客户新产品线需要注册商标",isContract:!1,remark:"价格有分歧，需进一步协商",opportunityNumber:"BIZ20240510001",department:"商标部",creator:"李四"},{id:3,opportunityName:"软件著作权登记",customerName:"中科院成都分院",opportunityType:"著作权登记",caseType:"软著",status:"初期沟通",expectedAmount:"5000",expectedSigningDate:"2024-07-10",principal:"王敏",followUpMethod:"邮件",followUpLocation:"线上",followUpContact:"王教授",contactPhone:"13765432109",followUpContent:"向客户发送著作权登记流程和所需材料清单",nextFollowUpTime:"2024-06-01 11:00",followUpCount:1,lastFollowUpDate:"2024-05-22",createDate:"2024-05-20",updateTime:"2024-05-22",updater:"李明",background:"客户开发了新软件系统需要保护知识产权",isContract:!1,remark:"初步接触，了解需求阶段",opportunityNumber:"BIZ20240520001",department:"版权部",creator:"王五"},{id:4,opportunityName:"实用新型专利申请",customerName:"电子科技大学",opportunityType:"专利申请",caseType:"实用新型",status:"需求确认",expectedAmount:"15000",expectedSigningDate:"2024-06-20",principal:"李明",followUpMethod:"视频会议",followUpLocation:"线上",followUpContact:"陈教授",contactPhone:"13612345678",followUpContent:"与客户确认专利技术点和保护范围",nextFollowUpTime:"2024-06-03 09:30",followUpCount:2,lastFollowUpDate:"2024-05-26",createDate:"2024-05-18",updateTime:"2024-05-26",updater:"李明",background:"实验室研发的新型电子元件需要申请专利",isContract:!1,remark:"已确认基本需求，待确认细节",opportunityNumber:"BIZ20240518001",department:"专利部",creator:"赵六"},{id:5,opportunityName:"专利检索分析",customerName:"成都理工大学",opportunityType:"专利分析",caseType:"检索分析",status:"已成交",expectedAmount:"20000",expectedSigningDate:"2024-05-15",principal:"王敏",followUpMethod:"上门拜访",followUpLocation:"客户办公室",followUpContact:"赵教授",contactPhone:"13998765432",followUpContent:"与客户确认专利检索分析报告交付事宜",nextFollowUpTime:"",followUpCount:6,lastFollowUpDate:"2024-05-15",createDate:"2024-04-25",updateTime:"2024-05-16",updater:"张华",background:"需要对行业专利状况进行分析以指导研发方向",isContract:!0,remark:"已签约并完成，客户满意",opportunityNumber:"BIZ20240425001",department:"专利部",creator:"张三"},{id:6,opportunityName:"海外专利布局咨询",customerName:"成都某某科技有限公司",opportunityType:"专利咨询",caseType:"专利布局",status:"已失败",expectedAmount:"50000",expectedSigningDate:"2024-05-30",principal:"张华",followUpMethod:"商务洽谈",followUpLocation:"商务中心",followUpContact:"李总监",contactPhone:"13887654321",followUpContent:"与客户沟通海外专利布局方案，因预算问题暂停",nextFollowUpTime:"",followUpCount:4,lastFollowUpDate:"2024-05-20",createDate:"2024-04-15",updateTime:"2024-05-20",updater:"张华",background:"客户计划进军国际市场，需要海外专利保护",isContract:!1,remark:"客户预算不足，暂时搁置",opportunityNumber:"BIZ20240415001",department:"法务部",creator:"李四"}],availableColumns:[{prop:"index",label:"序号"},{prop:"opportunityName",label:"商机名称"},{prop:"customerName",label:"客户名称"},{prop:"caseType",label:"项目类型"},{prop:"opportunityType",label:"商机类型"},{prop:"status",label:"商机状态"},{prop:"expectedAmount",label:"预计代理费"},{prop:"expectedSigningDate",label:"预计签约时间"},{prop:"opportunityNumber",label:"商机编号"},{prop:"updater",label:"更新人"},{prop:"updateTime",label:"更新时间"},{prop:"isContract",label:"是否转合同"},{prop:"background",label:"商机背景"},{prop:"principal",label:"负责人"},{prop:"followUpCount",label:"跟进次数"},{prop:"lastFollowUpDate",label:"最后跟进时间"},{prop:"createDate",label:"创建时间"},{prop:"remark",label:"备注"}],defaultSelectedColumns:["index","opportunityName","caseType","expectedAmount","expectedSigningDate","opportunityType","status","background","opportunityNumber","updater","updateTime","isContract"],visibleColumns:{index:!0,opportunityName:!0,customerName:!0,caseType:!0,opportunityType:!0,status:!0,expectedAmount:!0,expectedSigningDate:!0,opportunityNumber:!0,updater:!0,updateTime:!0,isContract:!0,background:!0,principal:!0,followUpCount:!0,lastFollowUpDate:!0,createDate:!0,remark:!0},queryParams:{pageNum:1,pageSize:10,customerName:"",opportunityName:"",caseType:"",estimatedCostMin:"",estimatedCostMax:"",expectedSigningStartDate:"",expectedSigningEndDate:"",opportunityType:"",updater:"",updateStartDate:"",updateEndDate:"",department:"",creator:"",createStartDate:"",createEndDate:"",businessPerson:"",status:"",opportunityNumber:"",isContract:""},followUpHistory:[],followUpVisible:!1,isView:!1,form:{id:null,opportunityName:"",customerName:"",opportunityType:"",caseType:"",status:"初期沟通",expectedAmount:"",expectedSigningDate:"",principal:"",followUpMethod:"",followUpLocation:"",followUpContact:"",contactPhone:"",followUpContent:"",nextFollowUpTime:"",background:"",isContract:!1,remark:"",updater:"",updateTime:"",opportunityNumber:""},rules:{opportunityName:[{required:!0,message:"请输入商机名称",trigger:"blur"}],customerName:[{required:!0,message:"请输入客户名称",trigger:"blur"}],opportunityType:[{required:!0,message:"请选择商机类型",trigger:"change"}],caseType:[{required:!0,message:"请选择项目类型",trigger:"change"}],status:[{required:!0,message:"请选择商机状态",trigger:"change"}],principal:[{required:!0,message:"请选择负责人",trigger:"change"}]},title:"",open:!1,followDialogVisible:!1,followDialogStatus:"",followDialogTitle:"",followForm:{id:void 0,followType:"",followTime:"",opportunityId:void 0,opportunityName:"",content:"",nextFollowTime:"",nextContent:"",remark:""},followFormRules:{followType:[{required:!0,message:"请选择跟进方式",trigger:"change"}],followTime:[{required:!0,message:"请选择跟进时间",trigger:"change"}],content:[{required:!0,message:"请输入跟进内容",trigger:"blur"}]},followListDialogVisible:!1,followLoading:!1,followupList:[],followPageNum:1,followPageSize:10,followTotal:0,followQueryParams:{dateRange:[],followType:"",opportunityId:void 0},opportunityOptions:[{id:1,name:"专利申请服务"},{id:2,name:"商标注册服务"},{id:3,name:"软件著作权登记"}],currentOpportunity:null}},created(){this.getList(),this.initVisibleColumns()},methods:{initVisibleColumns(){const e={};this.availableColumns.forEach(t=>{e[t.prop]=this.defaultSelectedColumns.includes(t.prop)}),this.visibleColumns=e},updateVisibleColumns(e){this.visibleColumns=e},getStatusType(e){const t={"初期沟通":"info","需求确认":"warning","方案制定":"warning","商务谈判":"warning","合同签署":"primary","已成交":"success","已失败":"danger"};return t[e]||"info"},getTimelineType(e){const t=["primary","success","warning","danger","info"];return t[e%t.length]},getList(){this.loading=!0,setTimeout(()=>{const e=this.opportunityList.filter(e=>!(this.queryParams.customerName&&!e.customerName.includes(this.queryParams.customerName))&&(!(this.queryParams.opportunityName&&!e.opportunityName.includes(this.queryParams.opportunityName))&&((!this.queryParams.caseType||e.caseType===this.queryParams.caseType)&&(!(this.queryParams.estimatedCostMin&&parseFloat(e.expectedAmount)<parseFloat(this.queryParams.estimatedCostMin))&&(!(this.queryParams.estimatedCostMax&&parseFloat(e.expectedAmount)>parseFloat(this.queryParams.estimatedCostMax))&&(!(this.queryParams.expectedSigningStartDate&&new Date(e.expectedSigningDate)<new Date(this.queryParams.expectedSigningStartDate))&&(!(this.queryParams.expectedSigningEndDate&&new Date(e.expectedSigningDate)>new Date(this.queryParams.expectedSigningEndDate))&&((!this.queryParams.opportunityType||e.opportunityType===this.queryParams.opportunityType)&&((!this.queryParams.updater||e.updater===this.queryParams.updater)&&(!(this.queryParams.updateStartDate&&new Date(e.updateTime)<new Date(this.queryParams.updateStartDate))&&(!(this.queryParams.updateEndDate&&new Date(e.updateTime)>new Date(this.queryParams.updateEndDate))&&((!this.queryParams.department||e.department===this.queryParams.department)&&((!this.queryParams.creator||e.creator===this.queryParams.creator)&&(!(this.queryParams.createStartDate&&new Date(e.createDate)<new Date(this.queryParams.createStartDate))&&(!(this.queryParams.createEndDate&&new Date(e.createDate)>new Date(this.queryParams.createEndDate))&&((!this.queryParams.businessPerson||e.principal===this.queryParams.businessPerson)&&((!this.queryParams.status||e.status===this.queryParams.status)&&(!(this.queryParams.opportunityNumber&&!e.opportunityNumber.includes(this.queryParams.opportunityNumber))&&(!this.queryParams.isContract||e.isContract.toString()===this.queryParams.isContract)))))))))))))))))));this.total=e.length;const t=(this.queryParams.pageNum-1)*this.queryParams.pageSize,l=t+this.queryParams.pageSize;if(this.loading=!1,Object.values(this.queryParams).every(e=>!e||"string"===typeof e&&!e.trim()||"number"===typeof e&&0===e)){const e=[...this.opportunityList];this.opportunityList=e.slice(t,l)}else this.opportunityList=e.slice(t,l)},500)},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.queryParams={pageNum:1,pageSize:10,customerName:"",opportunityName:"",caseType:"",estimatedCostMin:"",estimatedCostMax:"",expectedSigningStartDate:"",expectedSigningEndDate:"",opportunityType:"",updater:"",updateStartDate:"",updateEndDate:"",department:"",creator:"",createStartDate:"",createEndDate:"",businessPerson:"",status:"",opportunityNumber:"",isContract:""},this.handleQuery()},exportData(){this.$message({message:"正在导出数据，请稍候...",type:"info"}),setTimeout(()=>{this.$message({message:"导出成功",type:"success"})},1500)},handleAdd(){this.reset(),this.title="新增商机",this.isView=!1,this.open=!0},handleView(e){this.reset(),this.form=JSON.parse(JSON.stringify(e)),this.title="查看商机详情",this.isView=!0,this.open=!0},handleEdit(e){this.reset(),this.form=JSON.parse(JSON.stringify(e)),this.title="编辑商机",this.isView=!1,this.open=!0},handleFollowUpEdit(e){this.currentOpportunity=e,this.followListDialogVisible=!0,this.getFollowupList()},getFollowUpHistory(e){this.followUpHistory=[{id:1,followUpDate:"2024-05-25 14:30",followUpMethod:"电话",followUpType:"方案制定",followUpContent:"客户基本满意我们的方案，但希望能够增加专利文本的编辑服务",followUpContact:"张教授",followUpSatisfaction:4,nextFollowUpTime:"2024-06-05 10:00",nextFollowUpContent:"提供修改后的方案和报价"},{id:2,followUpDate:"2024-05-15 09:30",followUpMethod:"邮件",followUpType:"需求确认",followUpContent:"向客户发送了初步的服务方案和报价，对方表示需要时间评估",followUpContact:"张教授",followUpSatisfaction:3,nextFollowUpTime:"2024-05-25 14:00",nextFollowUpContent:"电话沟通方案细节"},{id:3,followUpDate:"2024-05-10 15:00",followUpMethod:"拜访",followUpType:"初次沟通",followUpContent:"与客户进行了初步沟通，了解到他们需要为一项新技术申请发明专利，需要专业代理服务",followUpContact:"张教授",followUpSatisfaction:5,nextFollowUpTime:"2024-05-15 09:00",nextFollowUpContent:"发送服务方案和报价"}]},handleDelete(e){this.$confirm('是否确认删除商机"'+e.opportunityName+'"?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.opportunityList.findIndex(t=>t.id===e.id);-1!==t&&this.opportunityList.splice(t,1),this.$message.success("删除成功"),this.getList()}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},reset(){this.form={id:null,opportunityName:"",customerName:"",opportunityType:"",caseType:"",status:"初期沟通",expectedAmount:"",expectedSigningDate:"",principal:"",followUpMethod:"",followUpLocation:"",followUpContact:"",contactPhone:"",followUpContent:"",nextFollowUpTime:"",background:"",isContract:!1,remark:"",updater:"",updateTime:"",opportunityNumber:""},this.resetForm("form")},resetForm(e){this.$refs[e]&&this.$refs[e].resetFields()},cancel(){this.open=!1,this.reset()},submitForm(){this.$refs.form.validate(e=>{if(e){if(null!==this.form.id){const e=this.opportunityList.findIndex(e=>e.id===this.form.id);-1!==e&&(this.form.updateTime=(new Date).toISOString().slice(0,10),this.opportunityList[e]={...this.opportunityList[e],...this.form}),this.$message.success("修改成功")}else{const e=Math.max(...this.opportunityList.map(e=>e.id))+1;this.form.id=e,this.form.createDate=(new Date).toISOString().slice(0,10),this.form.updateTime=(new Date).toISOString().slice(0,10),this.form.updater="当前用户",this.form.opportunityNumber="BIZ"+(new Date).toISOString().slice(0,10).replace(/-/g,"")+String(e).padStart(3,"0"),this.form.followUpCount=1,this.form.lastFollowUpDate=(new Date).toISOString().slice(0,10),this.opportunityList.unshift(this.form),this.$message.success("新增成功")}this.open=!1,this.getList()}})},handleSelectionChange(e){this.ids=e.map(e=>e.id),this.single=1!==e.length,this.multiple=!e.length},handleSizeChange(e){this.queryParams.pageSize=e,this.getList()},handleCurrentChange(e){this.queryParams.pageNum=e,this.getList()},getFollowupList(){this.followLoading=!0,setTimeout(()=>{let e=[{id:1,followType:"电话",followTime:"2024-04-26 14:30:00",opportunityId:1,opportunityName:"专利申请服务",content:"客户表示对我们的专利服务很感兴趣，希望能够进一步了解具体的方案和价格。",nextFollowTime:"2024-05-01 10:00:00",nextContent:"提供详细的专利申请方案",followUser:"张三",remark:"客户态度积极"},{id:2,followType:"邮件",followTime:"2024-04-20 09:15:00",opportunityId:2,opportunityName:"商标注册服务",content:"已发送产品介绍邮件，包含商标注册流程和成功案例。",nextFollowTime:"2024-04-27 09:00:00",nextContent:"电话确认客户是否收到邮件",followUser:"李四",remark:"需要跟进确认客户是否收到邮件"},{id:3,followType:"面谈",followTime:"2024-04-15 15:00:00",opportunityId:null,opportunityName:"",content:"与客户进行了面对面会议，讨论了知识产权保护方案。",nextFollowTime:"2024-04-22 14:00:00",nextContent:"提供详细的报价方案",followUser:"王五",remark:"直接跟进客户，未关联商机"}];if(this.followQueryParams.followType&&(e=e.filter(e=>e.followType===this.followQueryParams.followType)),this.followQueryParams.dateRange&&2===this.followQueryParams.dateRange.length){const t=new Date(this.followQueryParams.dateRange[0]),l=new Date(this.followQueryParams.dateRange[1]);l.setHours(23,59,59,999),e=e.filter(e=>{const o=new Date(e.followTime);return o>=t&&o<=l})}if(this.currentOpportunity&&this.currentOpportunity.id){const t=this.currentOpportunity.id;this.followQueryParams.opportunityId=t,e=e.filter(e=>e.opportunityId===t)}this.followupList=e,this.followTotal=e.length,this.followLoading=!1},500)},resetFollowQuery(){this.followQueryParams={dateRange:[],followType:"",opportunityId:this.currentOpportunity?this.currentOpportunity.id:void 0},this.getFollowupList()},handleAddFollow(){this.followForm={id:void 0,followType:"",followTime:this.formatDate(new Date),opportunityId:this.currentOpportunity?this.currentOpportunity.id:void 0,opportunityName:this.currentOpportunity?this.currentOpportunity.name:"",content:"",nextFollowTime:"",nextContent:"",remark:""},this.followDialogStatus="add",this.followDialogTitle="新增跟进",this.followDialogVisible=!0,this.$nextTick(()=>{this.$refs.followupFormRef.clearValidate()})},handleViewFollow(e){this.followForm=JSON.parse(JSON.stringify(e)),this.followDialogStatus="view",this.followDialogTitle="查看跟进",this.followDialogVisible=!0},handleEditFollow(e){this.followForm=JSON.parse(JSON.stringify(e)),this.followDialogStatus="edit",this.followDialogTitle="编辑跟进",this.followDialogVisible=!0,this.$nextTick(()=>{this.$refs.followupFormRef.clearValidate()})},handleDeleteFollow(e){this.$confirm("确认删除该跟进记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.followupList.findIndex(t=>t.id===e.id);-1!==t&&(this.followupList.splice(t,1),this.followTotal=this.followupList.length),this.$message({type:"success",message:"删除成功"})}).catch(()=>{})},submitFollowForm(){this.$refs.followupFormRef.validate(e=>{if(e){if(this.followForm.opportunityId){const e=this.opportunityOptions.find(e=>e.id===this.followForm.opportunityId);e&&(this.followForm.opportunityName=e.name)}else this.followForm.opportunityName="";if("add"===this.followDialogStatus){const e=this.followupList.length>0?Math.max(...this.followupList.map(e=>e.id))+1:1;this.followForm.id=e,this.followForm.followUser="当前用户",this.followupList.unshift(this.followForm),this.followTotal=this.followupList.length,this.$message.success("添加成功")}else if("edit"===this.followDialogStatus){const e=this.followupList.findIndex(e=>e.id===this.followForm.id);-1!==e&&(this.followupList[e]={...this.followForm}),this.$message.success("修改成功")}this.followDialogVisible=!1}})},formatDate(e){const t=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0"),s=String(e.getSeconds()).padStart(2,"0");return`${t}-${l}-${o} ${a}:${r}:${s}`},handleFollowSizeChange(e){this.followPageSize=e,this.getFollowupList()},handleFollowCurrentChange(e){this.followPageNum=e,this.getFollowupList()}}},i=s,n=(l("3b9c"),l("2877")),p=Object(n["a"])(i,o,a,!1,null,null,null);t["default"]=p.exports},c4b3:function(e,t,l){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"column-filter"},[t("el-button",{attrs:{type:e.buttonType,size:e.buttonSize,icon:e.buttonIcon},on:{click:e.showDialog}},[e._v(" "+e._s(e.buttonText)+" ")]),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"column-filter-container"},[t("el-checkbox",{on:{change:e.handleSelectAllChange},model:{value:e.selectAllColumns,callback:function(t){e.selectAllColumns=t},expression:"selectAllColumns"}},[e._v("全选")]),t("el-divider"),t("el-checkbox-group",{on:{change:e.handleColumnChange},model:{value:e.selectedColumns,callback:function(t){e.selectedColumns=t},expression:"selectedColumns"}},[t("el-row",{attrs:{gutter:10}},e._l(e.availableColumns,(function(l){return t("el-col",{key:l.prop,attrs:{span:8}},[t("el-checkbox",{attrs:{label:l.prop}},[e._v(e._s(l.label))])],1)})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.resetColumns}},[e._v("重置")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveColumnSettings}},[e._v("确 定")])],1)])],1)},a=[],r=(l("e9f5"),l("7d54"),l("ab43"),{name:"ColumnFilter",props:{storageKey:{type:String,required:!0},columns:{type:Array,required:!0},defaultSelected:{type:Array,required:!0},buttonType:{type:String,default:"primary"},buttonSize:{type:String,default:"small"},buttonIcon:{type:String,default:"el-icon-s-operation"},buttonText:{type:String,default:"列筛选"},dialogTitle:{type:String,default:"列筛选设置"}},data(){return{dialogVisible:!1,selectedColumns:[...this.defaultSelected],selectAllColumns:!1,visibleColumns:{}}},computed:{availableColumns(){return this.columns}},created(){this.loadColumnSettings()},methods:{showDialog(){this.dialogVisible=!0},handleSelectAllChange(e){this.selectedColumns=e?this.availableColumns.map(e=>e.prop):[],this.updateVisibleColumns()},handleColumnChange(){this.selectAllColumns=this.selectedColumns.length===this.availableColumns.length,this.updateVisibleColumns()},updateVisibleColumns(){const e={};this.availableColumns.forEach(t=>{e[t.prop]=!1}),this.selectedColumns.forEach(t=>{e[t]=!0}),this.visibleColumns=e,this.$emit("update:visible-columns",{...e})},saveColumnSettings(){try{localStorage.setItem(this.storageKey+"Columns",JSON.stringify(this.selectedColumns)),localStorage.setItem(this.storageKey+"VisibleColumns",JSON.stringify(this.visibleColumns)),this.dialogVisible=!1,this.$message.success("列设置已保存"),this.$emit("update:visible-columns",{...this.visibleColumns})}catch(e){console.error("保存列设置失败",e),this.$message.error("保存列设置失败")}},loadColumnSettings(){try{const e=localStorage.getItem(this.storageKey+"Columns"),t=localStorage.getItem(this.storageKey+"VisibleColumns");e?(this.selectedColumns=JSON.parse(e),this.selectAllColumns=this.selectedColumns.length===this.availableColumns.length):(this.selectedColumns=[...this.defaultSelected],this.selectAllColumns=this.selectedColumns.length===this.availableColumns.length),t?this.visibleColumns=JSON.parse(t):this.updateVisibleColumns(),this.$emit("update:visible-columns",{...this.visibleColumns})}catch(e){console.error("加载列设置失败",e),this.resetColumns()}},resetColumns(){this.selectedColumns=[...this.defaultSelected],this.selectAllColumns=this.selectedColumns.length===this.availableColumns.length,this.updateVisibleColumns()}}}),s=r,i=(l("ec91"),l("2877")),n=Object(i["a"])(s,o,a,!1,null,null,null);t["a"]=n.exports},ec91:function(e,t,l){"use strict";l("3741")}}]);