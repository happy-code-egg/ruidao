(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3dda5f81"],{"13d5":function(t,e,a){"use strict";var l=a("23e7"),s=a("d58f").left,i=a("a640"),o=a("1212"),n=a("9adc"),r=!n&&o>79&&o<83,c=r||!i("reduce");l({target:"Array",proto:!0,forced:c},{reduce:function(t){var e=arguments.length;return s(this,t,e,e>1?arguments[1]:void 0)}})},"6e3d":function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"invoice-query-container"},[e("div",{staticClass:"body-part-search"},[e("el-form",{attrs:{model:t.searchForm,"label-width":"100px"}},[e("el-row",[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"申请单号"}},[e("el-input",{attrs:{size:"small",placeholder:"请输入申请单号"},model:{value:t.searchForm.applicationNo,callback:function(e){t.$set(t.searchForm,"applicationNo",e)},expression:"searchForm.applicationNo"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"申请人"}},[e("el-input",{attrs:{size:"small",placeholder:"请输入申请人"},model:{value:t.searchForm.applicant,callback:function(e){t.$set(t.searchForm,"applicant",e)},expression:"searchForm.applicant"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"客户名称"}},[e("el-input",{attrs:{size:"small",placeholder:"请输入客户名称"},model:{value:t.searchForm.clientName,callback:function(e){t.$set(t.searchForm,"clientName",e)},expression:"searchForm.clientName"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"合同名称"}},[e("el-input",{attrs:{size:"small",placeholder:"请输入合同名称"},model:{value:t.searchForm.contractName,callback:function(e){t.$set(t.searchForm,"contractName",e)},expression:"searchForm.contractName"}})],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"发票类型"}},[e("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:t.searchForm.invoiceType,callback:function(e){t.$set(t.searchForm,"invoiceType",e)},expression:"searchForm.invoiceType"}},[e("el-option",{attrs:{label:"增值税专用发票",value:"special"}}),e("el-option",{attrs:{label:"增值税普通发票",value:"general"}}),e("el-option",{attrs:{label:"电子发票",value:"electronic"}})],1)],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"所属部门"}},[e("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:t.searchForm.department,callback:function(e){t.$set(t.searchForm,"department",e)},expression:"searchForm.department"}},[e("el-option",{attrs:{label:"信息与商务管理学院",value:"info_management"}}),e("el-option",{attrs:{label:"财务部",value:"finance"}}),e("el-option",{attrs:{label:"商务部",value:"business"}}),e("el-option",{attrs:{label:"技术部",value:"technology"}})],1)],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"流程状态"}},[e("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:t.searchForm.flowStatus,callback:function(e){t.$set(t.searchForm,"flowStatus",e)},expression:"searchForm.flowStatus"}},[e("el-option",{attrs:{label:"草稿",value:"draft"}}),e("el-option",{attrs:{label:"审核中",value:"reviewing"}}),e("el-option",{attrs:{label:"已通过",value:"approved"}}),e("el-option",{attrs:{label:"已退回",value:"returned"}}),e("el-option",{attrs:{label:"已完成",value:"completed"}})],1)],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"开票金额"}},[e("el-input-number",{staticStyle:{width:"45%"},attrs:{size:"small",placeholder:"最小值"},model:{value:t.searchForm.amountMin,callback:function(e){t.$set(t.searchForm,"amountMin",e)},expression:"searchForm.amountMin"}}),e("span",{staticStyle:{margin:"0 5px"}},[t._v("至")]),e("el-input-number",{staticStyle:{width:"45%"},attrs:{size:"small",placeholder:"最大值"},model:{value:t.searchForm.amountMax,callback:function(e){t.$set(t.searchForm,"amountMax",e)},expression:"searchForm.amountMax"}})],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"申请时间"}},[e("el-date-picker",{attrs:{size:"small",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.searchForm.applicationDate,callback:function(e){t.$set(t.searchForm,"applicationDate",e)},expression:"searchForm.applicationDate"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"客户范围"}},[e("el-select",{attrs:{size:"small",placeholder:"请选择客户",multiple:"","collapse-tags":""},model:{value:t.searchForm.clientScope,callback:function(e){t.$set(t.searchForm,"clientScope",e)},expression:"searchForm.clientScope"}},t._l(t.clientOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"合同范围"}},[e("el-select",{attrs:{size:"small",placeholder:"请选择合同",multiple:"","collapse-tags":""},model:{value:t.searchForm.contractScope,callback:function(e){t.$set(t.searchForm,"contractScope",e)},expression:"searchForm.contractScope"}},t._l(t.contractOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1)],1)],1),e("div",{staticClass:"part-search-buttons"},[e("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleSearch}},[t._v("查询")]),e("el-button",{attrs:{size:"small"},on:{click:t.handleReset}},[t._v("重置")]),e("el-button",{attrs:{size:"small",type:"success"},on:{click:t.handleExport}},[t._v("导出")])],1)],1),e("div",{staticClass:"body-part-content"},[t._m(0),e("div",{staticClass:"statistics-panel"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:4}},[e("div",{staticClass:"stat-item total"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-document"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("合同总额")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t._f("currency")(t.statistics.contractTotal)))])])])]),e("el-col",{attrs:{span:4}},[e("div",{staticClass:"stat-item payment"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-money"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("实际到款总额")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t._f("currency")(t.statistics.actualPaymentTotal)))])])])]),e("el-col",{attrs:{span:4}},[e("div",{staticClass:"stat-item invoiced"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-tickets"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("已开票总额")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t._f("currency")(t.statistics.invoicedTotal)))])])])]),e("el-col",{attrs:{span:4}},[e("div",{staticClass:"stat-item uninvoiced"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-warning"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("未开票金额")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t._f("currency")(t.statistics.uninvoicedAmount)))])])])]),e("el-col",{attrs:{span:4}},[e("div",{staticClass:"stat-item rate"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-pie-chart"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("开票完成率")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t.invoiceCompletionRate)+"%")])])])]),e("el-col",{attrs:{span:4}},[e("div",{staticClass:"stat-item count"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-files"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("申请单数量")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t.statistics.applicationCount)+"单")])])])])],1)],1),e("div",{staticClass:"detail-section"},[e("h3",[t._v("申请明细列表")]),e("el-table",{staticStyle:{width:"100%"},attrs:{size:"small",data:t.tableData,border:"","show-summary":"","summary-method":t.getSummaries}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),e("el-table-column",{attrs:{prop:"applicationNo",label:"申请单号","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"applicant",label:"申请人","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"department",label:"所属部门","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"contractName",label:"合同名称","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"contractNo",label:"合同编号","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"clientName",label:"客户名称",width:"140","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"contractAmount",label:"合同金额",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("currency")(a.row.contractAmount)))])]}}])}),e("el-table-column",{attrs:{prop:"actualPayment",label:"实际到款",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("currency")(a.row.actualPayment)))])]}}])}),e("el-table-column",{attrs:{prop:"invoiceAmount",label:"开票金额",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("currency")(a.row.invoiceAmount)))])]}}])}),e("el-table-column",{attrs:{prop:"uninvoicedAmount",label:"未开票金额",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{class:{"text-danger":a.row.uninvoicedAmount>0}},[t._v(t._s(t._f("currency")(a.row.uninvoicedAmount)))])]}}])}),e("el-table-column",{attrs:{prop:"invoiceType",label:"发票类型",width:"120","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"applicationDate",label:"申请时间",width:"120","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"flowStatus",label:"流程状态",width:"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getStatusType(a.row.flowStatus),size:"small"}},[t._v(t._s(a.row.flowStatus))])]}}])}),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"small",type:"text"},on:{click:function(e){return t.handleView(a.row)}}},[t._v("查看")]),"草稿"===a.row.flowStatus?e("el-button",{attrs:{size:"small",type:"text"},on:{click:function(e){return t.handleEdit(a.row)}}},[t._v("编辑")]):t._e(),"已完成"===a.row.flowStatus?e("el-button",{attrs:{size:"small",type:"text"},on:{click:function(e){return t.handlePrint(a.row)}}},[t._v("打印")]):t._e()]}}])})],1),e("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,50],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),e("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"80%",top:"5vh"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"detail-content"},[e("el-descriptions",{attrs:{column:3,border:""}},[e("el-descriptions-item",{attrs:{label:"申请单号"}},[t._v(t._s(t.viewData.applicationNo))]),e("el-descriptions-item",{attrs:{label:"申请人"}},[t._v(t._s(t.viewData.applicant))]),e("el-descriptions-item",{attrs:{label:"所属部门"}},[t._v(t._s(t.viewData.department))]),e("el-descriptions-item",{attrs:{label:"合同名称"}},[t._v(t._s(t.viewData.contractName))]),e("el-descriptions-item",{attrs:{label:"合同编号"}},[t._v(t._s(t.viewData.contractNo))]),e("el-descriptions-item",{attrs:{label:"客户名称"}},[t._v(t._s(t.viewData.clientName))]),e("el-descriptions-item",{attrs:{label:"合同金额"}},[t._v(t._s(t._f("currency")(t.viewData.contractAmount)))]),e("el-descriptions-item",{attrs:{label:"实际到款"}},[t._v(t._s(t._f("currency")(t.viewData.actualPayment)))]),e("el-descriptions-item",{attrs:{label:"开票金额"}},[t._v(t._s(t._f("currency")(t.viewData.invoiceAmount)))]),e("el-descriptions-item",{attrs:{label:"发票类型"}},[t._v(t._s(t.viewData.invoiceType))]),e("el-descriptions-item",{attrs:{label:"申请时间"}},[t._v(t._s(t.viewData.applicationDate))]),e("el-descriptions-item",{attrs:{label:"流程状态"}},[e("el-tag",{attrs:{type:t.getStatusType(t.viewData.flowStatus),size:"small"}},[t._v(t._s(t.viewData.flowStatus))])],1)],1),t.viewData.items&&t.viewData.items.length?e("div",{staticClass:"invoice-items-detail"},[e("h4",[t._v("开票明细")]),e("el-table",{attrs:{data:t.viewData.items,border:"",size:"small"}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),e("el-table-column",{attrs:{prop:"itemName",label:"开票项目"}}),e("el-table-column",{attrs:{prop:"specification",label:"规格型号"}}),e("el-table-column",{attrs:{prop:"unit",label:"计量单位",width:"100"}}),e("el-table-column",{attrs:{prop:"quantity",label:"数量",width:"80"}}),e("el-table-column",{attrs:{prop:"unitPrice",label:"单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("currency")(a.row.unitPrice)))])]}}],null,!1,225679315)}),e("el-table-column",{attrs:{prop:"amount",label:"金额",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("currency")(a.row.amount)))])]}}],null,!1,2455502996)})],1)],1):t._e()],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")])],1)])],1)},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"part-table-header"},[e("div",{staticClass:"part-table-title"},[t._v(" 发票查询统计 ")])])}],i=(a("14d9"),a("13d5"),a("e9f5"),a("d866"),a("7d54"),a("ab43"),a("9485"),{name:"InvoiceQuery",data(){return{searchForm:{applicationNo:"",applicant:"",clientName:"",contractName:"",invoiceType:"",department:"",flowStatus:"",amountMin:"",amountMax:"",applicationDate:"",clientScope:[],contractScope:[]},tableData:[],currentPage:1,pageSize:20,total:0,dialogVisible:!1,dialogTitle:"申请详情",viewData:{},statistics:{contractTotal:0,actualPaymentTotal:0,invoicedTotal:0,uninvoicedAmount:0,applicationCount:0},clientOptions:[{value:"client1",label:"科技公司A"},{value:"client2",label:"制造企业B"},{value:"client3",label:"贸易公司C"},{value:"client4",label:"服务企业D"}],contractOptions:[{value:"contract1",label:"技术服务合同001"},{value:"contract2",label:"软件开发合同002"},{value:"contract3",label:"系统维护合同003"},{value:"contract4",label:"设备采购合同004"}]}},computed:{invoiceCompletionRate(){return 0===this.statistics.contractTotal?0:Math.round(this.statistics.invoicedTotal/this.statistics.contractTotal*100)}},filters:{currency(t){return t?"¥"+parseFloat(t).toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}):"¥0.00"}},created(){this.getList(),this.getStatistics()},methods:{getList(){this.tableData=Array.from({length:20}).map((t,e)=>{const a=1e5+2e4*e,l=a*(.6+.4*Math.random()),s=l*(.5+.5*Math.random());return{id:e+1,applicationNo:"FPSP"+(2025e3+e),applicant:"申请人"+(e+1),department:["信息与商务管理学院","财务部","商务部","技术部"][e%4],contractName:`${["技术服务","软件开发","系统维护","设备采购"][e%4]}合同${String(e+1).padStart(3,"0")}`,contractNo:`${["JSFW","RJKF","XTWE","SBCG"][e%4]}HT${String(e+1).padStart(3,"0")}`,clientName:"客户"+(e+1),contractAmount:a,actualPayment:Math.round(l),invoiceAmount:Math.round(s),uninvoicedAmount:Math.round(Math.max(a,l)-s),invoiceType:["增值税专用发票","增值税普通发票","电子发票"][e%3],applicationDate:"2025-07-"+String(e%30+1).padStart(2,"0"),flowStatus:["草稿","审核中","已通过","已退回","已完成"][e%5]}}),this.total=100},getStatistics(){const t=this.getFilteredData();this.statistics={contractTotal:t.reduce((t,e)=>t+e.contractAmount,0),actualPaymentTotal:t.reduce((t,e)=>t+e.actualPayment,0),invoicedTotal:t.reduce((t,e)=>t+e.invoiceAmount,0),uninvoicedAmount:t.reduce((t,e)=>t+e.uninvoicedAmount,0),applicationCount:t.length}},getFilteredData(){return this.tableData},handleSearch(){console.log("搜索条件:",this.searchForm),this.currentPage=1,this.getList(),this.getStatistics()},handleReset(){this.searchForm={applicationNo:"",applicant:"",clientName:"",contractName:"",invoiceType:"",department:"",flowStatus:"",amountMin:"",amountMax:"",applicationDate:"",clientScope:[],contractScope:[]},this.getList(),this.getStatistics()},handleExport(){this.$message.info("导出功能开发中...")},handleView(t){this.dialogTitle="申请详情",this.viewData={...t,items:[{itemName:"技术服务费",specification:"",unit:"项",quantity:1,unitPrice:t.invoiceAmount,amount:t.invoiceAmount}]},this.dialogVisible=!0},handleEdit(t){this.$router.push({path:"/finance/invoice/create",query:{id:t.id,mode:"edit"}})},handlePrint(t){this.$message.info("打印功能开发中...")},getStatusType(t){const e={"草稿":"info","审核中":"warning","已通过":"success","已退回":"danger","已完成":"success"};return e[t]||"info"},getSummaries(t){const{columns:e,data:a}=t,l=[];return e.forEach((t,e)=>{if(0!==e)if(["contractAmount","actualPayment","invoiceAmount","uninvoicedAmount"].includes(t.property)){const s=a.map(e=>Number(e[t.property]));s.every(t=>isNaN(t))?l[e]="":l[e]=this.$options.filters.currency(s.reduce((t,e)=>{const a=Number(e);return isNaN(a)?t:t+e},0))}else l[e]="";else l[e]="合计"}),l},handleSizeChange(t){this.pageSize=t,this.getList()},handleCurrentChange(t){this.currentPage=t,this.getList()}}}),o=i,n=(a("ea8f"),a("2877")),r=Object(n["a"])(o,l,s,!1,null,"33d88510",null);e["default"]=r.exports},"83f9":function(t,e,a){},8558:function(t,e,a){"use strict";var l=a("cfe9"),s=a("b5db"),i=a("c6b6"),o=function(t){return s.slice(0,t.length)===t};t.exports=function(){return o("Bun/")?"BUN":o("Cloudflare-Workers")?"CLOUDFLARE":o("Deno/")?"DENO":o("Node.js/")?"NODE":l.Bun&&"string"==typeof Bun.version?"BUN":l.Deno&&"object"==typeof Deno.version?"DENO":"process"===i(l.process)?"NODE":l.window&&l.document?"BROWSER":"REST"}()},9485:function(t,e,a){"use strict";var l=a("23e7"),s=a("2266"),i=a("59ed"),o=a("825a"),n=a("46c4"),r=TypeError;l({target:"Iterator",proto:!0,real:!0},{reduce:function(t){o(this),i(t);var e=n(this),a=arguments.length<2,l=a?void 0:arguments[1],c=0;if(s(e,(function(e){a?(a=!1,l=e):l=t(l,e,c),c++}),{IS_RECORD:!0}),a)throw new r("Reduce of empty iterator with no initial value");return l}})},"9adc":function(t,e,a){"use strict";var l=a("8558");t.exports="NODE"===l},a640:function(t,e,a){"use strict";var l=a("d039");t.exports=function(t,e){var a=[][t];return!!a&&l((function(){a.call(null,e||function(){return 1},1)}))}},d58f:function(t,e,a){"use strict";var l=a("59ed"),s=a("7b0b"),i=a("44ad"),o=a("07fa"),n=TypeError,r="Reduce of empty array with no initial value",c=function(t){return function(e,a,c,u){var p=s(e),m=i(p),d=o(p);if(l(a),0===d&&c<2)throw new n(r);var v=t?d-1:0,h=t?-1:1;if(c<2)while(1){if(v in m){u=m[v],v+=h;break}if(v+=h,t?v<0:d<=v)throw new n(r)}for(;t?v>=0:d>v;v+=h)v in m&&(u=a(u,m[v],v,p));return u}};t.exports={left:c(!1),right:c(!0)}},ea8f:function(t,e,a){"use strict";a("83f9")}}]);