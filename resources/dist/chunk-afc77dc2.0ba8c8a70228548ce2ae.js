(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-afc77dc2"],{"13d5":function(e,t,a){"use strict";var s=a("23e7"),l=a("d58f").left,i=a("a640"),r=a("1212"),o=a("9adc"),c=!o&&r>79&&r<83,n=c||!i("reduce");s({target:"Array",proto:!0,forced:n},{reduce:function(e){var t=arguments.length;return l(this,e,t,t>1?arguments[1]:void 0)}})},"48fb":function(e,t,a){},5397:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"contract-view-container"},[t("div",{staticClass:"operation-bar"},[t("div",{staticClass:"contract-info"},[t("span",{staticClass:"title"},[e._v(e._s(e.isEditMode?"编辑合同":"新增合同"))]),e.form.contractNo?t("span",{staticClass:"contract-number"},[e._v("合同编号："+e._s(e.form.contractNo))]):e._e()]),t("div",{staticClass:"operation-buttons"},[e.isEditMode?[t("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-refresh"},on:{click:e.handleSave}},[e._v("保存")]),t("el-button",{attrs:{size:"small",icon:"el-icon-close"},on:{click:e.handleCancel}},[e._v("取消")]),t("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:e.handleDelete}},[e._v("删除")]),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-position"},on:{click:e.handleTransfer}},[e._v("流转")]),t("el-button",{attrs:{type:"info",size:"small",icon:"el-icon-back"},on:{click:e.handleReturn}},[e._v("返回")]),t("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-switch-button"},on:{click:e.handleMove}},[e._v("移交")])]:[t("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-check"},on:{click:e.handleSave}},[e._v("保存")]),t("el-button",{attrs:{size:"small",icon:"el-icon-close"},on:{click:e.handleCancel}},[e._v("取消")])]],2)]),t("div",{staticClass:"body-part-content"},[t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleTabClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"合同信息",name:"contractInfo"}},[t("div",{staticClass:"form-container"},[t("el-form",{ref:"form",staticClass:"contract-form",attrs:{model:e.form,"label-width":"120px",rules:e.formRules}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"客户",prop:"customerId",required:""}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",placeholder:"请选择客户","remote-method":e.searchCustomers,loading:e.customerLoading,clearable:""},on:{change:e.handleCustomerChange,focus:e.handleCustomerFocus},model:{value:e.form.customerId,callback:function(t){e.$set(e.form,"customerId",t)},expression:"form.customerId"}},e._l(e.customerOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.customer_name,value:e.id}})})),1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"合同编号"}},[t("el-input",{attrs:{placeholder:"提交后自动生成",disabled:""},model:{value:e.form.contractNo,callback:function(t){e.$set(e.form,"contractNo",t)},expression:"form.contractNo"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"合同代码"}},[t("el-input",{attrs:{placeholder:"提交后自动生成",disabled:""},model:{value:e.form.contractCode,callback:function(t){e.$set(e.form,"contractCode",t)},expression:"form.contractCode"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"合同状态"}},[t("el-input",{attrs:{placeholder:"草稿",disabled:""},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"合同类型",prop:"contractType",required:""}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择合同类型"},on:{change:e.handleContractTypeChange},model:{value:e.form.contractType,callback:function(t){e.$set(e.form,"contractType",t)},expression:"form.contractType"}},[t("el-option",{attrs:{label:"标准合同",value:"standard"}}),t("el-option",{attrs:{label:"非标合同",value:"non-standard"}})],1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"业务服务类型",prop:"serviceType",required:""}},["standard"===e.form.contractType?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.form.serviceType,callback:function(t){e.$set(e.form,"serviceType",t)},expression:"form.serviceType"}},e._l(e.businessServiceTypes,(function(a){return t("el-option-group",{key:a.category,attrs:{label:a.category}},e._l(a.items,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):"non-standard"===e.form.contractType?t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型（可多选）",multiple:"","collapse-tags":""},model:{value:e.form.serviceType,callback:function(t){e.$set(e.form,"serviceType",t)},expression:"form.serviceType"}},e._l(e.businessServiceTypes,(function(a){return t("el-option-group",{key:a.category,attrs:{label:a.category}},e._l(a.items,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请先选择合同类型",disabled:""},model:{value:e.form.serviceType,callback:function(t){e.$set(e.form,"serviceType",t)},expression:"form.serviceType"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"合同名称",prop:"contractName",required:""}},[t("el-input",{attrs:{placeholder:"请输入合同名称"},model:{value:e.form.contractName,callback:function(t){e.$set(e.form,"contractName",t)},expression:"form.contractName"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"业务人员",prop:"businessPersonId",required:""}},[t("SelectPerson",{attrs:{placeholder:"业务人员",clearable:""},on:{change:e.handleBusinessPersonChange},model:{value:e.form.businessPersonId,callback:function(t){e.$set(e.form,"businessPersonId",t)},expression:"form.businessPersonId"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"纸件状态",prop:"paperStatus"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.paperStatus,callback:function(t){e.$set(e.form,"paperStatus",t)},expression:"form.paperStatus"}},[t("el-option",{attrs:{label:"是",value:"1"}}),t("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"合同摘要"}},[t("el-input",{attrs:{maxlength:"300","show-word-limit":"",type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:e.form.summary,callback:function(t){e.$set(e.form,"summary",t)},expression:"form.summary"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"技术主导",prop:"technicalDirectorId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.form.customerId?0===e.technicalDirectorOptions.length?"该客户暂无技术主导联系人":"请选择技术主导":"请先选择客户",filterable:"",disabled:!e.form.customerId||0===e.technicalDirectorOptions.length},on:{change:e.handleTechnicalDirectorChange},model:{value:e.form.technicalDirectorId,callback:function(t){e.$set(e.form,"technicalDirectorId",t)},expression:"form.technicalDirectorId"}},e._l(e.technicalDirectorOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"技术主导部门"}},[t("el-input",{attrs:{placeholder:"自动带出",disabled:""},model:{value:e.form.technicalDepartment,callback:function(t){e.$set(e.form,"technicalDepartment",t)},expression:"form.technicalDepartment"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"甲方联系人",prop:"partyAContactId",required:""}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请先选择客户",filterable:"",disabled:!e.form.customerId||0===e.customerContacts.length},on:{change:e.handlePartyAContactChange},model:{value:e.form.partyAContactId,callback:function(t){e.$set(e.form,"partyAContactId",t)},expression:"form.partyAContactId"}},e._l(e.customerContacts,(function(e){return t("el-option",{key:e.id,attrs:{label:e.contact_name,value:e.id}})})),1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"甲方电话"}},[t("el-input",{attrs:{placeholder:"自动带出",disabled:""},model:{value:e.form.partyAPhone,callback:function(t){e.$set(e.form,"partyAPhone",t)},expression:"form.partyAPhone"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"甲方邮箱"}},[t("el-input",{attrs:{placeholder:"自动带出",disabled:""},model:{value:e.form.partyAEmail,callback:function(t){e.$set(e.form,"partyAEmail",t)},expression:"form.partyAEmail"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"甲方签约地址",prop:"partyAAddress",required:""}},[t("el-input",{attrs:{placeholder:"请输入甲方签约地址"},model:{value:e.form.partyAAddress,callback:function(t){e.$set(e.form,"partyAAddress",t)},expression:"form.partyAAddress"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"乙方签约人",prop:"partyBSignerId",required:""}},[t("SelectPerson",{attrs:{placeholder:"请选择签约人",clearable:""},on:{change:e.handlePartyBSignerChange},model:{value:e.form.partyBSignerId,callback:function(t){e.$set(e.form,"partyBSignerId",t)},expression:"form.partyBSignerId"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"乙方手机"}},[t("el-input",{attrs:{placeholder:"自动带出",disabled:""},model:{value:e.form.partyBPhone,callback:function(t){e.$set(e.form,"partyBPhone",t)},expression:"form.partyBPhone"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"签约日期",prop:"signingDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.form.signingDate,callback:function(t){e.$set(e.form,"signingDate",t)},expression:"form.signingDate"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"乙方签约公司",prop:"partyBCompanyId",required:""}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择签约公司"},on:{change:e.handleCompanyChange},model:{value:e.form.partyBCompanyId,callback:function(t){e.$set(e.form,"partyBCompanyId",t)},expression:"form.partyBCompanyId"}},e._l(e.ourCompanyOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.label||e.short_name,value:e.id}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"乙方签约地址"}},[t("el-input",{attrs:{placeholder:"自动带出",disabled:""},model:{value:e.form.partyBAddress,callback:function(t){e.$set(e.form,"partyBAddress",t)},expression:"form.partyBAddress"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"服务费",prop:"serviceFee"}},[t("el-input",{attrs:{placeholder:"0.00"},on:{change:e.handleServiceFeeChange},model:{value:e.form.serviceFee,callback:function(t){e.$set(e.form,"serviceFee",t)},expression:"form.serviceFee"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"官费",prop:"officialFee"}},[t("el-input",{attrs:{placeholder:"0.00"},on:{change:e.handleOfficialFeeChange},model:{value:e.form.officialFee,callback:function(t){e.$set(e.form,"officialFee",t)},expression:"form.officialFee"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"渠道费",prop:"channelFee"}},[t("el-input",{attrs:{placeholder:"0.00"},on:{change:e.handleChannelFeeChange},model:{value:e.form.channelFee,callback:function(t){e.$set(e.form,"channelFee",t)},expression:"form.channelFee"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"总服务费",prop:"totalServiceFee"}},[t("el-input",{attrs:{placeholder:"0.00",disabled:""},model:{value:e.form.totalServiceFee,callback:function(t){e.$set(e.form,"totalServiceFee",t)},expression:"form.totalServiceFee"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"总金额",prop:"totalAmount"}},[t("el-input",{attrs:{placeholder:"0.00",disabled:""},model:{value:e.form.totalAmount,callback:function(t){e.$set(e.form,"totalAmount",t)},expression:"form.totalAmount"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"合同有效期",prop:"validity"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.form.validity,callback:function(t){e.$set(e.form,"validity",t)},expression:"form.validity"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"合同备注"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入合同备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1),t("el-divider",{attrs:{"content-position":"left"}},[e._v("服务明细")]),t("div",{staticClass:"service-detail"},[t("div",{staticClass:"service-header"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleAddService}},[e._v("添加")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.form.serviceList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"80"}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),t("el-table-column",{attrs:{prop:"serviceName",label:"服务内容","min-width":"160"}}),t("el-table-column",{attrs:{prop:"serviceDescription",label:"项目名称","min-width":"160"}}),t("el-table-column",{attrs:{prop:"amount",label:"服务费",width:"120"}}),t("el-table-column",{attrs:{prop:"currency",label:"官费",width:"80"}}),t("el-table-column",{attrs:{prop:"totalAmount",label:"备注",width:"120"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleEditService(a.row)}}},[e._v("修改")]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDeleteService(a.row)}}},[e._v("删除")])]}}])})],1)],1),t("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"附加条款"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":"",rows:4,placeholder:"请输入附加条款内容"},model:{value:e.form.additionalTerms,callback:function(t){e.$set(e.form,"additionalTerms",t)},expression:"form.additionalTerms"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"text-center",attrs:{span:24}},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handlePreview}},[e._v("合同预览")])],1)],1)],1)],1)]),t("el-tab-pane",{attrs:{label:"附件",name:"attachments",disabled:!e.isEditMode}},[t("div",{staticClass:"attachment-container"},[e.isEditMode?t("div",[t("div",{staticClass:"attachment-header"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload"},on:{click:e.handleUpload}},[e._v("新增")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.attachmentList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"80"}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"80"}}),t("el-table-column",{attrs:{prop:"fileType",label:"文件大类",width:"120"}}),t("el-table-column",{attrs:{prop:"fileSubType",label:"文件小类",width:"120"}}),t("el-table-column",{attrs:{prop:"fileName",label:"文件名称"}}),t("el-table-column",{attrs:{prop:"uploadTime",label:"上传时间",width:"180"}}),t("el-table-column",{attrs:{prop:"fileName",label:"文件"}}),t("el-table-column",{attrs:{prop:"uploader",label:"上传人员",width:"120"}}),t("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDownload(a.row)}}},[e._v("下载")]),t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDeleteFile(a.row)}}},[e._v("删除")])]}}])})],1)],1):t("div",{staticClass:"tab-disabled-tip"},[t("el-alert",{attrs:{title:"请先保存合同后再管理附件",type:"info",closable:!1,"show-icon":""}})],1)])]),t("el-tab-pane",{attrs:{label:"项目信息",name:"caseInfo",disabled:!e.isEditMode}},[t("div",{staticClass:"case-container"},[e.isEditMode?t("div",[t("div",{staticClass:"case-header"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAddCase}},[e._v("新增项目")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.caseList,border:""}},[t("el-table-column",{attrs:{type:"selection",width:"80"}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"80"}}),t("el-table-column",{attrs:{prop:"caseName",label:"项目类型"}}),t("el-table-column",{attrs:{prop:"caseType",label:"业务类型"}}),t("el-table-column",{attrs:{prop:"applyType",label:"申请类型"}}),t("el-table-column",{attrs:{prop:"preAwardName",label:"预项名称"}}),t("el-table-column",{attrs:{prop:"techLeader",label:"技术主导"}}),t("el-table-column",{attrs:{prop:"category",label:"类别"}}),t("el-table-column",{attrs:{prop:"projectNo",label:"项目编号"}}),t("el-table-column",{attrs:{prop:"projectStatus",label:"项目状态"}}),t("el-table-column",{attrs:{prop:"currentStep",label:"当前环节"}}),t("el-table-column",{attrs:{prop:"applyCountry",label:"国家（地区）"}}),t("el-table-column",{attrs:{prop:"remarks",label:"备注"}}),t("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleEditCase(a.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleCopyCase(a.row)}}},[e._v("复制")]),t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDeleteCase(a.row)}}},[e._v("删除")])]}}])})],1)],1):t("div",{staticClass:"tab-disabled-tip"},[t("el-alert",{attrs:{title:"请先保存合同后再管理项目信息",type:"info",closable:!1,"show-icon":""}})],1)])])],1)],1),t("el-dialog",{attrs:{title:"项目详情 - "+e.caseDetail.caseName,visible:e.caseDetailDialogVisible,width:"85%","append-to-body":""},on:{"update:visible":function(t){e.caseDetailDialogVisible=t}}},[t("el-tabs",{attrs:{type:"border-card"},model:{value:e.caseActiveTab,callback:function(t){e.caseActiveTab=t},expression:"caseActiveTab"}},[t("el-tab-pane",{attrs:{label:"基本信息",name:"basicInfo"}},[t("el-form",{attrs:{model:e.caseDetail,"label-width":"130px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户名称",prop:"clientName"}},[t("el-input",{attrs:{placeholder:"自动带出",disabled:!0},model:{value:e.caseDetail.clientName,callback:function(t){e.$set(e.caseDetail,"clientName",t)},expression:"caseDetail.clientName"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"项目类型",prop:"caseType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.handleDetailCaseTypeChange},model:{value:e.caseDetail.caseType,callback:function(t){e.$set(e.caseDetail,"caseType",t)},expression:"caseDetail.caseType"}},[t("el-option",{attrs:{label:"专利",value:"专利"}}),t("el-option",{attrs:{label:"商标",value:"商标"}}),t("el-option",{attrs:{label:"版权",value:"版权"}}),t("el-option",{attrs:{label:"科服",value:"科服"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"申请国家(地区)",prop:"applyCountry"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseDetail.applyCountry,callback:function(t){e.$set(e.caseDetail,"applyCountry",t)},expression:"caseDetail.applyCountry"}},[t("el-option",{attrs:{label:"中国",value:"中国"}}),t("el-option",{attrs:{label:"美国",value:"美国"}}),t("el-option",{attrs:{label:"欧盟",value:"欧盟"}}),t("el-option",{attrs:{label:"日本",value:"日本"}})],1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"业务类型",prop:"businessType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseDetail.businessType,callback:function(t){e.$set(e.caseDetail,"businessType",t)},expression:"caseDetail.businessType"}},[t("el-option",{attrs:{label:"申请",value:"申请"}}),t("el-option",{attrs:{label:"复审",value:"复审"}}),t("el-option",{attrs:{label:"无效",value:"无效"}}),t("el-option",{attrs:{label:"普通新申请",value:"普通新申请"}}),t("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"申请类型",prop:"applyType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseDetail.applyType,callback:function(t){e.$set(e.caseDetail,"applyType",t)},expression:"caseDetail.applyType"}},[t("el-option",{attrs:{label:"普通",value:"普通"}}),t("el-option",{attrs:{label:"加急",value:"加急"}}),t("el-option",{attrs:{label:"特急",value:"特急"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"售前支持",prop:"presaleSupport"}},[t("SelectPerson",{attrs:{placeholder:"售前支持",clearable:"",size:"small"},model:{value:e.caseDetail.presaleSupport,callback:function(t){e.$set(e.caseDetail,"presaleSupport",t)},expression:"caseDetail.presaleSupport"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"预项名称",prop:"preAwardName"}},[t("el-input",{attrs:{placeholder:"请输入预项名称"},model:{value:e.caseDetail.preAwardName,callback:function(t){e.$set(e.caseDetail,"preAwardName",t)},expression:"caseDetail.preAwardName"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"技术主导",prop:"techLeader"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseDetail.techLeader,callback:function(t){e.$set(e.caseDetail,"techLeader",t)},expression:"caseDetail.techLeader"}},e._l(e.techLeaderOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"资料对接-技术",prop:"techContact"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseDetail.techContact,callback:function(t){e.$set(e.caseDetail,"techContact",t)},expression:"caseDetail.techContact"}},e._l(e.techContactOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},["商标"===e.caseDetail.caseType?t("el-form-item",{attrs:{label:"商标类别",prop:"trademarkCategory"}},[t("el-input",{attrs:{placeholder:"请输入商标类别"},model:{value:e.caseDetail.trademarkCategory,callback:function(t){e.$set(e.caseDetail,"trademarkCategory",t)},expression:"caseDetail.trademarkCategory"}})],1):e._e()],1),t("el-col",{attrs:{span:8}},["科服"===e.caseDetail.caseType?t("el-form-item",{attrs:{label:"科技服务名称",prop:"techServiceName"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:e.caseDetail.isAuthorized},model:{value:e.caseDetail.techServiceName,callback:function(t){e.$set(e.caseDetail,"techServiceName",t)},expression:"caseDetail.techServiceName"}},[t("el-option",{attrs:{label:"咨询",value:"咨询"}}),t("el-option",{attrs:{label:"培训",value:"培训"}}),t("el-option",{attrs:{label:"调查",value:"调查"}}),t("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1):e._e()],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"项目状态",prop:"status"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseDetail.status,callback:function(t){e.$set(e.caseDetail,"status",t)},expression:"caseDetail.status"}},[t("el-option",{attrs:{label:"准备中",value:"准备中"}}),t("el-option",{attrs:{label:"已申请",value:"已申请"}}),t("el-option",{attrs:{label:"已受理",value:"已受理"}}),t("el-option",{attrs:{label:"实审中",value:"实审中"}}),t("el-option",{attrs:{label:"已授权",value:"已授权"}}),t("el-option",{attrs:{label:"已驳回",value:"已驳回"}})],1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"是否已有项目",prop:"isAuthorized"}},[t("el-radio-group",{model:{value:e.caseDetail.isAuthorized,callback:function(t){e.$set(e.caseDetail,"isAuthorized",t)},expression:"caseDetail.isAuthorized"}},[t("el-radio",{attrs:{label:!0}},[e._v("是")]),t("el-radio",{attrs:{label:!1}},[e._v("否")])],1)],1)],1),e.caseDetail.isAuthorized?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"项目编号",prop:"projectNo"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目编号"},model:{value:e.caseDetail.projectNo,callback:function(t){e.$set(e.caseDetail,"projectNo",t)},expression:"caseDetail.projectNo"}},[t("el-option",{attrs:{label:"项目1",value:"项目1"}}),t("el-option",{attrs:{label:"项目2",value:"项目2"}}),t("el-option",{attrs:{label:"项目3",value:"项目3"}})],1)],1)],1):e._e(),"专利"===e.caseDetail.caseType?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"申请号",prop:"applyNo"}},[t("el-input",{attrs:{placeholder:"请输入申请号",disabled:e.caseDetail.isAuthorized||"普通新申请"===e.caseDetail.businessType},model:{value:e.caseDetail.applyNo,callback:function(t){e.$set(e.caseDetail,"applyNo",t)},expression:"caseDetail.applyNo"}})],1)],1):e._e(),"商标"===e.caseDetail.caseType?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"注册号",prop:"registrationNo"}},[t("el-input",{attrs:{placeholder:"请输入注册号",disabled:e.caseDetail.isAuthorized},model:{value:e.caseDetail.registrationNo,callback:function(t){e.$set(e.caseDetail,"registrationNo",t)},expression:"caseDetail.registrationNo"}})],1)],1):e._e(),"版权"===e.caseDetail.caseType?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"受理号",prop:"acceptanceNo"}},[t("el-input",{attrs:{placeholder:"请输入受理号",disabled:e.caseDetail.isAuthorized},model:{value:e.caseDetail.acceptanceNo,callback:function(t){e.$set(e.caseDetail,"acceptanceNo",t)},expression:"caseDetail.acceptanceNo"}})],1)],1):e._e()],1),t("el-row",{attrs:{gutter:20}},[["专利","商标","版权"].includes(e.caseDetail.caseType)?[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"代理机构",prop:"agency"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseDetail.agency,callback:function(t){e.$set(e.caseDetail,"agency",t)},expression:"caseDetail.agency"}},[t("el-option",{attrs:{label:"睿道知识产权代理有限公司",value:"睿道知识产权代理有限公司"}}),t("el-option",{attrs:{label:"北京睿道科技有限公司",value:"北京睿道科技有限公司"}})],1)],1)],1)]:e._e()],2),t("el-form-item",{attrs:{label:"项目备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",placeholder:"请输入项目备注",rows:4},model:{value:e.caseDetail.remark,callback:function(t){e.$set(e.caseDetail,"remark",t)},expression:"caseDetail.remark"}})],1)],1),e.caseViewMode?e._e():t("div",{staticClass:"case-operation"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveCaseBasicInfo}},[e._v("保存")]),t("el-button",{on:{click:e.cancelCaseEdit}},[e._v("取消")])],1)],1),t("el-tab-pane",{attrs:{label:"费用信息",name:"feeInfo"}},[t("div",{staticClass:"fee-container"},[t("div",{staticClass:"fee-header"},[t("span",{staticClass:"fee-title"},[e._v("服务费 "+e._s(e.feesTableData.serviceFeeTotal)+" RMB")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleAddFee}},[e._v("新增")])],1),t("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.feesTableData.serviceFees,border:""}},[t("el-table-column",{attrs:{prop:"feeName",label:"服务内容"}}),t("el-table-column",{attrs:{prop:"feeDescription",label:"项目名称","min-width":"200"}}),t("el-table-column",{attrs:{prop:"amount",label:"服务费",width:"120"}}),t("el-table-column",{attrs:{prop:"currency",label:"官费",width:"120"}}),t("el-table-column",{attrs:{prop:"exchangeRate",label:"备注",width:"120"}}),t("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text",disabled:e.caseViewMode},on:{click:function(t){return e.handleEditFee(a.row)}}},[e._v("修改")]),t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text",disabled:e.caseViewMode},on:{click:function(t){return e.handleDeleteFee(a.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"fee-header"},[t("span",{staticClass:"fee-title"},[e._v("官费 "+e._s(e.feesTableData.officialFeeTotal)+" RMB")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addOfficialFee}},[e._v("新增")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.feesTableData.officialFees,border:""}},[t("el-table-column",{attrs:{prop:"feeName",label:"费用名称"}}),t("el-table-column",{attrs:{prop:"feeDescription",label:"费用描述","min-width":"200"}}),t("el-table-column",{attrs:{prop:"amount",label:"金额",width:"120"}}),t("el-table-column",{attrs:{prop:"currency",label:"币别",width:"120"}}),t("el-table-column",{attrs:{prop:"exchangeRate",label:"换算前金额",width:"120"}}),t("el-table-column",{attrs:{prop:"exchangeMethod",label:"换算前币别",width:"120"}}),t("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text",disabled:e.caseViewMode},on:{click:function(t){return e.handleEditOfficialFee(a.row)}}},[e._v("修改")]),t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text",disabled:e.caseViewMode},on:{click:function(t){return e.handleDeleteOfficialFee(a.row)}}},[e._v("删除")])]}}])})],1)],1)]),t("el-tab-pane",{attrs:{label:"附件信息",name:"attachmentInfo"}},[t("div",{staticClass:"attachment-header"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleAddCaseAttachment}},[e._v("新增")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.caseAttachments,border:""}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),t("el-table-column",{attrs:{prop:"fileType",label:"文件大类",width:"120"}}),t("el-table-column",{attrs:{prop:"fileCategory",label:"文件小类",width:"120"}}),t("el-table-column",{attrs:{prop:"fileName",label:"文件名称"}}),t("el-table-column",{attrs:{prop:"fileDesc",label:"文件描述"}}),t("el-table-column",{attrs:{prop:"uploadTime",label:"上传时间",width:"180"}}),t("el-table-column",{attrs:{prop:"uploader",label:"上传人员",width:"120"}}),t("el-table-column",{attrs:{prop:"file",label:"文件",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.downloadCaseFile(a.row)}}},[e._v("下载")])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleEditCaseAttachment(a.row)}}},[e._v("修改")]),t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDeleteCaseAttachment(a.row)}}},[e._v("删除")])]}}])})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.caseDetailDialogVisible=!1}}},[e._v("关闭")]),e.caseViewMode?t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.switchToCaseEditMode}},[e._v("编辑")]):e._e()],1)],1),t("el-dialog",{attrs:{title:e.caseFormTitle,visible:e.caseFormVisible,width:"50%","append-to-body":""},on:{"update:visible":function(t){e.caseFormVisible=t}}},[t("el-form",{ref:"caseFormRef",attrs:{model:e.caseForm,rules:e.caseFormRules,"label-width":"130px"}},[t("el-tabs",{model:{value:e.caseFormActiveTab,callback:function(t){e.caseFormActiveTab=t},expression:"caseFormActiveTab"}},[t("el-tab-pane",{attrs:{label:"基本信息",name:"basicInfo"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"客户名称",prop:"clientName"}},[t("el-input",{attrs:{placeholder:"自动带出",disabled:!0},model:{value:e.caseForm.clientName,callback:function(t){e.$set(e.caseForm,"clientName",t)},expression:"caseForm.clientName"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"项目类型",prop:"caseType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.handleCaseTypeChange},model:{value:e.caseForm.caseType,callback:function(t){e.$set(e.caseForm,"caseType",t)},expression:"caseForm.caseType"}},[t("el-option",{attrs:{label:"专利",value:"专利"}}),t("el-option",{attrs:{label:"商标",value:"商标"}}),t("el-option",{attrs:{label:"版权",value:"版权"}}),t("el-option",{attrs:{label:"科服",value:"科服"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"申请国家(地区)",prop:"applyCountry"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseForm.applyCountry,callback:function(t){e.$set(e.caseForm,"applyCountry",t)},expression:"caseForm.applyCountry"}},[t("el-option",{attrs:{label:"中国",value:"中国"}}),t("el-option",{attrs:{label:"美国",value:"美国"}}),t("el-option",{attrs:{label:"欧盟",value:"欧盟"}}),t("el-option",{attrs:{label:"日本",value:"日本"}})],1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"业务类型",prop:"businessType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseForm.businessType,callback:function(t){e.$set(e.caseForm,"businessType",t)},expression:"caseForm.businessType"}},[t("el-option",{attrs:{label:"申请",value:"申请"}}),t("el-option",{attrs:{label:"复审",value:"复审"}}),t("el-option",{attrs:{label:"无效",value:"无效"}}),t("el-option",{attrs:{label:"普通新申请",value:"普通新申请"}}),t("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"申请类型",prop:"applyType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseForm.applyType,callback:function(t){e.$set(e.caseForm,"applyType",t)},expression:"caseForm.applyType"}},[t("el-option",{attrs:{label:"普通",value:"普通"}}),t("el-option",{attrs:{label:"加急",value:"加急"}}),t("el-option",{attrs:{label:"特急",value:"特急"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"售前支持",prop:"presaleSupport"}},[t("SelectPerson",{attrs:{placeholder:"售前支持",clearable:"",size:"small"},model:{value:e.caseForm.presaleSupport,callback:function(t){e.$set(e.caseForm,"presaleSupport",t)},expression:"caseForm.presaleSupport"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"预项名称",prop:"preAwardName"}},[t("el-input",{attrs:{placeholder:"请输入预项名称"},model:{value:e.caseForm.preAwardName,callback:function(t){e.$set(e.caseForm,"preAwardName",t)},expression:"caseForm.preAwardName"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"技术主导",prop:"techLeader"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseForm.techLeader,callback:function(t){e.$set(e.caseForm,"techLeader",t)},expression:"caseForm.techLeader"}},e._l(e.techLeaderOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"资料对接-技术",prop:"techContact"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.caseForm.techContact,callback:function(t){e.$set(e.caseForm,"techContact",t)},expression:"caseForm.techContact"}},e._l(e.techContactOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},["商标"===e.caseForm.caseType?t("el-form-item",{attrs:{label:"商标类别",prop:"trademarkCategory"}},[t("el-input",{attrs:{placeholder:"请输入商标类别"},model:{value:e.caseForm.trademarkCategory,callback:function(t){e.$set(e.caseForm,"trademarkCategory",t)},expression:"caseForm.trademarkCategory"}})],1):e._e()],1),t("el-col",{attrs:{span:8}},["科服"===e.caseForm.caseType?t("el-form-item",{attrs:{label:"科技服务名称",prop:"techServiceName"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:e.caseForm.isAuthorized},model:{value:e.caseForm.techServiceName,callback:function(t){e.$set(e.caseForm,"techServiceName",t)},expression:"caseForm.techServiceName"}},[t("el-option",{attrs:{label:"咨询",value:"咨询"}}),t("el-option",{attrs:{label:"培训",value:"培训"}}),t("el-option",{attrs:{label:"调查",value:"调查"}}),t("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1):e._e()],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"是否已有项目",prop:"isAuthorized"}},[t("el-radio-group",{model:{value:e.caseForm.isAuthorized,callback:function(t){e.$set(e.caseForm,"isAuthorized",t)},expression:"caseForm.isAuthorized"}},[t("el-radio",{attrs:{label:!0}},[e._v("是")]),t("el-radio",{attrs:{label:!1}},[e._v("否")])],1)],1)],1),e.caseForm.isAuthorized?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"项目编号",prop:"projectNo"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目编号"},model:{value:e.caseForm.projectNo,callback:function(t){e.$set(e.caseForm,"projectNo",t)},expression:"caseForm.projectNo"}},[t("el-option",{attrs:{label:"项目1",value:"项目1"}}),t("el-option",{attrs:{label:"项目2",value:"项目2"}}),t("el-option",{attrs:{label:"项目3",value:"项目3"}})],1)],1)],1):e._e(),"专利"===e.caseForm.caseType?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"申请号",prop:"applyNo"}},[t("el-input",{attrs:{placeholder:"请输入申请号",disabled:e.caseForm.isAuthorized||"普通新申请"===e.caseForm.businessType},model:{value:e.caseForm.applyNo,callback:function(t){e.$set(e.caseForm,"applyNo",t)},expression:"caseForm.applyNo"}})],1)],1):e._e(),"商标"===e.caseForm.caseType?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"注册号",prop:"registrationNo"}},[t("el-input",{attrs:{placeholder:"请输入注册号",disabled:e.caseForm.isAuthorized},model:{value:e.caseForm.registrationNo,callback:function(t){e.$set(e.caseForm,"registrationNo",t)},expression:"caseForm.registrationNo"}})],1)],1):e._e(),"版权"===e.caseForm.caseType?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"受理号",prop:"acceptanceNo"}},[t("el-input",{attrs:{placeholder:"请输入受理号",disabled:e.caseForm.isAuthorized},model:{value:e.caseForm.acceptanceNo,callback:function(t){e.$set(e.caseForm,"acceptanceNo",t)},expression:"caseForm.acceptanceNo"}})],1)],1):e._e()],1),t("el-form-item",{attrs:{label:"项目备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",placeholder:"请输入项目备注",rows:4},model:{value:e.caseForm.remark,callback:function(t){e.$set(e.caseForm,"remark",t)},expression:"caseForm.remark"}})],1)],1),t("el-tab-pane",{attrs:{label:"费用信息",name:"feeInfo"}},[t("div",{staticClass:"fee-form-section"},[t("div",{staticClass:"section-header"},[t("span",{staticClass:"section-title"},[e._v("服务费")]),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.addServiceFee}},[e._v("添加服务费")])],1),t("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.caseForm.serviceFees,border:""}},[t("el-table-column",{attrs:{label:"费用名称"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入费用名称"},model:{value:a.row.feeName,callback:function(t){e.$set(a.row,"feeName",t)},expression:"scope.row.feeName"}})]}}])}),t("el-table-column",{attrs:{label:"费用描述","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入费用描述"},model:{value:a.row.feeDescription,callback:function(t){e.$set(a.row,"feeDescription",t)},expression:"scope.row.feeDescription"}})]}}])}),t("el-table-column",{attrs:{label:"金额",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入金额",type:"number"},model:{value:a.row.amount,callback:function(t){e.$set(a.row,"amount",t)},expression:"scope.row.amount"}})]}}])}),t("el-table-column",{attrs:{label:"币别",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:a.row.currency,callback:function(t){e.$set(a.row,"currency",t)},expression:"scope.row.currency"}},[t("el-option",{attrs:{label:"RMB",value:"RMB"}}),t("el-option",{attrs:{label:"USD",value:"USD"}}),t("el-option",{attrs:{label:"EUR",value:"EUR"}})],1)]}}])}),t("el-table-column",{attrs:{label:"换算前金额",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入换算前金额"},model:{value:a.row.exchangeRate,callback:function(t){e.$set(a.row,"exchangeRate",t)},expression:"scope.row.exchangeRate"}})]}}])}),t("el-table-column",{attrs:{label:"换算前币别",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:a.row.exchangeMethod,callback:function(t){e.$set(a.row,"exchangeMethod",t)},expression:"scope.row.exchangeMethod"}},[t("el-option",{attrs:{label:"USD",value:"USD"}}),t("el-option",{attrs:{label:"EUR",value:"EUR"}}),t("el-option",{attrs:{label:"JPY",value:"JPY"}})],1)]}}])}),t("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text"},on:{click:function(t){return e.removeServiceFee(a.$index)}}},[e._v("编辑")]),t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text"},on:{click:function(t){return e.removeServiceFee(a.$index)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"section-header"},[t("span",{staticClass:"section-title"},[e._v("官费")]),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.addOfficialFee}},[e._v("添加官费")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.caseForm.officialFees,border:""}},[t("el-table-column",{attrs:{label:"费用名称"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入费用名称"},model:{value:a.row.feeName,callback:function(t){e.$set(a.row,"feeName",t)},expression:"scope.row.feeName"}})]}}])}),t("el-table-column",{attrs:{label:"费用描述","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入费用描述"},model:{value:a.row.feeDescription,callback:function(t){e.$set(a.row,"feeDescription",t)},expression:"scope.row.feeDescription"}})]}}])}),t("el-table-column",{attrs:{label:"金额",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入金额",type:"number"},model:{value:a.row.amount,callback:function(t){e.$set(a.row,"amount",t)},expression:"scope.row.amount"}})]}}])}),t("el-table-column",{attrs:{label:"币别",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:a.row.currency,callback:function(t){e.$set(a.row,"currency",t)},expression:"scope.row.currency"}},[t("el-option",{attrs:{label:"RMB",value:"RMB"}}),t("el-option",{attrs:{label:"USD",value:"USD"}}),t("el-option",{attrs:{label:"EUR",value:"EUR"}})],1)]}}])}),t("el-table-column",{attrs:{label:"换算前金额",width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入换算前金额"},model:{value:a.row.exchangeRate,callback:function(t){e.$set(a.row,"exchangeRate",t)},expression:"scope.row.exchangeRate"}})]}}])}),t("el-table-column",{attrs:{label:"换算前币别",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:a.row.exchangeMethod,callback:function(t){e.$set(a.row,"exchangeMethod",t)},expression:"scope.row.exchangeMethod"}},[t("el-option",{attrs:{label:"USD",value:"USD"}}),t("el-option",{attrs:{label:"EUR",value:"EUR"}}),t("el-option",{attrs:{label:"JPY",value:"JPY"}})],1)]}}])}),t("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text"},on:{click:function(t){return e.removeOfficialFee(a.$index)}}},[e._v("编辑")]),t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text"},on:{click:function(t){return e.removeOfficialFee(a.$index)}}},[e._v("删除")])]}}])})],1)],1)]),t("el-tab-pane",{attrs:{label:"附件信息",name:"attachmentInfo"}},[t("div",{staticClass:"upload-section"},[t("el-upload",{staticClass:"upload-container",attrs:{action:"#","on-change":e.handleFileChange,"auto-upload":!1,"file-list":e.caseForm.fileList,multiple:""}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("新增")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("请上传相关附件，支持多种格式")])],1),t("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.caseForm.attachments,border:""}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),t("el-table-column",{attrs:{label:"文件大类",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:a.row.fileType,callback:function(t){e.$set(a.row,"fileType",t)},expression:"scope.row.fileType"}},[t("el-option",{attrs:{label:"文档",value:"文档"}}),t("el-option",{attrs:{label:"图片",value:"图片"}}),t("el-option",{attrs:{label:"表格",value:"表格"}})],1)]}}])}),t("el-table-column",{attrs:{label:"文件小类",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:a.row.fileCategory,callback:function(t){e.$set(a.row,"fileCategory",t)},expression:"scope.row.fileCategory"}},[t("el-option",{attrs:{label:"申请文件",value:"申请文件"}}),t("el-option",{attrs:{label:"证明文件",value:"证明文件"}}),t("el-option",{attrs:{label:"其他",value:"其他"}})],1)]}}])}),t("el-table-column",{attrs:{prop:"fileName",label:"文件名称"}}),t("el-table-column",{attrs:{label:"文件描述"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入文件描述"},model:{value:a.row.fileDesc,callback:function(t){e.$set(a.row,"fileDesc",t)},expression:"scope.row.fileDesc"}})]}}])}),t("el-table-column",{attrs:{label:"上传时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择上传时间"},model:{value:a.row.uploadTime,callback:function(t){e.$set(a.row,"uploadTime",t)},expression:"scope.row.uploadTime"}})]}}])}),t("el-table-column",{attrs:{label:"上传人",width:"150"}}),t("el-table-column",{attrs:{label:"文件名称",width:"150"}}),t("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"delete-button",attrs:{size:"small",type:"text"},on:{click:function(t){return e.removeAttachment(a.$index)}}},[e._v("删除")])]}}])})],1)],1)])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelCaseForm}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitCaseForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:e.feeDialogTitle,visible:e.feeDialogVisible,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.feeDialogVisible=t}}},[t("el-form",{ref:"feeForm",attrs:{model:e.feeForm,rules:e.feeFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"费用名称",prop:"feeName"}},[t("el-input",{attrs:{placeholder:"请输入费用名称"},model:{value:e.feeForm.feeName,callback:function(t){e.$set(e.feeForm,"feeName",t)},expression:"feeForm.feeName"}})],1),t("el-form-item",{attrs:{label:"费用描述",prop:"feeDescription"}},[t("el-input",{attrs:{placeholder:"请输入费用描述"},model:{value:e.feeForm.feeDescription,callback:function(t){e.$set(e.feeForm,"feeDescription",t)},expression:"feeForm.feeDescription"}})],1),t("el-form-item",{attrs:{label:"金额",prop:"amount"}},[t("el-input",{attrs:{placeholder:"请输入金额",type:"number"},model:{value:e.feeForm.amount,callback:function(t){e.$set(e.feeForm,"amount",t)},expression:"feeForm.amount"}})],1),t("el-form-item",{attrs:{label:"币别",prop:"currency"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择币别"},model:{value:e.feeForm.currency,callback:function(t){e.$set(e.feeForm,"currency",t)},expression:"feeForm.currency"}},[t("el-option",{attrs:{label:"RMB",value:"RMB"}}),t("el-option",{attrs:{label:"USD",value:"USD"}}),t("el-option",{attrs:{label:"EUR",value:"EUR"}}),t("el-option",{attrs:{label:"JPY",value:"JPY"}})],1)],1),t("el-form-item",{attrs:{label:"换算前金额",prop:"exchangeRate"}},[t("el-input",{attrs:{placeholder:"可选"},model:{value:e.feeForm.exchangeRate,callback:function(t){e.$set(e.feeForm,"exchangeRate",t)},expression:"feeForm.exchangeRate"}})],1),t("el-form-item",{attrs:{label:"换算前币别",prop:"exchangeMethod"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"可选",clearable:""},model:{value:e.feeForm.exchangeMethod,callback:function(t){e.$set(e.feeForm,"exchangeMethod",t)},expression:"feeForm.exchangeMethod"}},[t("el-option",{attrs:{label:"USD",value:"USD"}}),t("el-option",{attrs:{label:"EUR",value:"EUR"}}),t("el-option",{attrs:{label:"JPY",value:"JPY"}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.feeDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitFeeForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:e.attachmentDialogTitle,visible:e.attachmentDialogVisible,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.attachmentDialogVisible=t}}},[t("el-form",{ref:"attachmentForm",attrs:{model:e.attachmentForm,rules:e.attachmentFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"文件",prop:"file"}},[t("el-upload",{staticClass:"attachment-upload",attrs:{action:"#","auto-upload":!1,"file-list":e.fileList,"on-change":e.handleAttachmentChange,"on-remove":e.handleRemoveAttachment,limit:1}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择文件")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("请选择文件，大小不超过50MB")])],1)],1),t("el-form-item",{attrs:{label:"文件大类",prop:"fileType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择文件大类"},model:{value:e.attachmentForm.fileType,callback:function(t){e.$set(e.attachmentForm,"fileType",t)},expression:"attachmentForm.fileType"}},[t("el-option",{attrs:{label:"文档",value:"文档"}}),t("el-option",{attrs:{label:"图片",value:"图片"}}),t("el-option",{attrs:{label:"表格",value:"表格"}}),t("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),t("el-form-item",{attrs:{label:"文件小类",prop:"fileCategory"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择文件小类"},model:{value:e.attachmentForm.fileCategory,callback:function(t){e.$set(e.attachmentForm,"fileCategory",t)},expression:"attachmentForm.fileCategory"}},[t("el-option",{attrs:{label:"申请文件",value:"申请文件"}}),t("el-option",{attrs:{label:"证明文件",value:"证明文件"}}),t("el-option",{attrs:{label:"授权文件",value:"授权文件"}}),t("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),t("el-form-item",{attrs:{label:"文件描述",prop:"fileDesc"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入文件描述",rows:3},model:{value:e.attachmentForm.fileDesc,callback:function(t){e.$set(e.attachmentForm,"fileDesc",t)},expression:"attachmentForm.fileDesc"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.attachmentDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitAttachmentForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:e.serviceDialogTitle,visible:e.serviceDialogVisible,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.serviceDialogVisible=t}}},[t("el-form",{ref:"serviceForm",attrs:{model:e.serviceForm,rules:e.serviceFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"服务内容",prop:"serviceName"}},[t("el-input",{attrs:{placeholder:"请输入服务名称"},model:{value:e.serviceForm.serviceName,callback:function(t){e.$set(e.serviceForm,"serviceName",t)},expression:"serviceForm.serviceName"}})],1),t("el-form-item",{attrs:{label:"项目名称",prop:"serviceDescription"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入项目名称"},model:{value:e.serviceForm.serviceDescription,callback:function(t){e.$set(e.serviceForm,"serviceDescription",t)},expression:"serviceForm.serviceDescription"}})],1),t("el-form-item",{attrs:{label:"服务费",prop:"amount"}},[t("el-input",{attrs:{placeholder:"请输入服务费",type:"number"},model:{value:e.serviceForm.amount,callback:function(t){e.$set(e.serviceForm,"amount",t)},expression:"serviceForm.amount"}})],1),t("el-form-item",{attrs:{label:"官费",prop:"currency"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入官费"},model:{value:e.serviceForm.currency,callback:function(t){e.$set(e.serviceForm,"currency",t)},expression:"serviceForm.currency"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"totalAmount"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入备注"},model:{value:e.serviceForm.totalAmount,callback:function(t){e.$set(e.serviceForm,"totalAmount",t)},expression:"serviceForm.totalAmount"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.serviceDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitServiceForm}},[e._v("确 定")])],1)],1),t("el-dialog",{staticClass:"contract-preview-dialog",attrs:{title:"合同预览",visible:e.contractPreviewVisible,width:"90%","close-on-click-modal":!1},on:{"update:visible":function(t){e.contractPreviewVisible=t}}},[t("div",{staticClass:"contract-preview-content"},[t("div",{staticClass:"contract-title-page"},[t("div",{staticClass:"contract-header-info"},[t("div",{staticClass:"contract-number"},[e._v("合同编号："+e._s(e.form.contractNo||"提交后自动生成"))])]),t("div",{staticClass:"contract-main-title"},[t("h1",[e._v(e._s(e.form.contractName||"知识产权服务合同"))])]),t("div",{staticClass:"contract-parties"},[t("div",{staticClass:"parties-row"},[t("div",{staticClass:"party-section left-party"},[t("div",{staticClass:"party-label"},[e._v("甲方（委托方）：")]),t("div",{staticClass:"party-content"},[t("div",{staticClass:"party-name"},[e._v(e._s(e.getCustomerName()))]),t("div",{staticClass:"party-details"},[t("div",{staticClass:"detail-row"},[t("span",{staticClass:"detail-label"},[e._v("联系人：")]),t("span",{staticClass:"detail-value"},[e._v(e._s(e.getPartyAContactName()))])]),t("div",{staticClass:"detail-row"},[t("span",{staticClass:"detail-label"},[e._v("联系电话：")]),t("span",{staticClass:"detail-value"},[e._v(e._s(e.form.partyAPhone))])]),t("div",{staticClass:"detail-row"},[t("span",{staticClass:"detail-label"},[e._v("电子邮箱：")]),t("span",{staticClass:"detail-value"},[e._v(e._s(e.form.partyAEmail))])]),t("div",{staticClass:"detail-row"},[t("span",{staticClass:"detail-label"},[e._v("地址：")]),t("span",{staticClass:"detail-value"},[e._v(e._s(e.form.partyAAddress))])])])])]),t("div",{staticClass:"party-section right-party"},[t("div",{staticClass:"party-label"},[e._v("乙方（服务方）：")]),t("div",{staticClass:"party-content"},[t("div",{staticClass:"party-name"},[e._v(e._s(e.getPartyBCompanyName()))]),t("div",{staticClass:"party-details"},[t("div",{staticClass:"detail-row"},[t("span",{staticClass:"detail-label"},[e._v("法定代表人：")]),t("span",{staticClass:"detail-value"},[e._v(e._s(e.getPartyBSignerName()))])]),t("div",{staticClass:"detail-row"},[t("span",{staticClass:"detail-label"},[e._v("联系电话：")]),t("span",{staticClass:"detail-value"},[e._v(e._s(e.form.partyBPhone))])]),t("div",{staticClass:"detail-row"},[t("span",{staticClass:"detail-label"},[e._v("地址：")]),t("span",{staticClass:"detail-value"},[e._v(e._s(e.form.partyBAddress))])])])])])])])]),t("div",{staticClass:"contract-content-page"},[t("div",{staticClass:"contract-preamble"},[t("p",{staticClass:"preamble-text"},[e._v(" 根据《中华人民共和国合同法》及相关法律法规的规定，甲乙双方在平等、自愿、公平、诚实信用的基础上， 就甲方委托乙方提供知识产权服务事宜，经协商一致，达成如下协议： ")])]),t("div",{staticClass:"contract-article"},[t("div",{staticClass:"article-title"},[e._v("第一条 服务内容")]),t("div",{staticClass:"article-content"},[t("p",[e._v("1.1 乙方为甲方提供以下知识产权服务：")]),t("div",{staticClass:"service-list"},[t("p",[e._v(e._s(e.getServiceTypeText()))])]),e.form.summary?t("div",{staticClass:"service-description"},[t("p",[e._v("1.2 服务详细说明：")]),t("p",{staticClass:"description-text"},[e._v(e._s(e.form.summary))])]):e._e()])]),e.form.serviceList&&e.form.serviceList.length>0?t("div",{staticClass:"contract-article"},[t("div",{staticClass:"article-title"},[e._v("第二条 服务明细")]),t("div",{staticClass:"article-content"},[t("table",{staticClass:"formal-table"},[t("thead",[t("tr",[t("th",{attrs:{width:"8%"}},[e._v("序号")]),t("th",{attrs:{width:"25%"}},[e._v("服务内容")]),t("th",{attrs:{width:"30%"}},[e._v("项目名称")]),t("th",{attrs:{width:"12%"}},[e._v("服务费(元)")]),t("th",{attrs:{width:"12%"}},[e._v("官费(元)")]),t("th",{attrs:{width:"13%"}},[e._v("备注")])])]),t("tbody",e._l(e.form.serviceList,(function(a,s){return t("tr",{key:s},[t("td",[e._v(e._s(s+1))]),t("td",[e._v(e._s(a.serviceName))]),t("td",[e._v(e._s(a.serviceDescription))]),t("td",{staticClass:"amount-cell"},[e._v(e._s(a.amount))]),t("td",{staticClass:"amount-cell"},[e._v(e._s(a.currency))]),t("td",[e._v(e._s(a.totalAmount))])])})),0)])])]):e._e(),t("div",{staticClass:"contract-article"},[t("div",{staticClass:"article-title"},[e._v("第三条 费用及支付")]),t("div",{staticClass:"article-content"},[t("div",{staticClass:"fee-summary"},[t("div",{staticClass:"fee-row"},[t("span",{staticClass:"fee-label"},[e._v("服务费：")]),t("span",{staticClass:"fee-amount"},[e._v("人民币 "+e._s(e.form.serviceFee)+" 元")])]),t("div",{staticClass:"fee-row"},[t("span",{staticClass:"fee-label"},[e._v("官费：")]),t("span",{staticClass:"fee-amount"},[e._v("人民币 "+e._s(e.form.officialFee)+" 元")])]),parseFloat(e.form.channelFee)>0?t("div",{staticClass:"fee-row"},[t("span",{staticClass:"fee-label"},[e._v("渠道费：")]),t("span",{staticClass:"fee-amount"},[e._v("人民币 "+e._s(e.form.channelFee)+" 元")])]):e._e(),t("div",{staticClass:"fee-row total-fee"},[t("span",{staticClass:"fee-label"},[e._v("合同总金额：")]),t("span",{staticClass:"fee-amount"},[e._v("人民币 "+e._s(e.form.totalAmount)+" 元")])])]),t("p",[e._v("3.1 甲方应按照约定的时间和方式支付上述费用。")]),t("p",[e._v("3.2 具体支付方式和时间安排另行约定。")])])]),t("div",{staticClass:"contract-article"},[t("div",{staticClass:"article-title"},[e._v("第四条 双方权利义务")]),t("div",{staticClass:"article-content"},[t("p",[e._v("4.1 甲方权利义务：")]),t("p",{staticClass:"sub-clause"},[e._v("（1）按时提供必要的技术资料和相关文件；")]),t("p",{staticClass:"sub-clause"},[e._v("（2）按约定支付服务费用；")]),t("p",{staticClass:"sub-clause"},[e._v("（3）配合乙方完成相关服务工作。")]),t("p",[e._v("4.2 乙方权利义务：")]),t("p",{staticClass:"sub-clause"},[e._v("（1）按照专业标准提供知识产权服务；")]),t("p",{staticClass:"sub-clause"},[e._v("（2）及时向甲方通报服务进展情况；")]),t("p",{staticClass:"sub-clause"},[e._v("（3）保守甲方商业秘密和技术秘密。")])])]),t("div",{staticClass:"contract-article"},[t("div",{staticClass:"article-title"},[e._v("第五条 合同期限")]),t("div",{staticClass:"article-content"},[e.form.validity&&2===e.form.validity.length?t("p",[e._v(" 本合同自 "+e._s(e.form.validity[0])+" 起至 "+e._s(e.form.validity[1])+" 止。 ")]):t("p",[e._v(" 本合同自双方签字盖章之日起生效。 ")])])]),e.form.additionalTerms?t("div",{staticClass:"contract-article"},[t("div",{staticClass:"article-title"},[e._v("第六条 其他约定")]),t("div",{staticClass:"article-content"},[t("p",{staticClass:"additional-terms-text"},[e._v(e._s(e.form.additionalTerms))])])]):e._e(),t("div",{staticClass:"contract-article"},[t("div",{staticClass:"article-title"},[e._v("第"+e._s(e.form.additionalTerms?"七":"六")+"条 争议解决")]),t("div",{staticClass:"article-content"},[t("p",[e._v("因履行本合同发生的争议，双方应友好协商解决；协商不成的，可向有管辖权的人民法院起诉。")])])]),t("div",{staticClass:"contract-article"},[t("div",{staticClass:"article-title"},[e._v("第"+e._s(e.form.additionalTerms?"八":"七")+"条 合同生效")]),t("div",{staticClass:"article-content"},[t("p",[e._v("本合同一式两份，甲乙双方各执一份，自双方签字盖章之日起生效。")])])])]),t("div",{staticClass:"contract-signature-page"},[t("div",{staticClass:"signature-section"},[t("div",{staticClass:"signature-parties-row"},[t("div",{staticClass:"signature-party left-party"},[t("div",{staticClass:"signature-title"},[e._v("甲方（委托方）")]),t("div",{staticClass:"signature-content"},[t("div",{staticClass:"signature-line"},[t("span",{staticClass:"signature-label"},[e._v("单位名称：")]),t("span",{staticClass:"signature-value"},[e._v(e._s(e.getCustomerName()))])]),t("div",{staticClass:"signature-line"},[t("span",{staticClass:"signature-label"},[e._v("法定代表人：")]),t("span",{staticClass:"signature-underline"})]),t("div",{staticClass:"signature-line"},[t("span",{staticClass:"signature-label"},[e._v("授权代表：")]),t("span",{staticClass:"signature-underline"})]),t("div",{staticClass:"signature-line"},[t("span",{staticClass:"signature-label"},[e._v("签字日期：")]),t("span",{staticClass:"signature-date"},[e._v(e._s(e.form.signingDate||"年 月 日"))])]),t("div",{staticClass:"signature-seal"},[t("div",{staticClass:"seal-area"},[e._v("（盖章）")])])])]),t("div",{staticClass:"signature-party right-party"},[t("div",{staticClass:"signature-title"},[e._v("乙方（服务方）")]),t("div",{staticClass:"signature-content"},[t("div",{staticClass:"signature-line"},[t("span",{staticClass:"signature-label"},[e._v("单位名称：")]),t("span",{staticClass:"signature-value"},[e._v(e._s(e.getPartyBCompanyName()))])]),t("div",{staticClass:"signature-line"},[t("span",{staticClass:"signature-label"},[e._v("法定代表人：")]),t("span",{staticClass:"signature-underline"})]),t("div",{staticClass:"signature-line"},[t("span",{staticClass:"signature-label"},[e._v("授权代表：")]),t("span",{staticClass:"signature-value"},[e._v(e._s(e.getPartyBSignerName()))])]),t("div",{staticClass:"signature-line"},[t("span",{staticClass:"signature-label"},[e._v("签字日期：")]),t("span",{staticClass:"signature-date"},[e._v(e._s(e.form.signingDate||"年 月 日"))])]),t("div",{staticClass:"signature-seal"},[t("div",{staticClass:"seal-area"},[e._v("（盖章）")])])])])])])])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.contractPreviewVisible=!1}}},[e._v("关闭")]),t("el-button",{attrs:{type:"info"},on:{click:e.printContract}},[e._v("打印合同")]),t("el-button",{attrs:{type:"primary"},on:{click:e.exportContractPDF}},[e._v("导出PDF")])],1)]),t("el-dialog",{attrs:{title:"新增官费",visible:e.officialFeeDialogVisible,width:"80%","close-on-click-modal":!1},on:{"update:visible":function(t){e.officialFeeDialogVisible=t}}},[t("div",{staticClass:"official-fee-dialog"},[t("div",{staticClass:"search-section"},[t("el-form",{staticClass:"search-form",attrs:{inline:!0}},[t("el-form-item",[t("el-checkbox",{model:{value:e.officialFeeSearchForm.isNewApplication,callback:function(t){e.$set(e.officialFeeSearchForm,"isNewApplication",t)},expression:"officialFeeSearchForm.isNewApplication"}},[e._v("新申请")])],1),t("el-form-item",[t("el-checkbox",{model:{value:e.officialFeeSearchForm.showHistory,callback:function(t){e.$set(e.officialFeeSearchForm,"showHistory",t)},expression:"officialFeeSearchForm.showHistory"}},[e._v("复审无效年费（变续转）")])],1),t("el-form-item",[t("el-checkbox",{model:{value:e.officialFeeSearchForm.showHistory,callback:function(t){e.$set(e.officialFeeSearchForm,"showHistory",t)},expression:"officialFeeSearchForm.showHistory"}},[e._v("全部费用")])],1),t("el-form-item",[t("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"输入费用名称"},model:{value:e.officialFeeSearchForm.searchKeyword,callback:function(t){e.$set(e.officialFeeSearchForm,"searchKeyword",t)},expression:"officialFeeSearchForm.searchKeyword"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchOfficialFees},slot:"append"},[e._v("搜索")])],1)],1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.filteredOfficialFeeOptions,border:""},on:{"selection-change":e.handleOfficialFeeSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"80"}}),t("el-table-column",{attrs:{prop:"id",label:"序号",width:"80"}}),t("el-table-column",{attrs:{prop:"feeType",label:"费用类型",width:"150"}}),t("el-table-column",{attrs:{prop:"feeName",label:"费用名称","min-width":"200"}}),t("el-table-column",{attrs:{prop:"feeDescription",label:"费用描述","min-width":"250"}}),t("el-table-column",{attrs:{prop:"amount",label:"基础费用",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.amount)+" ")]}}])}),t("el-table-column",{attrs:{prop:"feeType",label:"费减类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.feeType||"75")+" ")]}}])}),t("el-table-column",{attrs:{prop:"smallEntityFee",label:"费减后金额",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.smallEntityFee||"75")+" ")]}}])}),t("el-table-column",{attrs:{prop:"microEntityFee",label:"应收金额",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.microEntityFee||"75")+" ")]}}])}),t("el-table-column",{attrs:{prop:"currency",label:"币别",width:"80"}},[[e._v(" 人民币 ")]],2),t("el-table-column",{attrs:{label:"官方期限",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.dueDate||"2023-02-21")+" ")]}}])}),t("el-table-column",{attrs:{label:"实收日期",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.actualDate||"2023-02-21")+" ")]}}])}),t("el-table-column",{attrs:{label:"实付日期",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.payDate||"2023-02-21")+" ")]}}])})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelOfficialFeeSelection}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmOfficialFeeSelection}},[e._v("确定")])],1)]),t("WorkflowConfigDialog",{attrs:{visible:e.workflowConfigVisible,"workflow-config":e.currentWorkflowConfig,"contract-id":e.currentContractId},on:{"update:visible":function(t){e.workflowConfigVisible=t},success:e.handleWorkflowSuccess,close:e.handleWorkflowClose}})],1)},l=[],i=(a("14d9"),a("13d5"),a("e9f5"),a("910d"),a("f665"),a("7d54"),a("ab43"),a("9485"),a("a732"),a("88a7"),a("271a"),a("5494"),a("512b")),r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"配置合同审批流程",visible:e.visible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.handleClose}},[e.workflowConfig?t("div",[t("div",{staticClass:"workflow-info"},[t("h4",[e._v(e._s(e.workflowConfig.name))]),t("p",{staticClass:"workflow-desc"},[e._v("请为需要处理人的节点选择具体的处理人员")])]),t("div",{staticClass:"nodes-config"},e._l(e.workflowConfig.nodes,(function(a,s){return t("div",{key:s,staticClass:"node-item"},[t("div",{staticClass:"node-header"},[t("span",{staticClass:"node-name"},[e._v(e._s(a.name))]),t("el-tag",{attrs:{type:e.getNodeTypeColor(a.type),size:"mini"}},[e._v(e._s(a.type))])],1),a.required&&a.assignee&&a.assignee.length>0?t("div",{staticClass:"node-assignee"},[t("el-form-item",{attrs:{label:a.name+"处理人",required:!0}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择处理人"},model:{value:e.selectedAssignees[s],callback:function(t){e.$set(e.selectedAssignees,s,t)},expression:"selectedAssignees[index]"}},e._l(a.assignee,(function(a){return t("el-option",{key:a,attrs:{label:e.getUserName(a),value:a}})})),1)],1)],1):a.required?t("div",{staticClass:"node-no-assignee"},[t("span",{staticClass:"no-assignee-text"},[e._v("无需指定处理人")])]):t("div",{staticClass:"node-auto"},[t("span",{staticClass:"auto-text"},[e._v("自动通过")])])])})),0)]):e._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.loading,disabled:!e.isFormValid},on:{click:e.handleConfirm}},[e._v(" 启动流程 ")])],1)])},o=[],c={name:"WorkflowConfigDialog",props:{visible:{type:Boolean,default:!1},workflowConfig:{type:Object,default:null},contractId:{type:[String,Number],default:null}},data(){return{loading:!1,selectedAssignees:{},users:[]}},computed:{isFormValid(){if(!this.workflowConfig)return!1;for(let e=0;e<this.workflowConfig.nodes.length;e++){const t=this.workflowConfig.nodes[e];if(t.required&&t.assignee&&t.assignee.length>0&&!this.selectedAssignees[e])return!1}return!0}},watch:{visible(e){e&&(this.initForm(),this.loadUsers())}},methods:{initForm(){this.selectedAssignees={},this.loading=!1},async loadUsers(){try{const e=await this.$api.workflow.getAssignableUsers();e.data&&0===e.data.code&&(this.users=e.data.data)}catch(e){console.error("获取用户列表失败:",e)}},getUserName(e){const t=this.users.find(t=>t.id===e);return t?t.real_name||t.username:"用户"+e},getNodeTypeColor(e){const t={"启动":"success","审核":"warning","处理":"primary","分配":"info","检查":"primary","确认":"warning","结束":"success"};return t[e]||"info"},async handleConfirm(){if(this.isFormValid){this.loading=!0;try{const e=await this.$api.contract.startWorkflowWithAssignees(this.contractId,{workflow_id:this.workflowConfig.id,selected_assignees:this.selectedAssignees});e.data.success?(this.$message.success("工作流启动成功"),this.$emit("success",e.data.data),this.handleClose()):this.$message.error(e.data.message||"启动失败")}catch(t){var e;console.error("启动工作流失败:",t),this.$message.error("启动失败："+((null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)||t.message))}finally{this.loading=!1}}else this.$message.warning("请完成所有必需的处理人选择")},handleClose(){this.$emit("update:visible",!1),this.$emit("close")}}},n=c,p=(a("d7c2"),a("2877")),d=Object(p["a"])(n,r,o,!1,null,"5de2c7d7",null),m=d.exports,u=a("35ad"),f=a("f6b0"),h=a("89c4"),b=a("c24f"),v={name:"ContractAdd",components:{SelectPerson:i["a"],WorkflowConfigDialog:m},data(){return{loading:!1,activeTab:"contractInfo",contractNo:"",form:{customerId:"",contractNo:"",contractCode:"",contractName:"",status:"草稿",summary:"",contractType:"",serviceType:"",businessPersonId:"",paperStatus:"0",technicalDirectorId:"",technicalDepartment:"",partyAContactId:"",partyAPhone:"",partyAEmail:"",partyAAddress:"",partyBSignerId:"",partyBPhone:"",partyBCompanyId:"",partyBAddress:"",serviceFee:"0.00",officialFee:"0.00",channelFee:"0.00",totalServiceFee:"0.00",totalAmount:"0.00",signingDate:(new Date).toISOString().split("T")[0],validity:null,additionalTerms:"",remark:"",creator:"",createTime:"",updater:"",updateTime:"",serviceList:[]},workflowConfigVisible:!1,currentWorkflowConfig:null,currentContractId:null,formRules:{customerId:[{required:!0,message:"请选择客户",trigger:"change"}],contractName:[{required:!0,message:"请输入合同名称",trigger:"blur"}],contractType:[{required:!0,message:"请选择合同类型",trigger:"change"}],serviceType:[{required:!0,message:"请选择业务服务类型",trigger:"change"}],businessPersonId:[{required:!0,message:"请选择业务人员",trigger:"change"}],partyAContactId:[{required:!0,message:"请选择甲方联系人",trigger:"change"}],partyAAddress:[{required:!0,message:"请输入甲方签约地址",trigger:"blur"}],partyBSignerId:[{required:!0,message:"请选择乙方签约人",trigger:"change"}],partyBCompanyId:[{required:!0,message:"请选择乙方签约公司",trigger:"change"}],validity:[{required:!0,message:"请选择有效期",trigger:"change"}],signingDate:[{required:!0,message:"请选择签约日期",trigger:"change"}]},attachmentList:[],caseList:[],caseDetailDialogVisible:!1,caseActiveTab:"basicInfo",caseViewMode:!0,caseDetail:{id:"",caseName:"",caseType:"",businessType:"",applyType:"",agency:"",support:"",productName:"",applyNo:"",applyDate:"",trademarkCategory:"",applyCountry:"",remark:""},feesTableData:{serviceFees:[],officialFees:[],serviceFeeTotal:"16000.00",officialFeeTotal:"3455.00"},caseAttachments:[],caseFormVisible:!1,caseFormTitle:"新增项目",caseFormActiveTab:"basicInfo",caseForm:{id:void 0,caseType:"",businessType:"",applyType:"",agency:"",support:"",productName:"",applyNo:"",applyDate:"",trademarkCategory:"",applyCountry:"中国",hasImage:!1,isAuthorized:!1,remark:"",serviceFees:[],officialFees:[],fileList:[],attachments:[]},caseFormRules:{caseType:[{required:!0,message:"请选择项目类型",trigger:"change"}],businessType:[{required:!0,message:"请选择业务类型",trigger:"change"}],productName:[{required:!0,message:"请输入产品名称",trigger:"blur"}],applyCountry:[{required:!0,message:"请选择申请国家",trigger:"change"}]},feeDialogVisible:!1,feeDialogTitle:"",feeDialogType:"",feeForm:{id:void 0,feeName:"",feeDescription:"",amount:"",currency:"",exchangeRate:"",exchangeMethod:""},feeFormRules:{feeName:[{required:!0,message:"请输入费用名称",trigger:"blur"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}],currency:[{required:!0,message:"请选择币别",trigger:"change"}]},attachmentDialogVisible:!1,attachmentDialogTitle:"",attachmentForm:{id:void 0,fileType:"",fileCategory:"",fileName:"",fileDesc:"",file:null},attachmentFormRules:{fileType:[{required:!0,message:"请选择文件大类",trigger:"change"}],fileCategory:[{required:!0,message:"请选择文件小类",trigger:"change"}],fileDesc:[{required:!0,message:"请输入文件描述",trigger:"blur"}],file:[{required:!0,message:"请选择文件",trigger:"change"}]},fileList:[],serviceForm:{id:void 0,serviceName:"",serviceDescription:"",amount:"",currency:"",totalAmount:""},serviceDialogVisible:!1,serviceDialogTitle:"",serviceFormRules:{serviceName:[{required:!0,message:"请输入服务名称",trigger:"blur"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}],currency:[{required:!0,message:"请选择币种",trigger:"change"}]},contractPreviewVisible:!1,isEditMode:!1,loadingStates:{customers:!1,technicalDirectors:!1,ourCompanies:!1,users:!1},officialFeeDialogVisible:!1,officialFeeSearchForm:{isNewApplication:!0,showHistory:!1,searchKeyword:""},selectedOfficialFees:[],officialFeeOptions:[],techLeaderOptions:[],techContactOptions:[],customerOptions:[],customerLoading:!1,customerContacts:[],technicalDirectorOptions:[],ourCompanyOptions:[],userOptions:[],businessServiceTypes:[{category:"专利",items:[{value:"专利申请",label:"专利申请"},{value:"实用新型申请",label:"实用新型申请"},{value:"外观申请",label:"外观申请"},{value:"专利无效宣告",label:"专利无效宣告"},{value:"无效宣告答辩",label:"无效宣告答辩"},{value:"专利复审",label:"专利复审"},{value:"专利转让",label:"专利转让"},{value:"专利变更",label:"专利变更"},{value:"专利年费代缴",label:"专利年费代缴"},{value:"海外单一国申请",label:"海外单一国申请"},{value:"PCT国际阶段",label:"PCT国际阶段"},{value:"PCT国家阶段",label:"PCT国家阶段"},{value:"香港登记",label:"香港登记"},{value:"澳门登记",label:"澳门登记"},{value:"公众意见",label:"公众意见"},{value:"翻译",label:"翻译"},{value:"许可备案",label:"许可备案"},{value:"专利海关备案",label:"专利海关备案"},{value:"办理专利薄附本",label:"办理专利薄附本"},{value:"专利权评价报告",label:"专利权评价报告"},{value:"集成电路布图登记",label:"集成电路布图登记"},{value:"优先审查",label:"优先审查"},{value:"快速预审",label:"快速预审"},{value:"代理机构变更",label:"代理机构变更"},{value:"资产评估",label:"资产评估"},{value:"发明人变更",label:"发明人变更"},{value:"专利权人更名",label:"专利权人更名"},{value:"专利导航分析",label:"专利导航分析"},{value:"专利稳定性分析",label:"专利稳定性分析"},{value:"无效宣告检索分析",label:"无效宣告检索分析"},{value:"专利微导航",label:"专利微导航"},{value:"侵权比对分析",label:"侵权比对分析"},{value:"新创性检索",label:"新创性检索"},{value:"侵权检索",label:"侵权检索"}]},{category:"商标",items:[{value:"商标注册申请",label:"商标注册申请"},{value:"撤回商标注册申请",label:"撤回商标注册申请"}]},{category:"版权",items:[{value:"版权登记",label:"版权登记"}]},{category:"科服",items:[{value:"知识产权贯标",label:"知识产权贯标"},{value:"两融合贯标",label:"两融合贯标"},{value:"项目申报",label:"项目申报"},{value:"项目验收",label:"项目验收"}]}],processList:[{currentStep:1,steps:[{title:"提交完成",description:"提交描述有点多",time:"2019-04-13 20:46",handler:""},{title:"提交处理",description:"提交处理",time:"2019-04-13 20:46",handler:"xxxx"},{title:"审核通过",description:"内容已通过已通过已经通过了",time:"2019-04-13 20:46",handler:""},{title:"完成",description:"已完成了",time:"2019-04-13 20:46",handler:""}]},{currentStep:1,steps:[{title:"提交完成",description:"提交描述有点多",time:"2019-04-13 20:46",handler:""},{title:"提交处理",description:"提交处理",time:"2019-04-13 20:46",handler:"xxxx"},{title:"审核通过",description:"内容已通过已通过已经通过了",time:"2019-04-13 20:46",handler:""},{title:"完成",description:"已完成了",time:"2019-04-13 20:46",handler:""}]}],processDetailList:[{handler:"张三",action:"启动流程",remark:"",processTime:"2024-01-12 16:57",status:"递交"},{handler:"李四-通过",action:"主管审核",remark:"",processTime:"2024-01-13 16:57",status:"递交"},{handler:"王五-各字段写错",action:"流程初核",remark:"",processTime:"2024-01-13 17:57",status:"递交"},{handler:"张三",action:"启动流程",remark:"",processTime:"2024-01-14 16:57",status:"递交"},{handler:"李四-通过",action:"主管审核",remark:"",processTime:"2024-01-15 16:57",status:"递交"},{handler:"丹丹-通过",action:"流程初核",remark:"",processTime:"2024-01-16 17:57",status:"递交"},{handler:"敏数",action:"递交",remark:"",processTime:"2024-01-12 16:57",status:"递交"}]}},created(){this.isEditMode=!!this.$route.query.id,this.initializeData(),this.isEditMode&&this.getContractDetail()},computed:{statusType(){const e={draft:"info",reviewing:"warning",approved:"success",rejected:"danger"};return e[this.form.status]||"info"},filteredOfficialFeeOptions(){let e=this.officialFeeOptions;return this.officialFeeSearchForm.searchKeyword&&(e=e.filter(e=>e.feeName.includes(this.officialFeeSearchForm.searchKeyword)||e.feeDescription.includes(this.officialFeeSearchForm.searchKeyword))),e}},methods:{async initializeData(){try{await this.loadOurCompanyOptions(),this.setDefaultCreatorInfo()}catch(e){console.error("初始化数据失败:",e)}},async loadCustomerOptions(){if(!(this.loadingStates.customers||this.customerOptions.length>0)){this.loadingStates.customers=!0;try{const e=await f["a"].getList({pageSize:100});e.data&&e.data.success&&(this.customerOptions=e.data.data.list||[])}catch(e){console.error("加载客户选项失败:",e)}finally{this.loadingStates.customers=!1}}},async searchCustomers(e){if(e){this.customerLoading=!0;try{const t=await f["a"].getList({name:e,pageSize:50});console.log("客户搜索响应:",t.data),t.data&&t.data.success&&(this.customerOptions=t.data.data.list||[],console.log("客户选项:",this.customerOptions))}catch(t){console.error("搜索客户失败:",t)}finally{this.customerLoading=!1}}else await this.loadCustomerOptions()},async handleCustomerFocus(){if(0===this.customerOptions.length){this.customerLoading=!0;try{await this.loadCustomerOptions()}finally{this.customerLoading=!1}}},async handleCustomerChange(e){if(!e)return this.customerContacts=[],this.technicalDirectorOptions=[],this.form.partyAContactId="",this.form.partyAPhone="",this.form.partyAEmail="",this.form.businessPersonId="",this.form.technicalDirectorId="",void(this.form.technicalDepartment="");try{const t=await f["a"].get(e);if(console.log("客户详情响应:",t.data),t.data&&t.data.success){const e=t.data.data;this.customerContacts=e.contacts||[],e.business_person_id&&(this.form.businessPersonId=e.business_person_id),this.technicalDirectorOptions=(e.contacts||[]).filter(e=>"技术主导"===e.contact_type_text||"技术人员"===e.contact_type_text).map(e=>({id:e.id,name:e.contact_name,department:e.department,phone:e.phone,email:e.email}))}}catch(t){console.error("获取客户详情失败:",t)}},handleBusinessPersonChange(e,t){console.log("业务人员变更:",e,t)},async handleTechnicalDirectorChange(e){if(e)try{const t=this.technicalDirectorOptions.find(t=>t.id===e);t&&(this.form.technicalDepartment=t.department||"")}catch(t){console.error("获取技术主导部门失败:",t)}else this.form.technicalDepartment=""},handlePartyAContactChange(e){if(!e)return this.form.partyAPhone="",void(this.form.partyAEmail="");const t=this.customerContacts.find(t=>t.id===e);t&&(this.form.partyAPhone=t.phone||"",this.form.partyAEmail=t.email||"")},async handlePartyBSignerChange(e,t){if(e)try{const t=await b["default"].getDetail(e);if(t&&t.data&&t.data.success){const e=t.data.data;e&&e.phone&&(this.form.partyBPhone=e.phone)}}catch(a){if(console.error("获取签约人信息失败:",a),t&&t.length>0){const a=t.find(t=>t.id===e);a&&a.phone&&(this.form.partyBPhone=a.phone)}}else this.form.partyBPhone=""},async handleCompanyChange(e){if(e)try{const t=this.ourCompanyOptions.find(t=>t.id===e);if(t&&t.address)return void(this.form.partyBAddress=t.address);const a=await h["a"].ourCompany.getDetail(e);if(a.data&&0===a.data.code){const e=a.data.data;this.form.partyBAddress=e.address||""}}catch(t){console.error("获取公司地址失败:",t)}else this.form.partyBAddress=""},async loadTechnicalDirectorOptions(){console.log("loadTechnicalDirectorOptions 已废弃，技术主导选项从客户联系人中获取")},async loadOurCompanyOptions(){if(!(this.loadingStates.ourCompanies||this.ourCompanyOptions.length>0)){this.loadingStates.ourCompanies=!0;try{const e=await h["a"].ourCompany.getOptions();console.log("我方公司选项响应:",e.data),e.data&&0===e.data.code&&(this.ourCompanyOptions=e.data.data||[],console.log("我方公司选项:",this.ourCompanyOptions))}catch(e){console.error("加载我方公司选项失败:",e),this.ourCompanyOptions=[{id:1,label:"睿道知识产权代理有限公司",short_name:"睿道知识产权代理有限公司",address:"北京市海淀区中关村大街1号"},{id:2,label:"北京睿道科技有限公司",short_name:"北京睿道科技有限公司",address:"北京市朝阳区建国门外大街1号"}]}finally{this.loadingStates.ourCompanies=!1}}},async loadUserOptions(){if(!(this.loadingStates.users||this.userOptions.length>0)){this.loadingStates.users=!0;try{let e;this.$api.user&&this.$api.user.getList?e=await this.$api.user.getList({pageSize:1e3}):this.$api.system&&this.$api.system.user&&this.$api.system.user.getList?e=await this.$api.system.user.getList({pageSize:1e3}):f["a"].getUserOptions&&(e=await f["a"].getUserOptions()),e&&e.data&&(e.data.success||0===e.data.code)&&(this.userOptions=e.data.data.list||e.data.data||[])}catch(e){console.error("加载用户选项失败:",e),this.userOptions=[]}finally{this.loadingStates.users=!1}}},setDefaultCreatorInfo(){const e=this.$store.getters.userInfo;e&&(this.form.creator=e.real_name||e.username,this.form.createTime=(new Date).toLocaleString())},handleContractTypeChange(e){this.form.serviceType="standard"===e?"":"non-standard"===e?[]:""},handleServiceFeeChange(){const e=parseFloat(this.form.serviceFee||0),t=parseFloat(this.form.channelFee||0);this.form.totalServiceFee=(e+t).toFixed(2),this.handleTotalAmountChange()},handleOfficialFeeChange(){this.handleTotalAmountChange()},handleChannelFeeChange(){const e=parseFloat(this.form.serviceFee||0),t=parseFloat(this.form.channelFee||0);this.form.totalServiceFee=(e+t).toFixed(2),this.handleTotalAmountChange()},handleTotalAmountChange(){const e=parseFloat(this.form.totalServiceFee||0),t=parseFloat(this.form.officialFee||0);this.form.totalAmount=(e+t).toFixed(2)},handlePreview(){this.contractPreviewVisible=!0},getCustomerName(){const e=this.customerOptions.find(e=>e.id===this.form.customerId);return e?e.customer_name:""},getPartyAContactName(){const e=this.customerContacts.find(e=>e.id===this.form.partyAContactId);return e?e.contact_name:""},getPartyBCompanyName(){const e=this.ourCompanyOptions.find(e=>e.id===this.form.partyBCompanyId);return e?e.label||e.short_name:""},async getPartyBSignerName(){if(0===this.userOptions.length&&await this.loadUserOptions(),this.userOptions&&this.userOptions.length>0){const e=this.userOptions.find(e=>e.id===this.form.partyBSignerId);return e?e.real_name||e.name:""}return""},getTechnicalDirectorName(){const e=this.technicalDirectorOptions.find(e=>e.id===this.form.technicalDirectorId);return e?e.name:""},getServiceTypeText(){return this.form.serviceType?Array.isArray(this.form.serviceType)?this.form.serviceType.join("、"):this.form.serviceType:""},handleTabClick(e){if(!this.isEditMode&&("attachments"===e.name||"caseInfo"===e.name))return this.$message.warning("请先保存合同后再访问此功能"),this.activeTab="contractInfo",!1},exportContractPDF(){this.printContract()},printContract(){const e=document.querySelector(".contract-preview-dialog");e&&e.classList.add("print-mode"),setTimeout(()=>{window.print(),setTimeout(()=>{e&&e.classList.remove("print-mode")},1e3)},100)},async generatePDFByAPI(){try{this.$message.loading("正在生成PDF...");const e=await u["a"].exportPDF({contractId:this.$route.query.id,contractData:this.form});if(e.data&&e.data.success){const t=new Blob([e.data],{type:"application/pdf"}),a=window.URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`${this.form.contractName||"合同"}_${this.form.contractNo||(new Date).getTime()}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(a),this.$message.success("PDF导出成功")}else this.$message.error("PDF生成失败")}catch(e){console.error("PDF导出失败:",e),this.$message.error("PDF导出失败")}},handleEdit(){this.$message.success("进入编辑模式")},async handleSave(){try{this.loading=!0;const e=await this.$refs.form.validate();if(!e)return void this.$message.error("请完善必填信息");const t={customer_id:this.form.customerId,contract_name:this.form.contractName,contract_type:this.form.contractType,service_type:this.form.serviceType,business_person_id:this.form.businessPersonId,technical_director_id:this.form.technicalDirectorId,technical_department:this.form.technicalDepartment,paper_status:this.form.paperStatus,party_a_contact_id:this.form.partyAContactId,party_a_phone:this.form.partyAPhone,party_a_email:this.form.partyAEmail,party_a_address:this.form.partyAAddress,party_b_signer_id:this.form.partyBSignerId,party_b_phone:this.form.partyBPhone,party_b_company_id:this.form.partyBCompanyId,party_b_address:this.form.partyBAddress,service_fee:parseFloat(this.form.serviceFee||0),official_fee:parseFloat(this.form.officialFee||0),channel_fee:parseFloat(this.form.channelFee||0),total_service_fee:parseFloat(this.form.totalServiceFee||0),total_amount:parseFloat(this.form.totalAmount||0),signing_date:this.form.signingDate,validity_start_date:this.form.validity?this.form.validity[0]:null,validity_end_date:this.form.validity?this.form.validity[1]:null,summary:this.form.summary,additional_terms:this.form.additionalTerms,remark:this.form.remark,contract_code:this.form.contractCode||null,services:this.form.serviceList.map(e=>({service_name:e.serviceName,service_description:e.serviceDescription,amount:parseFloat(e.amount||0),official_fee:parseFloat(e.currency||0),remark:e.totalAmount}))};let a;if(a=this.$route.query.id?await u["a"].updateContract(this.$route.query.id,t):await u["a"].createContract(t),a.data.success){this.$message.success(a.data.message);const e=a.data.data;let t;t=e.contract?e.contract:e,t&&(this.form.contractNo=t.contract_no,this.form.contractCode||(this.form.contractCode=t.contract_no)),!this.isEditMode&&t&&t.id&&this.$router.push({path:"/contract/view",query:{id:t.id}})}else this.$message.error(a.data.message||"保存失败")}catch(t){var e;console.error("保存失败:",t),this.$message.error("保存失败："+((null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)||t.message))}finally{this.loading=!1}},handleCancel(){this.$router.go(-1)},handleDelete(){this.$confirm("确认删除该合同?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.success("删除成功")})},handleTransfer(){this.$message.success("开始流转")},handleReturn(){this.$router.go(-1)},handleMove(){this.$message.success("开始移交")},showWorkflowConfig(e,t){this.currentContractId=e,this.currentWorkflowConfig=t,this.workflowConfigVisible=!0},handleWorkflowSuccess(e){console.log("工作流启动成功:",e),this.$router.push({path:"/contract/view",query:{id:this.currentContractId}})},handleWorkflowClose(){this.$router.push({path:"/contract/view",query:{id:this.currentContractId}})},async getCustomerList(){try{const e=await f["a"].getCustomerList({page_size:1e3});e.data.success&&(this.customerOptions=e.data.data.data.map(e=>({label:e.customer_name,value:e.id})))}catch(e){console.error("获取客户列表失败:",e)}},async getUserList(){},async getContractDetail(){try{this.loading=!0;const a=await u["a"].getContract(this.$route.query.id);if(a.data.success){var e,t;const s=a.data.data;this.form={...this.form,...s,customerId:s.customer_id,contractCode:s.contract_code,contractName:s.contract_name,contractType:s.contract_type||"standard",serviceType:s.service_type||("non-standard"===s.contract_type?[]:""),businessPersonId:s.business_person_id,technicalDirectorId:s.technical_director_id,technicalDepartment:s.technical_department,paperStatus:s.paper_status?"1":"0",partyAContactId:s.party_a_contact_id,partyAPhone:s.party_a_phone,partyAEmail:s.party_a_email,partyAAddress:s.party_a_address,partyBSignerId:s.party_b_signer_id,partyBPhone:s.party_b_phone,partyBCompanyId:s.party_b_company_id,partyBAddress:s.party_b_address,serviceFee:s.service_fee,officialFee:s.official_fee,channelFee:s.channel_fee,totalServiceFee:s.total_service_fee,totalAmount:s.total_amount,signingDate:s.signing_date,validity:s.validity_start_date&&s.validity_end_date?[s.validity_start_date,s.validity_end_date]:null,additionalTerms:s.additional_terms,remark:s.remark,creator:(null===(e=s.creator)||void 0===e?void 0:e.name)||"",createTime:s.created_at,updater:(null===(t=s.updater)||void 0===t?void 0:t.name)||"",updateTime:s.updated_at},s.services&&s.services.length>0&&(this.form.serviceList=s.services.map(e=>({id:e.id,serviceName:e.service_name,serviceDescription:e.service_description,amount:e.amount,currency:e.official_fee,totalAmount:e.remark}))),s.attachments&&s.attachments.length>0&&(this.attachmentList=s.attachments.map(e=>{var t;return{id:e.id,fileType:e.file_type,fileSubType:e.file_sub_type,fileName:e.file_name,uploadTime:e.upload_time,uploader:(null===(t=e.uploader)||void 0===t?void 0:t.name)||""}})),this.contractNo=s.contract_no}else this.$message.error(a.data.message||"获取合同详情失败")}catch(s){var a;console.error("获取合同详情失败:",s),this.$message.error("获取合同详情失败："+((null===(a=s.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.message)||s.message))}finally{this.loading=!1}},selectOpportunity(){this.$message.info("打开选择商机弹窗")},selectSalesman(){this.$message.info("打开选择业务人员弹窗")},selectTechnicalDirector(){this.$message.info("打开选择技术主导弹窗")},handleSubmit(){this.$refs.form.validate(e=>{if(!e)return this.$message.error("请完善必填信息"),!1;this.$confirm("确认提交合同?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.success("合同提交成功")}).catch(()=>{this.$message.info("已取消提交")})})},handleUpload(){this.$message.success("打开上传附件对话框")},handleDownload(e){this.$message.success("开始下载："+e.fileName)},handleDeleteFile(e){this.$confirm(`确认删除文件：${e.fileName}?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.success("文件删除成功")})},handleAddCase(){this.resetCaseForm(),this.caseFormTitle="新增项目",this.caseFormVisible=!0,this.caseFormActiveTab="basicInfo",this.$nextTick(()=>{this.$refs.caseFormRef&&this.$refs.caseFormRef.clearValidate()})},handleCopyCase(e){this.resetCaseForm(),this.caseForm={caseType:e.caseType,businessType:"专利申请",applyType:"初访",agency:"睿道知识产权代理有限公司",support:"张先生",productName:e.caseName+"-复制",applyNo:"",applyDate:"",trademarkCategory:"",applyCountry:"中国",hasImage:!1,isAuthorized:!1,remark:"复制自项目："+e.caseName,serviceFees:[],officialFees:[],fileList:[],attachments:[]},this.caseFormTitle="复制项目",this.caseFormVisible=!0,this.caseFormActiveTab="basicInfo",this.$nextTick(()=>{this.$refs.caseFormRef&&this.$refs.caseFormRef.clearValidate()})},resetCaseForm(){this.caseForm={id:void 0,caseType:"",businessType:"",applyType:"",agency:"",support:"",productName:"",applyNo:"",applyDate:"",trademarkCategory:"",applyCountry:"中国",hasImage:!1,isAuthorized:!1,remark:"",serviceFees:[],officialFees:[],fileList:[],attachments:[]},this.$refs.caseFormRef&&this.$refs.caseFormRef.resetFields()},cancelCaseForm(){this.caseFormVisible=!1,this.resetCaseForm()},submitCaseForm(){this.$refs.caseFormRef.validate(e=>{if(e){const e={id:this.caseForm.id||Date.now(),caseName:this.caseForm.productName,caseType:this.caseForm.caseType,applyNo:this.caseForm.applyNo,status:"草稿",createTime:(new Date).toISOString().slice(0,16).replace("T"," ")};if(this.caseForm.id){const t=this.caseList.findIndex(e=>e.id===this.caseForm.id);-1!==t&&(this.caseList.splice(t,1,e),this.$message.success("项目更新成功"))}else this.caseList.unshift(e),this.$message.success("项目添加成功");this.caseFormVisible=!1,this.resetCaseForm()}})},addServiceFee(){this.caseForm.serviceFees.push({feeName:"",feeDescription:"",amount:"",currency:""})},removeServiceFee(e){this.caseForm.serviceFees.splice(e,1)},addOfficialFee(){this.selectedOfficialFees=[],this.officialFeeSearchForm.searchKeyword="",this.officialFeeDialogVisible=!0},removeOfficialFee(e){this.caseForm.officialFees.splice(e,1)},handleFileChange(e,t){this.caseForm.fileList=t,"ready"!==e.status||this.caseForm.attachments.some(t=>t.uid===e.uid)||this.caseForm.attachments.push({uid:e.uid,fileName:e.name,fileSize:this.formatFileSize(e.size),fileType:"",fileCategory:"",fileDesc:"",uploadTime:(new Date).toISOString().slice(0,16).replace("T"," "),uploader:"当前用户"})},removeAttachment(e){const t=this.caseForm.attachments[e];this.caseForm.attachments.splice(e,1);const a=this.caseForm.fileList.findIndex(e=>e.uid===t.uid);-1!==a&&this.caseForm.fileList.splice(a,1)},formatFileSize(e){return e<1024?e+"B":e<1048576?(e/1024).toFixed(2)+"KB":(e/1048576).toFixed(2)+"MB"},handleEditCase(e){this.caseDetail={id:e.id||1,caseName:e.caseName||"",caseType:e.caseType||"",businessType:"专利申请",applyType:"初访",agency:"睿道知识产权代理有限公司",support:"张先生",productName:e.caseName||"",applyNo:e.applyNo||"",applyDate:"",trademarkCategory:"",applyCountry:"中国",remark:"这是一个测试项目"},this.caseViewMode=!0,this.caseActiveTab="basicInfo",this.caseDetailDialogVisible=!0,this.calculateFeeTotals()},handleDeleteCase(e){this.$confirm(`确认删除项目：${e.caseName}?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.caseList.findIndex(t=>t.id===e.id);-1!==t&&(this.caseList.splice(t,1),this.$message.success("项目删除成功"))}).catch(()=>{this.$message.info("已取消删除")})},switchToCaseEditMode(){this.caseViewMode=!1},saveCaseBasicInfo(){this.$message.success("保存成功"),this.caseViewMode=!0},cancelCaseEdit(){this.caseViewMode=!0},calculateFeeTotals(){this.feesTableData.serviceFeeTotal=this.feesTableData.serviceFees.reduce((e,t)=>e+(parseFloat(t.amount)||0),0).toFixed(2),this.feesTableData.officialFeeTotal=this.feesTableData.officialFees.reduce((e,t)=>e+(parseFloat(t.amount)||0),0).toFixed(2)},handleAddFee(){this.resetFeeForm(),this.feeDialogTitle="新增服务费",this.feeDialogType="service",this.feeDialogVisible=!0},handleEditFee(e){this.resetFeeForm(),this.feeForm=JSON.parse(JSON.stringify(e)),this.feeDialogTitle="编辑服务费",this.feeDialogType="service",this.feeDialogVisible=!0},handleDeleteFee(e){this.$confirm(`确认删除服务费: ${e.feeName}?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.feesTableData.serviceFees.findIndex(t=>t.id===e.id);-1!==t&&(this.feesTableData.serviceFees.splice(t,1),this.calculateFeeTotals(),this.$message.success("删除成功"))}).catch(()=>{this.$message.info("已取消删除")})},handleAddOfficialFee(){this.resetFeeForm(),this.feeDialogTitle="新增官费",this.feeDialogType="official",this.feeDialogVisible=!0},handleEditOfficialFee(e){this.resetFeeForm(),this.feeForm=JSON.parse(JSON.stringify(e)),this.feeDialogTitle="编辑官费",this.feeDialogType="official",this.feeDialogVisible=!0},handleDeleteOfficialFee(e){this.$confirm(`确认删除官费: ${e.feeName}?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.feesTableData.officialFees.findIndex(t=>t.id===e.id);-1!==t&&(this.feesTableData.officialFees.splice(t,1),this.calculateFeeTotals(),this.$message.success("删除成功"))}).catch(()=>{this.$message.info("已取消删除")})},resetFeeForm(){this.feeForm={id:void 0,feeName:"",feeDescription:"",amount:"",currency:"RMB",exchangeRate:"",exchangeMethod:""},this.$refs.feeForm&&this.$refs.feeForm.clearValidate()},submitFeeForm(){this.$refs.feeForm.validate(e=>{if(e){const e=JSON.parse(JSON.stringify(this.feeForm));if("service"===this.feeDialogType)if(e.id){const t=this.feesTableData.serviceFees.findIndex(t=>t.id===e.id);-1!==t&&(this.feesTableData.serviceFees.splice(t,1,e),this.$message.success("服务费修改成功"))}else e.id=Date.now(),this.feesTableData.serviceFees.push(e),this.$message.success("服务费添加成功");else if("official"===this.feeDialogType)if(e.id){const t=this.feesTableData.officialFees.findIndex(t=>t.id===e.id);-1!==t&&(this.feesTableData.officialFees.splice(t,1,e),this.$message.success("官费修改成功"))}else e.id=Date.now(),this.feesTableData.officialFees.push(e),this.$message.success("官费添加成功");this.calculateFeeTotals(),this.feeDialogVisible=!1}})},handleAddCaseAttachment(){this.resetAttachmentForm(),this.attachmentDialogTitle="新增附件",this.attachmentDialogVisible=!0,this.fileList=[]},downloadCaseFile(e){this.$message.success("下载文件: "+e.fileName)},handleEditCaseAttachment(e){this.resetAttachmentForm(),this.attachmentForm={id:e.id,fileType:e.fileType,fileCategory:e.fileCategory,fileName:e.fileName,fileDesc:e.fileDesc,file:null},this.attachmentDialogTitle="编辑附件",this.attachmentDialogVisible=!0,this.fileList=[{name:e.fileName,url:"javascript:void(0)"}]},handleDeleteCaseAttachment(e){this.$confirm(`确认删除附件: ${e.fileName}?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.caseAttachments.findIndex(t=>t.id===e.id);-1!==t&&(this.caseAttachments.splice(t,1),this.$message.success("删除成功"))}).catch(()=>{this.$message.info("已取消删除")})},resetAttachmentForm(){this.attachmentForm={id:void 0,fileType:"",fileCategory:"",fileName:"",fileDesc:"",file:null},this.$refs.attachmentForm&&this.$refs.attachmentForm.clearValidate()},submitAttachmentForm(){this.$refs.attachmentForm.validate(e=>{if(e){const e=(new Date).toISOString().slice(0,16).replace("T"," ");if(this.attachmentForm.id){const t=this.caseAttachments.findIndex(e=>e.id===this.attachmentForm.id);if(-1!==t){const a={...this.caseAttachments[t],fileType:this.attachmentForm.fileType,fileCategory:this.attachmentForm.fileCategory,fileDesc:this.attachmentForm.fileDesc};this.fileList.length>0&&this.fileList[0].raw&&(a.fileName=this.fileList[0].name,a.uploadTime=e),this.caseAttachments.splice(t,1,a),this.$message.success("附件修改成功")}}else{const t={id:Date.now(),fileType:this.attachmentForm.fileType,fileCategory:this.attachmentForm.fileCategory,fileName:this.fileList.length>0?this.fileList[0].name:this.attachmentForm.fileName,fileDesc:this.attachmentForm.fileDesc,uploadTime:e,uploader:"当前用户",file:"文件路径"};this.caseAttachments.push(t),this.$message.success("附件添加成功")}this.attachmentDialogVisible=!1}})},handleAttachmentChange(e,t){this.fileList=t,"ready"===e.status&&(this.attachmentForm.fileName=e.name,this.attachmentForm.file=e.raw)},handleRemoveAttachment(e,t){this.fileList=t,0===t.length&&(this.attachmentForm.file=null,this.attachmentForm.fileName="")},handleAddService(){this.resetServiceForm(),this.serviceDialogTitle="添加服务",this.serviceDialogVisible=!0},handleEditService(e){this.resetServiceForm(),this.serviceForm=JSON.parse(JSON.stringify(e)),this.serviceDialogTitle="编辑服务",this.serviceDialogVisible=!0},handleDeleteService(e){this.$confirm(`确认删除服务: ${e.serviceName}?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.form.serviceList.findIndex(t=>t.id===e.id);-1!==t&&(this.form.serviceList.splice(t,1),this.updateTotalAmount(),this.$message.success("删除成功"))}).catch(()=>{this.$message.info("已取消删除")})},resetServiceForm(){this.serviceForm={id:void 0,serviceName:"",serviceDescription:"",amount:"",currency:"",totalAmount:""},this.$refs.serviceForm&&this.$refs.serviceForm.clearValidate()},submitServiceForm(){this.$refs.serviceForm.validate(e=>{if(e){const e=JSON.parse(JSON.stringify(this.serviceForm));if(e.totalAmount=e.amount,e.id){const t=this.form.serviceList.findIndex(t=>t.id===e.id);-1!==t&&(this.form.serviceList.splice(t,1,e),this.$message.success("服务修改成功"))}else e.id=Date.now(),this.form.serviceList.push(e),this.$message.success("服务添加成功");this.updateTotalAmount(),this.serviceDialogVisible=!1}})},updateTotalAmount(){const e=this.form.serviceList.reduce((e,t)=>e+parseFloat(t.amount||0),0);this.form.serviceFee=e.toFixed(2),this.form.totalAmount=(e+parseFloat(this.form.officialFee||0)).toFixed(2)},handleCaseTypeChange(){this.caseForm.businessType=null,this.caseForm.applyType=null,this.caseForm.presaleSupport=null,"专利"===this.caseForm.caseType?(this.caseForm.registerNumber="",this.caseForm.projectType=""):"商标"===this.caseForm.caseType?(this.caseForm.applicationNumber="",this.caseForm.projectType=""):"版权"===this.caseForm.caseType?(this.caseForm.applicationNumber="",this.caseForm.registerNumber="",this.caseForm.projectType=""):"项目"===this.caseForm.caseType&&(this.caseForm.applicationNumber="",this.caseForm.registerNumber="",this.caseForm.applicationCountry="",this.caseForm.agency="")},handleDetailCaseTypeChange(){this.caseDetail.businessType=null,this.caseDetail.applyType=null,"专利"===this.caseDetail.caseType?(this.caseDetail.registerNumber="",this.caseDetail.projectType=""):"商标"===this.caseDetail.caseType?(this.caseDetail.applicationNumber="",this.caseDetail.projectType=""):"版权"===this.caseDetail.caseType?(this.caseDetail.applicationNumber="",this.caseDetail.registerNumber="",this.caseDetail.projectType=""):"项目"===this.caseDetail.caseType&&(this.caseDetail.applicationNumber="",this.caseDetail.registerNumber="",this.caseDetail.applicationCountry="",this.caseDetail.agency="")},getStatusType(e){const t={"完成":"success","进行中":"warning","退回":"danger","待处理":"info","递交":"primary"};return t[e]||"info"},getStepClass(e,t){return e<t?"step-completed":e===t?"step-current":"step-pending"},searchOfficialFees(){this.$message.info("搜索完成")},handleOfficialFeeSelectionChange(e){this.selectedOfficialFees=e},confirmOfficialFeeSelection(){0!==this.selectedOfficialFees.length?(this.selectedOfficialFees.forEach(e=>{const t={feeName:e.feeName,feeDescription:e.feeDescription,amount:e.amount,currency:"",exchangeRate:"",exchangeMethod:""};this.caseForm.officialFees.push(t)}),this.$message.success(`已添加 ${this.selectedOfficialFees.length} 项官费`),this.officialFeeDialogVisible=!1,this.selectedOfficialFees=[]):this.$message.warning("请选择至少一项费用")},cancelOfficialFeeSelection(){this.officialFeeDialogVisible=!1,this.selectedOfficialFees=[]}},async mounted(){await this.getCustomerList(),await this.getUserList(),this.$route.query.id&&await this.getContractDetail()}},y=v,g=(a("e011"),Object(p["a"])(y,s,l,!1,null,null,null));t["default"]=g.exports},"6dec":function(e,t,a){},8558:function(e,t,a){"use strict";var s=a("cfe9"),l=a("b5db"),i=a("c6b6"),r=function(e){return l.slice(0,e.length)===e};e.exports=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":s.Bun&&"string"==typeof Bun.version?"BUN":s.Deno&&"object"==typeof Deno.version?"DENO":"process"===i(s.process)?"NODE":s.window&&s.document?"BROWSER":"REST"}()},9485:function(e,t,a){"use strict";var s=a("23e7"),l=a("2266"),i=a("59ed"),r=a("825a"),o=a("46c4"),c=TypeError;s({target:"Iterator",proto:!0,real:!0},{reduce:function(e){r(this),i(e);var t=o(this),a=arguments.length<2,s=a?void 0:arguments[1],n=0;if(l(t,(function(t){a?(a=!1,s=t):s=e(s,t,n),n++}),{IS_RECORD:!0}),a)throw new c("Reduce of empty iterator with no initial value");return s}})},"9adc":function(e,t,a){"use strict";var s=a("8558");e.exports="NODE"===s},a640:function(e,t,a){"use strict";var s=a("d039");e.exports=function(e,t){var a=[][e];return!!a&&s((function(){a.call(null,t||function(){return 1},1)}))}},d58f:function(e,t,a){"use strict";var s=a("59ed"),l=a("7b0b"),i=a("44ad"),r=a("07fa"),o=TypeError,c="Reduce of empty array with no initial value",n=function(e){return function(t,a,n,p){var d=l(t),m=i(d),u=r(d);if(s(a),0===u&&n<2)throw new o(c);var f=e?u-1:0,h=e?-1:1;if(n<2)while(1){if(f in m){p=m[f],f+=h;break}if(f+=h,e?f<0:u<=f)throw new o(c)}for(;e?f>=0:u>f;f+=h)f in m&&(p=a(p,m[f],f,d));return p}};e.exports={left:n(!1),right:n(!0)}},d7c2:function(e,t,a){"use strict";a("48fb")},e011:function(e,t,a){"use strict";a("6dec")}}]);