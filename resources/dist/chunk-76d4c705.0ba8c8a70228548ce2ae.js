(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76d4c705"],{"19ca":function(t,e,a){},"492a":function(t,e,a){"use strict";a("19ca")},"570d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"payment-received-unclaimed-container"},[e("div",{staticClass:"body-part-search"},[e("el-form",{ref:"searchForm",attrs:{model:t.searchForm,"label-width":"100px"}},[e("el-row",[e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"到款单号",prop:"paymentNo"}},[e("el-input",{attrs:{placeholder:"到款单号",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.searchForm.paymentNo,callback:function(e){t.$set(t.searchForm,"paymentNo",e)},expression:"searchForm.paymentNo"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"付款方",prop:"payer"}},[e("el-input",{attrs:{placeholder:"付款方名称",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.searchForm.payer,callback:function(e){t.$set(t.searchForm,"payer",e)},expression:"searchForm.payer"}})],1)],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"金额范围",prop:"amountRange"}},[e("div",{staticClass:"amount-range"},[e("el-input",{staticStyle:{width:"45%"},attrs:{placeholder:"最小",size:"small"},model:{value:t.searchForm.minAmount,callback:function(e){t.$set(t.searchForm,"minAmount",e)},expression:"searchForm.minAmount"}}),e("span",{staticStyle:{margin:"0 2%"}},[t._v("-")]),e("el-input",{staticStyle:{width:"45%"},attrs:{placeholder:"最大",size:"small"},model:{value:t.searchForm.maxAmount,callback:function(e){t.$set(t.searchForm,"maxAmount",e)},expression:"searchForm.maxAmount"}})],1)])],1),e("el-col",{attrs:{span:6}},[e("el-form-item",{attrs:{label:"到账时间",prop:"receivedTimeRange"}},[e("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small","value-format":"yyyy-MM-dd"},model:{value:t.searchForm.receivedTimeRange,callback:function(e){t.$set(t.searchForm,"receivedTimeRange",e)},expression:"searchForm.receivedTimeRange"}})],1)],1)],1)],1),e("div",{staticClass:"part-search-buttons"},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("搜索")]),e("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:t.handleReset}},[t._v("重置")])],1)],1),e("div",{staticClass:"stats-container"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card"},[e("div",{staticClass:"stat-value"},[t._v(t._s(t.statistics.totalCount))]),e("div",{staticClass:"stat-label"},[t._v("待认领数量")])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card"},[e("div",{staticClass:"stat-value",staticStyle:{color:"#e6a23c"}},[t._v("¥"+t._s(t.statistics.totalAmount))]),e("div",{staticClass:"stat-label"},[t._v("待认领金额")])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card"},[e("div",{staticClass:"stat-value",staticStyle:{color:"#67c23a"}},[t._v(t._s(t.statistics.claimedToday))]),e("div",{staticClass:"stat-label"},[t._v("今日已认领")])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card"},[e("div",{staticClass:"stat-value",staticStyle:{color:"#f56c6c"}},[t._v(t._s(t.statistics.overdueDays))]),e("div",{staticClass:"stat-label"},[t._v("超期天数最长")])])])],1)],1),e("div",{staticClass:"body-part-content"},[e("div",{staticClass:"part-table-header"},[e("div",{staticClass:"part-table-title"},[t._v("待认领到款单")]),e("div",{staticClass:"part-table-operations"},[e("el-button",{attrs:{size:"small",type:"success",disabled:0===t.selectedRows.length},on:{click:t.handleBatchClaim}},[t._v("批量认领")]),e("el-button",{attrs:{size:"small",type:"info"},on:{click:t.handleExport}},[t._v("导出")])],1)]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",size:"small","row-class-name":t.tableRowClassName},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"80"}}),e("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),e("el-table-column",{attrs:{prop:"paymentNo",label:"到款单号",width:"140","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"amount",label:"到款金额",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"amount-text"},[t._v("¥"+t._s(a.row.amount))])]}}])}),e("el-table-column",{attrs:{prop:"currency",label:"币种",width:"80",align:"center"}}),e("el-table-column",{attrs:{prop:"payer",label:"付款方",width:"150","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"receivedTime",label:"到账时间",width:"150"}}),e("el-table-column",{attrs:{prop:"bankAccount",label:"收款账户",width:"150","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"transactionRef",label:"交易流水号",width:"140","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"waitingDays",label:"待认领天数",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getWaitingDaysType(a.row.waitingDays),size:"small"}},[t._v(" "+t._s(a.row.waitingDays)+"天 ")])]}}])}),e("el-table-column",{attrs:{prop:"remark",label:"备注","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.handleView(a.row)}}},[t._v("查看")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.handleClaim(a.row)}}},[t._v("认领")])]}}])})],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,50],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),e("el-dialog",{attrs:{title:"认领到款单",visible:t.claimDialogVisible,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(e){t.claimDialogVisible=e}}},[e("el-form",{ref:"claimFormRef",attrs:{model:t.claimForm,rules:t.claimRules,"label-width":"120px"}},[e("el-descriptions",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"到款信息",column:2,border:""}},[e("el-descriptions-item",{attrs:{label:"到款单号"}},[t._v(t._s(t.currentClaimRow.paymentNo))]),e("el-descriptions-item",{attrs:{label:"到款金额"}},[e("span",{staticClass:"amount-highlight"},[t._v("¥"+t._s(t.currentClaimRow.amount))])]),e("el-descriptions-item",{attrs:{label:"付款方"}},[t._v(t._s(t.currentClaimRow.payer))]),e("el-descriptions-item",{attrs:{label:"到账时间"}},[t._v(t._s(t.currentClaimRow.receivedTime))])],1),e("el-form-item",{attrs:{label:"选择客户",prop:"customerId"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择客户",filterable:"",remote:"","remote-method":t.searchCustomers,loading:t.customerLoading},model:{value:t.claimForm.customerId,callback:function(e){t.$set(t.claimForm,"customerId",e)},expression:"claimForm.customerId"}},t._l(t.customerList,(function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e("span",{staticStyle:{float:"left"}},[t._v(t._s(a.name))]),e("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(a.code))])])})),1)],1),e("el-form-item",{attrs:{label:"技术主导",prop:"techLeadId"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择技术主导"},model:{value:t.claimForm.techLeadId,callback:function(e){t.$set(t.claimForm,"techLeadId",e)},expression:"claimForm.techLeadId"}},t._l(t.techLeadList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),e("el-form-item",{attrs:{label:"关联合同",prop:"contractId"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择合同（可选）",filterable:"",clearable:""},model:{value:t.claimForm.contractId,callback:function(e){t.$set(t.claimForm,"contractId",e)},expression:"claimForm.contractId"}},t._l(t.contractList,(function(t){return e("el-option",{key:t.id,attrs:{label:`${t.contractNo} - ${t.contractName}`,value:t.id}})})),1),e("div",{staticStyle:{color:"#999","font-size":"12px","margin-top":"5px"}},[t._v(" 如果没有对应合同，可以不选择 ")])],1),e("el-form-item",{attrs:{label:"关联请款单",prop:"requestId"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择请款单（可选）",filterable:"",clearable:""},model:{value:t.claimForm.requestId,callback:function(e){t.$set(t.claimForm,"requestId",e)},expression:"claimForm.requestId"}},t._l(t.requestList,(function(t){return e("el-option",{key:t.id,attrs:{label:`${t.requestNo} - ¥${t.amount}`,value:t.id}})})),1),e("div",{staticStyle:{color:"#999","font-size":"12px","margin-top":"5px"}},[t._v(" 优先关联到请款单，如果没有对应请款单，则关联到合同 ")])],1),e("el-form-item",{attrs:{label:"认领备注",prop:"claimRemark"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入认领备注"},model:{value:t.claimForm.claimRemark,callback:function(e){t.$set(t.claimForm,"claimRemark",e)},expression:"claimForm.claimRemark"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.claimDialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary",loading:t.submitting},on:{click:t.handleConfirmClaim}},[t._v("确认认领")])],1)],1),e("el-dialog",{attrs:{title:"到款详情",visible:t.viewDialogVisible,width:"800px"},on:{"update:visible":function(e){t.viewDialogVisible=e}}},[e("el-descriptions",{attrs:{column:2,border:""}},[e("el-descriptions-item",{attrs:{label:"到款单号"}},[t._v(t._s(t.viewData.paymentNo))]),e("el-descriptions-item",{attrs:{label:"到款金额"}},[e("span",{staticClass:"amount-highlight"},[t._v("¥"+t._s(t.viewData.amount))])]),e("el-descriptions-item",{attrs:{label:"币种"}},[t._v(t._s(t.viewData.currency))]),e("el-descriptions-item",{attrs:{label:"汇率"}},[t._v(t._s(t.viewData.exchangeRate||"1.0"))]),e("el-descriptions-item",{attrs:{label:"付款方"}},[t._v(t._s(t.viewData.payer))]),e("el-descriptions-item",{attrs:{label:"付款方账户"}},[t._v(t._s(t.viewData.payerAccount))]),e("el-descriptions-item",{attrs:{label:"到账时间"}},[t._v(t._s(t.viewData.receivedTime))]),e("el-descriptions-item",{attrs:{label:"收款账户"}},[t._v(t._s(t.viewData.bankAccount))]),e("el-descriptions-item",{attrs:{label:"付款方式"}},[t._v(t._s(t.viewData.paymentMethod))]),e("el-descriptions-item",{attrs:{label:"交易流水号"}},[t._v(t._s(t.viewData.transactionRef))]),e("el-descriptions-item",{attrs:{label:"待认领天数"}},[e("el-tag",{attrs:{type:t.getWaitingDaysType(t.viewData.waitingDays),size:"small"}},[t._v(" "+t._s(t.viewData.waitingDays)+"天 ")])],1),e("el-descriptions-item",{attrs:{label:"备注",span:2}},[t._v(t._s(t.viewData.remark||"无"))])],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.viewDialogVisible=!1}}},[t._v("关闭")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleClaimFromView}},[t._v("认领")])],1)],1)],1)},l=[],s=(a("e9f5"),a("ab43"),{name:"PaymentReceivedUnclaimed",data(){return{loading:!1,submitting:!1,customerLoading:!1,searchForm:{paymentNo:"",payer:"",minAmount:"",maxAmount:"",receivedTimeRange:[]},tableData:[],selectedRows:[],currentPage:1,pageSize:10,total:0,statistics:{totalCount:0,totalAmount:"0",claimedToday:0,overdueDays:0},claimDialogVisible:!1,claimForm:{customerId:"",techLeadId:"",contractId:"",requestId:"",claimRemark:""},claimRules:{customerId:[{required:!0,message:"请选择客户",trigger:"change"}],techLeadId:[{required:!0,message:"请选择技术主导",trigger:"change"}]},currentClaimRow:{},customerList:[],techLeadList:[],contractList:[],requestList:[],viewDialogVisible:!1,viewData:{}}},created(){this.getList(),this.getStatistics(),this.initData()},methods:{getList(){this.loading=!0,setTimeout(()=>{this.tableData=Array.from({length:15}).map((t,e)=>{const a=new Date(Date.now()-15*Math.random()*24*60*60*1e3),i=Math.floor(3*Math.random())+1;return{id:e+1,paymentNo:"DK"+String(Date.now()+e).slice(-8),amount:(5e3+5e4*Math.random()).toFixed(2),currency:"CNY",payer:"付款公司"+(e+1),payerAccount:"****"+String(1e4*Math.random()).slice(-4),receivedTime:a.toLocaleString(),bankAccount:["工商银行 ****1234","建设银行 ****5678","招商银行 ****9012"][Math.floor(3*Math.random())],paymentMethod:["银行转账","电汇","支票"][Math.floor(3*Math.random())],transactionRef:"TXN"+String(Date.now()+e).slice(-12),waitingDays:i,remark:e%3===0?"到款备注信息"+(e+1):""}}),this.total=this.tableData.length,this.loading=!1},500)},getStatistics(){this.statistics={totalCount:48,totalAmount:"1,256,890.00",claimedToday:12,overdueDays:15}},initData(){this.techLeadList=[{id:"1",name:"张工程师"},{id:"2",name:"李工程师"},{id:"3",name:"王工程师"},{id:"4",name:"刘工程师"}],this.contractList=[{id:"1",contractNo:"HT202401001",contractName:"知识产权服务合同"},{id:"2",contractNo:"HT202401002",contractName:"专利申请代理合同"},{id:"3",contractNo:"HT202401003",contractName:"商标注册服务合同"}],this.requestList=[{id:"1",requestNo:"QK202401001",amount:"8500.00"},{id:"2",requestNo:"QK202401002",amount:"12300.00"},{id:"3",requestNo:"QK202401003",amount:"6750.00"}]},searchCustomers(t){""!==t?(this.customerLoading=!0,setTimeout(()=>{this.customerList=[{id:"1",name:"华为技术有限公司",code:"HW001"},{id:"2",name:"腾讯科技有限公司",code:"TX001"},{id:"3",name:"阿里巴巴集团",code:"AL001"},{id:"4",name:"百度在线网络技术有限公司",code:"BD001"}].filter(e=>e.name.toLowerCase().includes(t.toLowerCase())),this.customerLoading=!1},300)):this.customerList=[]},handleSearch(){this.currentPage=1,this.getList()},handleReset(){this.searchForm={paymentNo:"",payer:"",minAmount:"",maxAmount:"",receivedTimeRange:[]},this.getList()},handleSelectionChange(t){this.selectedRows=t},handleSizeChange(t){this.pageSize=t,this.getList()},handleCurrentChange(t){this.currentPage=t,this.getList()},tableRowClassName({row:t}){return t.waitingDays>=2?"warning-row":""},getWaitingDaysType(t){return t>=2?"danger":t>=1?"warning":""},handleView(t){this.viewData={...t},this.viewDialogVisible=!0},handleClaim(t){this.currentClaimRow=t,this.claimForm={customerId:"",techLeadId:"",contractId:"",requestId:"",claimRemark:""},this.claimDialogVisible=!0},handleClaimFromView(){this.viewDialogVisible=!1,this.handleClaim(this.viewData)},handleConfirmClaim(){this.$refs.claimFormRef.validate(t=>{t&&(this.submitting=!0,setTimeout(()=>{this.$message.success("认领成功"),this.claimDialogVisible=!1,this.submitting=!1,this.getList(),this.getStatistics()},1e3))})},handleReturn(t){this.$prompt("请输入退回原因","退回到款单",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.+/,inputErrorMessage:"退回原因不能为空"}).then(({value:t})=>{this.loading=!0,setTimeout(()=>{this.$message.success("退回成功"),this.loading=!1,this.getList()},1e3)})},handleBatchClaim(){this.$confirm(`确认批量认领选中的 ${this.selectedRows.length} 条到款单吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.info("批量认领功能开发中，请逐个认领")})},handleExport(){this.$message.info("导出功能开发中")}}}),o=s,r=(a("492a"),a("2877")),n=Object(r["a"])(o,i,l,!1,null,"436c2008",null);e["default"]=n.exports}}]);