(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e5ce9aec"],{b7cb:function(e,t,a){"use strict";a("c949")},c949:function(e,t,a){},d6e9:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tech-service-type-container"},[t("div",{staticClass:"content-wrapper"},[t("div",{staticClass:"left-tree"},[t("div",{staticClass:"search-area"},[t("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入关键词搜索",clearable:""},on:{input:e.handleSearch,clear:e.handleSearch},model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}}),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")])],1),t("div",{staticClass:"tree-section"},[t("el-tree",{staticClass:"tree-menu",attrs:{data:e.treeData,"node-key":"id","default-expanded-keys":e.expandedKeys,props:e.defaultProps},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function({node:a,data:r}){return[t("span",{staticClass:"tree-node"},[t("i",{class:e.getNodeIcon(r)}),t("span",{staticClass:"node-label"},[e._v(e._s(a.label))]),e.selectedNode&&e.selectedNode.id===r.id?t("span",{staticClass:"node-operations"},[r.level<3?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.handleTreeAdd(r,a)}}},[e._v(" 新增 ")]):e._e(),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.handleTreeEdit(r,a)}}},[e._v(" 编辑 ")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.handleTreeDelete(r,a)}}},[e._v(" 删除 ")])],1):e._e()])]}}])})],1)]),t("div",{staticClass:"right-content"},[e.selectedNode||e.selectedEnterprise||e.selectedTechCenter?t("div",{staticClass:"info-area"},[t("div",{staticClass:"info-header"},[t("h3",[e._v(e._s(e.getSelectedTitle()))])]),t("el-table",{attrs:{data:[e.getSelectedInfo()],border:""}},[t("el-table-column",{attrs:{align:"center",prop:"sequence",label:"序号",width:"80"}}),t("el-table-column",{attrs:{align:"center",prop:"applyType",label:"申请类型"}}),t("el-table-column",{attrs:{align:"center",prop:"serviceName",label:"科服名称","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{align:"center",prop:"serviceLevel",label:"科服级别",width:"120"}}),t("el-table-column",{attrs:{align:"center",prop:"mainArea",label:"主管地",width:"120"}}),t("el-table-column",{attrs:{align:"center",prop:"projectYear",label:"项目年份",width:"100"}}),t("el-table-column",{attrs:{align:"center",prop:"deadline",label:"申报截止日",width:"120"}}),t("el-table-column",{attrs:{align:"center",prop:"batchNumber",label:"申报批次",width:"100"}}),t("el-table-column",{attrs:{align:"center",prop:"sortOrder",label:"排序",width:"80"}}),t("el-table-column",{attrs:{align:"center",prop:"isEffective",label:"是否有效",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:a.row.isEffective?"success":"danger"}},[e._v(" "+e._s(a.row.isEffective?"有效":"无效")+" ")])]}}],null,!1,2633416153)})],1)],1):e._e(),e.selectedNode||e.selectedEnterprise||e.selectedTechCenter?t("div",{staticClass:"process-management"},[t("div",{staticClass:"process-header"},[t("h3",[e._v("处理事项管理")]),t("div",{staticClass:"process-buttons"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleAddProcess}},[e._v("添加处理事项")])],1)]),t("el-table",{staticClass:"process-table",staticStyle:{width:"100%"},attrs:{data:e.processData,border:""}},[t("el-table-column",{attrs:{align:"center",prop:"sequence",label:"序号",width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[e._v(e._s(a.$index+1))])]}}],null,!1,2749146133)}),t("el-table-column",{attrs:{align:"center",prop:"processName",label:"处理事项"}}),t("el-table-column",{attrs:{align:"center",prop:"expectedStartDate",label:"预计启动日",width:"120"}}),t("el-table-column",{attrs:{align:"center",prop:"internalDeadline",label:"内部期限",width:"120"}}),t("el-table-column",{attrs:{align:"center",prop:"officialDeadline",label:"官方期限",width:"120"}}),t("el-table-column",{attrs:{align:"center",prop:"updatedBy",label:"更新人",width:"100"}}),t("el-table-column",{attrs:{align:"center",prop:"updatedAt",label:"更新时间",width:"160"}}),t("el-table-column",{attrs:{align:"center",label:"操作",width:"240",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleProcessView(a.row)}}},[e._v("查看")]),t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleProcessEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.handleProcessDelete(a.row)}}},[e._v("删除")])]}}],null,!1,3370973021)})],1)],1):t("div",{staticClass:"empty-content"},[e._m(0)])])]),t("el-dialog",{staticClass:"custom-dialog",attrs:{title:e.categoryDialogTitle,visible:e.showCategoryDialog,width:"600px"},on:{"update:visible":function(t){e.showCategoryDialog=t},close:e.handleCategoryDialogClose},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.showCategoryDialog=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleCategorySave}},[e._v("保存")])],1)]},proxy:!0}])},[t("el-form",{ref:"categoryForm",attrs:{model:e.categoryForm,rules:e.categoryRules,"label-width":"120px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"申请类型",prop:"applyType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"成果类型目录"},model:{value:e.categoryForm.applyType,callback:function(t){e.$set(e.categoryForm,"applyType",t)},expression:"categoryForm.applyType"}},[t("el-option",{attrs:{label:"成果类型目录",value:"成果类型目录"}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"科服名称",prop:"serviceName"}},[t("el-input",{attrs:{placeholder:"科技成果转化项目"},model:{value:e.categoryForm.serviceName,callback:function(t){e.$set(e.categoryForm,"serviceName",t)},expression:"categoryForm.serviceName"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"主管地",prop:"mainArea"}},[t("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.areaOptions,props:{checkStrictly:!0,emitPath:!1},placeholder:"请选择"},on:{change:e.handleAreaChange},model:{value:e.categoryForm.mainAreaCascader,callback:function(t){e.$set(e.categoryForm,"mainAreaCascader",t)},expression:"categoryForm.mainAreaCascader"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"申报批次",prop:"batchNumber"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"输入数字",min:1},model:{value:e.categoryForm.batchNumber,callback:function(t){e.$set(e.categoryForm,"batchNumber",t)},expression:"categoryForm.batchNumber"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"是否有效",prop:"isValid"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"是或否"},model:{value:e.categoryForm.isValid,callback:function(t){e.$set(e.categoryForm,"isValid",t)},expression:"categoryForm.isValid"}},[t("el-option",{attrs:{label:"是",value:!0}}),t("el-option",{attrs:{label:"否",value:!1}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"排序",prop:"sortOrder"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"输入数字",min:1},model:{value:e.categoryForm.sortOrder,callback:function(t){e.$set(e.categoryForm,"sortOrder",t)},expression:"categoryForm.sortOrder"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新人",prop:"updatedBy"}},[t("el-input",{attrs:{placeholder:"系统记录",disabled:""},model:{value:e.categoryForm.updatedBy,callback:function(t){e.$set(e.categoryForm,"updatedBy",t)},expression:"categoryForm.updatedBy"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间",prop:"updatedAt"}},[t("el-input",{attrs:{placeholder:"系统记录",disabled:""},model:{value:e.categoryForm.updatedAt,callback:function(t){e.$set(e.categoryForm,"updatedAt",t)},expression:"categoryForm.updatedAt"}})],1)],1)],1)],1)],1),t("el-dialog",{staticClass:"custom-dialog",attrs:{title:e.subCategoryDialogTitle,visible:e.showSubCategoryDialog,width:"800px"},on:{"update:visible":function(t){e.showSubCategoryDialog=t},close:e.handleSubCategoryDialogClose},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.showSubCategoryDialog=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubCategorySave}},[e._v("保存")])],1)]},proxy:!0}])},[t("el-form",{ref:"subCategoryForm",attrs:{model:e.subCategoryForm,rules:e.subCategoryRules,"label-width":"120px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"申请类型",prop:"applyType"}},[t("el-input",{attrs:{disabled:""},model:{value:e.subCategoryForm.applyType,callback:function(t){e.$set(e.subCategoryForm,"applyType",t)},expression:"subCategoryForm.applyType"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"科服名称",prop:"serviceName"}},[t("el-input",{attrs:{placeholder:"科技成果转化项目"},model:{value:e.subCategoryForm.serviceName,callback:function(t){e.$set(e.subCategoryForm,"serviceName",t)},expression:"subCategoryForm.serviceName"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"科服级别",prop:"serviceLevel"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择级别"},model:{value:e.subCategoryForm.serviceLevel,callback:function(t){e.$set(e.subCategoryForm,"serviceLevel",t)},expression:"subCategoryForm.serviceLevel"}},[t("el-option",{attrs:{label:"国家级",value:"国家级"}}),t("el-option",{attrs:{label:"省级",value:"省级"}}),t("el-option",{attrs:{label:"市级",value:"市级"}}),t("el-option",{attrs:{label:"区级",value:"区级"}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"申报年份",prop:"projectYear"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择年份",filterable:"","allow-create":""},model:{value:e.subCategoryForm.projectYear,callback:function(t){e.$set(e.subCategoryForm,"projectYear",t)},expression:"subCategoryForm.projectYear"}},e._l(e.yearOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),t("el-form-item",{attrs:{label:"主管地",prop:"mainArea"}},[t("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.areaOptions,props:{checkStrictly:!0,value:"value",label:"label",children:"children"},placeholder:"请选择省份/市州/区县",clearable:""},on:{change:e.handleAreaChange},model:{value:e.subCategoryForm.mainAreaCascader,callback:function(t){e.$set(e.subCategoryForm,"mainAreaCascader",t)},expression:"subCategoryForm.mainAreaCascader"}})],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"是否有效",prop:"isValid"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"是或否"},model:{value:e.subCategoryForm.isValid,callback:function(t){e.$set(e.subCategoryForm,"isValid",t)},expression:"subCategoryForm.isValid"}},[t("el-option",{attrs:{label:"是",value:!0}}),t("el-option",{attrs:{label:"否",value:!1}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"申报截止日",prop:"deadline"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"年/月/日",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.subCategoryForm.deadline,callback:function(t){e.$set(e.subCategoryForm,"deadline",t)},expression:"subCategoryForm.deadline"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"排序",prop:"sortOrder"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"输入数字",min:1},model:{value:e.subCategoryForm.sortOrder,callback:function(t){e.$set(e.subCategoryForm,"sortOrder",t)},expression:"subCategoryForm.sortOrder"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新人",prop:"updatedBy"}},[t("el-input",{attrs:{placeholder:"系统记录",disabled:""},model:{value:e.subCategoryForm.updatedBy,callback:function(t){e.$set(e.subCategoryForm,"updatedBy",t)},expression:"subCategoryForm.updatedBy"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间",prop:"updatedAt"}},[t("el-input",{attrs:{placeholder:"系统记录",disabled:""},model:{value:e.subCategoryForm.updatedAt,callback:function(t){e.$set(e.subCategoryForm,"updatedAt",t)},expression:"subCategoryForm.updatedAt"}})],1)],1)],1)],1)],1),t("el-dialog",{staticClass:"custom-dialog",attrs:{title:e.processDialogTitle,visible:e.showProcessDialog,width:"600px"},on:{"update:visible":function(t){e.showProcessDialog=t},close:e.handleProcessDialogClose},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.showProcessDialog=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleProcessSave}},[e._v("保存")])],1)]},proxy:!0}])},[t("el-form",{ref:"processForm",attrs:{model:e.processForm,rules:e.processRules,"label-width":"120px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"处理事项名称",prop:"processName"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择处理事项名称",filterable:"",clearable:""},model:{value:e.processForm.processName,callback:function(t){e.$set(e.processForm,"processName",t)},expression:"processForm.processName"}},e._l(e.processItemOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"处理状态",prop:"processStatus"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"列表选取"},model:{value:e.processForm.processStatus,callback:function(t){e.$set(e.processForm,"processStatus",t)},expression:"processForm.processStatus"}},[t("el-option",{attrs:{label:"待处理",value:"pending"}}),t("el-option",{attrs:{label:"处理中",value:"processing"}}),t("el-option",{attrs:{label:"已完成",value:"completed"}})],1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"预计启动日",prop:"expectedStartDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"年/月/日",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.processForm.expectedStartDate,callback:function(t){e.$set(e.processForm,"expectedStartDate",t)},expression:"processForm.expectedStartDate"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"预计完成日",prop:"expectedCompletionDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"年/月/日",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.processForm.expectedCompletionDate,callback:function(t){e.$set(e.processForm,"expectedCompletionDate",t)},expression:"processForm.expectedCompletionDate"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"官方期限",prop:"officialDeadline"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"年/月/日",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.processForm.officialDeadline,callback:function(t){e.$set(e.processForm,"officialDeadline",t)},expression:"processForm.officialDeadline"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"是否有效",prop:"isEffective"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"是或否"},model:{value:e.processForm.isEffective,callback:function(t){e.$set(e.processForm,"isEffective",t)},expression:"processForm.isEffective"}},[t("el-option",{attrs:{label:"是",value:!0}}),t("el-option",{attrs:{label:"否",value:!1}})],1)],1)],1)],1)],1)],1)],1)},s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"empty-state"},[t("i",{staticClass:"el-icon-folder-opened"}),t("h3",[e._v("请选择左侧分类查看详情")]),t("p",[e._v("选择成果类型目录、高新技术企业认定或企业技术中心来查看相关信息")])])}],l=(a("14d9"),a("e9f5"),a("f665"),a("7d54"),a("ab43"),{name:"TechServiceTypeConfig",data(){return{loading:!1,searchForm:{keyword:""},treeData:[{id:1,label:"科技成果转化项目",level:1,children:[{id:11,label:"四川省2022",level:2,children:[{id:111,label:"成都市2023",level:3}]}]}],expandedKeys:[1,11],defaultProps:{children:"children",label:"label"},selectedNode:null,enterpriseList:[{id:1,name:"成都市",level:"市级",year:"2023"}],selectedEnterprise:null,techCenterList:[{id:1,name:"成都高新区2022",level:"区级",year:"2022"},{id:2,name:"德阳市2023",level:"市级",year:"2023"}],selectedTechCenter:null,processData:[],currentPage:1,totalPages:1,showCategoryDialog:!1,categoryDialogTitle:"新增类型弹窗",categoryForm:{applyType:"",serviceName:"",mainArea:"",mainAreaCascader:[],batchNumber:1,isValid:!0,sortOrder:1,updatedBy:"系统记录",updatedAt:"系统记录"},categoryRules:{applyType:[{required:!0,message:"请选择申请类型",trigger:"change"}],serviceName:[{required:!0,message:"请输入科服名称",trigger:"blur"}],mainArea:[{required:!0,message:"请选择主管地",trigger:"change"}],batchNumber:[{required:!0,message:"请输入申报批次",trigger:"blur"}],isValid:[{required:!0,message:"请选择是否有效",trigger:"change"}],sortOrder:[{required:!0,message:"请输入排序",trigger:"blur"}]},showSubCategoryDialog:!1,subCategoryDialogTitle:"新增类型弹窗",subCategoryForm:{applyType:"",serviceName:"",serviceLevel:"",mainAreaCascader:[],projectYear:"",isValid:!0,deadline:"",sortOrder:1,updatedBy:"系统记录",updatedAt:"系统记录"},subCategoryRules:{serviceName:[{required:!0,message:"请输入科服名称",trigger:"blur"}],serviceLevel:[{required:!0,message:"请选择科服级别",trigger:"change"}],projectYear:[{required:!0,message:"请选择申报年份",trigger:"change"}],isValid:[{required:!0,message:"请选择是否有效",trigger:"change"}],sortOrder:[{required:!0,message:"请输入排序",trigger:"blur"}]},showProcessDialog:!1,processDialogTitle:"添加处理事项",processForm:{processName:"",processStatus:"",expectedStartDate:"",expectedCompletionDate:"",officialDeadline:"",isEffective:!0},processRules:{processName:[{required:!0,message:"请选择处理事项名称",trigger:"change"}],processStatus:[{required:!0,message:"请选择处理状态",trigger:"change"}],expectedStartDate:[{required:!0,message:"请选择预计启动日",trigger:"change"}],expectedCompletionDate:[{required:!0,message:"请选择预计完成日",trigger:"change"}],officialDeadline:[{required:!0,message:"请选择官方期限",trigger:"change"}]},areaOptions:[{value:"110000",label:"北京市",children:[{value:"110100",label:"北京市",children:[{value:"110101",label:"东城区"},{value:"110102",label:"西城区"},{value:"110105",label:"朝阳区"},{value:"110106",label:"丰台区"},{value:"110108",label:"海淀区"}]}]},{value:"510000",label:"四川省",children:[{value:"510100",label:"成都市",children:[{value:"510104",label:"锦江区"},{value:"510105",label:"青羊区"},{value:"510106",label:"金牛区"},{value:"510107",label:"武侯区"},{value:"510108",label:"成华区"}]},{value:"510700",label:"绵阳市",children:[{value:"510703",label:"涪城区"},{value:"510704",label:"游仙区"},{value:"510705",label:"安州区"}]}]},{value:"320000",label:"江苏省",children:[{value:"320100",label:"南京市",children:[{value:"320102",label:"玄武区"},{value:"320104",label:"秦淮区"},{value:"320105",label:"建邺区"},{value:"320106",label:"鼓楼区"}]},{value:"320200",label:"无锡市",children:[{value:"320205",label:"锡山区"},{value:"320206",label:"惠山区"},{value:"320211",label:"滨湖区"}]}]}],processItemOptions:[],yearOptions:[]}},created(){this.initYearOptions(),this.initProcessData(),this.loadAreaData(),this.loadTreeData()},methods:{loadAreaData(){console.log("地区数据已加载，共",this.areaOptions.length,"个省份")},async loadProcessItemsByApplyType(e){if(e)try{const a=await this.$api.dataConfig.processInformation.getByApplyType({apply_type:e});var t;if(a.data&&0===a.data.code)this.processItemOptions=a.data.data||[];else console.error("获取处理事项失败:",null===(t=a.data)||void 0===t?void 0:t.msg),this.processItemOptions=[]}catch(a){console.error("获取处理事项失败:",a),this.processItemOptions=[]}else this.processItemOptions=[]},async loadTreeData(){this.loading=!0;try{const e={keyword:this.searchForm.keyword},t=await this.$api.dataConfig.techServiceRegion.getTreeData(e);t.data&&0===t.data.code?(this.treeData=t.data.data||[],this.expandedKeys=[],this.treeData.forEach(e=>{this.expandedKeys.push(e.id),e.children&&e.children.forEach(e=>{this.expandedKeys.push(e.id)})})):this.$message.error(t.data&&t.data.msg||"获取树形数据失败")}catch(e){console.error("获取科技服务类型失败:",e),this.$message.error("获取列表失败")}finally{this.loading=!1}},initYearOptions(){const e=(new Date).getFullYear();for(let t=e-10;t<=e+10;t++)this.yearOptions.push(t.toString())},initProcessData(){this.processData=[]},async loadProcessData(){if(this.selectedNode&&this.selectedNode.record)try{const e=this.selectedNode.record.id,t=await this.$api.dataConfig.techServiceItem.getByRegionId(e);t.data&&0===t.data.code?this.processData=t.data.data.map(e=>({id:e.id,processName:e.name,expectedStartDate:e.expected_start_date,internalDeadline:e.internal_deadline,officialDeadline:e.official_deadline,updatedBy:e.updater,updatedAt:e.updated_at,description:e.description,status:e.status})):(this.$message.error(t.data&&t.data.msg||"获取处理事项失败"),this.processData=[])}catch(e){console.error("获取处理事项失败:",e),this.$message.error("获取处理事项失败"),this.processData=[]}else this.processData=[]},getNodeIcon(e){return 1===e.level?"el-icon-folder":2===e.level?"el-icon-folder-opened":"el-icon-document"},getSelectedTitle(){return this.selectedNode?this.selectedNode.label+" 详情":this.selectedEnterprise?this.selectedEnterprise.name+" 详情":this.selectedTechCenter?this.selectedTechCenter.name+" 详情":""},getSelectedInfo(){const e={sequence:1,applyType:"",serviceName:"",serviceLevel:"",mainArea:"",projectYear:"",deadline:"",batchNumber:"",sortOrder:"",isEffective:!0};if(this.selectedNode&&this.selectedNode.record){const t=this.selectedNode.record;return{...e,applyType:t.apply_type||"",serviceName:t.service_name||"",serviceLevel:t.service_level||"",mainArea:t.main_area||"",projectYear:t.project_year||"",deadline:t.deadline||"",batchNumber:t.batch_number||"",sortOrder:t.sort_order||"",isEffective:1===t.status}}return this.selectedNode?{...e,applyType:this.selectedNode.apply_type||this.selectedNode.label,serviceName:this.selectedNode.service_name||this.selectedNode.label,serviceLevel:1===this.selectedNode.level?"国家级":2===this.selectedNode.level?"省级":"市级",mainArea:1===this.selectedNode.level?"全国":"四川省",projectYear:"2024",deadline:"2024-12-31",batchNumber:"1",sortOrder:"1"}:this.selectedEnterprise?{...e,applyType:"高新技术企业认定",serviceName:this.selectedEnterprise.name,serviceLevel:this.selectedEnterprise.level,mainArea:this.selectedEnterprise.name,projectYear:this.selectedEnterprise.year,deadline:"2023-12-31",batchNumber:"1",sortOrder:"1"}:this.selectedTechCenter?{...e,applyType:"企业技术中心",serviceName:this.selectedTechCenter.name,serviceLevel:this.selectedTechCenter.level,mainArea:this.selectedTechCenter.name.includes("成都")?"成都市":"德阳市",projectYear:this.selectedTechCenter.year,deadline:"2023-12-31",batchNumber:"1",sortOrder:"1"}:e},handleSearch(){this.loadTreeData()},handleNodeClick(e){this.selectedNode=e,this.selectedEnterprise=null,this.selectedTechCenter=null,this.loadProcessData()},handleEnterpriseClick(e){this.selectedEnterprise=e,this.selectedNode=null,this.selectedTechCenter=null},handleEnterpriseAdd(){console.log("新增企业认定")},handleEnterpriseEdit(e){console.log("编辑企业:",e)},handleEnterpriseDelete(e){console.log("删除企业:",e)},handleTechCenterClick(e){this.selectedTechCenter=e,this.selectedNode=null,this.selectedEnterprise=null},handleTechCenterAdd(){console.log("新增技术中心")},handleTechCenterEdit(e){console.log("编辑技术中心:",e)},handleTechCenterDelete(e){console.log("删除技术中心:",e)},handleTreeAdd(e,t){2===e.level?(this.subCategoryDialogTitle="新增科服地区",this.subCategoryForm={applyType:e.apply_type||"",serviceName:e.label||"",serviceLevel:"",mainAreaCascader:[],projectYear:(new Date).getFullYear().toString(),isValid:!0,deadline:"",sortOrder:1,updatedBy:"系统记录",updatedAt:"系统记录"},this.showSubCategoryDialog=!0):this.$message.info("只能在科技服务名称下新增科服地区")},handleTreeEdit(e,t){if(3===e.level&&e.record){const t=e.record;return this.subCategoryDialogTitle="编辑科服地区",this.subCategoryForm={id:t.id,applyType:t.apply_type||"",serviceName:t.service_name||"",serviceLevel:t.service_level||"",mainAreaCascader:this.parseMainAreaToCascader(t.main_area),projectYear:t.project_year||"",isValid:1===t.status,deadline:t.deadline||"",sortOrder:t.sort_order||1,updatedBy:t.updater||"系统记录",updatedAt:t.updated_at||t.created_at||"系统记录"},void(this.showSubCategoryDialog=!0)}this.$message.info("只能编辑科服地区（三级节点）")},async handleTreeDelete(e,t){3===e.level&&e.record&&e.record.id?this.$confirm("确认删除该科服地区？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=await this.$api.dataConfig.techServiceRegion.delete(e.record.id);t.data&&0===t.data.code?(this.$message.success("删除成功"),this.loadTreeData(),this.selectedNode&&this.selectedNode.id===e.id&&(this.selectedNode=null,this.processData=[])):this.$message.error(t.data&&t.data.msg||"删除失败")}catch(t){console.error("删除失败:",t),this.$message.error("删除失败，请稍后重试")}}):this.$message.info("只能删除科服地区（三级节点）")},getParentApplyType(e){return e.parentApplyType||"成果类型目录"},async handleAddProcess(){if(!this.selectedNode||!this.selectedNode.record)return void this.$message.error("请先选择科服地区");const e=this.selectedNode.record.apply_type;e&&await this.loadProcessItemsByApplyType(e),this.processDialogTitle="添加处理事项",this.processForm={id:null,processName:"",processStatus:"pending",expectedStartDate:"",expectedCompletionDate:"",officialDeadline:"",isEffective:!0},this.showProcessDialog=!0},handleProcessView(e){this.processDialogTitle="查看处理事项",this.processForm={id:e.id,processName:e.processName,processStatus:"pending",expectedStartDate:e.expectedStartDate,expectedCompletionDate:e.internalDeadline,officialDeadline:e.officialDeadline,isEffective:1===e.status},this.showProcessDialog=!0},handleProcessEdit(e){this.processDialogTitle="编辑处理事项",this.processForm={id:e.id,processName:e.processName,processStatus:"pending",expectedStartDate:e.expectedStartDate,expectedCompletionDate:e.internalDeadline,officialDeadline:e.officialDeadline,isEffective:1===e.status},this.showProcessDialog=!0},async handleProcessDelete(e){this.$confirm("确认删除该处理事项？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=await this.$api.dataConfig.techServiceItem.delete(e.id);t.data&&0===t.data.code?(this.$message.success("删除成功"),this.loadProcessData()):this.$message.error(t.data&&t.data.msg||"删除失败")}catch(t){console.error("删除处理事项失败:",t),this.$message.error("删除失败，请稍后重试")}})},async handleProcessSave(){this.selectedNode&&this.selectedNode.record?this.$refs.processForm.validate(async e=>{if(e)try{const e={tech_service_region_id:this.selectedNode.record.id,name:this.processForm.processName,code:this.processForm.processName.toLowerCase().replace(/\s+/g,"_")+"_"+Date.now(),description:this.processForm.processName+"处理事项",expected_start_date:this.processForm.expectedStartDate,internal_deadline:this.processForm.expectedCompletionDate,official_deadline:this.processForm.officialDeadline,status:this.processForm.isEffective?1:0,sort_order:this.processData.length+1,updater:"系统管理员"};let t;t=this.processForm.id?await this.$api.dataConfig.techServiceItem.update(this.processForm.id,e):await this.$api.dataConfig.techServiceItem.create(e),t.data&&0===t.data.code?(this.$message.success("保存成功"),this.showProcessDialog=!1,this.loadProcessData()):this.$message.error(t.data&&t.data.msg||"保存失败")}catch(t){console.error("保存处理事项失败:",t),this.$message.error("保存失败，请稍后重试")}}):this.$message.error("请先选择科服地区")},handleAreaChange(e){if(e&&e.length>0){const t=(e,a,r=0)=>{if(r>=a.length)return"";const s=a[r],l=e.find(e=>e.value===s);if(!l)return"";if(r===a.length-1)return l.label;const o=t(l.children||[],a,r+1);return o?l.label+o:l.label},a=t(this.areaOptions,e);this.subCategoryForm.mainArea=a}else this.subCategoryForm.mainArea=""},handleCategorySave(){this.$refs.categoryForm.validate(async e=>{if(e)try{const e={name:this.categoryForm.serviceName,code:(this.categoryForm.serviceName||"").toString().trim().toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_\u4e00-\u9fa5]/g,""),apply_type:this.categoryForm.applyType,main_area:Array.isArray(this.categoryForm.mainAreaCascader)?this.categoryForm.mainAreaCascader.join("/"):this.categoryForm.mainArea||"",batch_number:this.categoryForm.batchNumber||1,status:this.categoryForm.isValid?1:0,sort_order:this.categoryForm.sortOrder||1,updater:this.categoryForm.updatedBy||"系统记录"};let t;t=this.categoryForm.id?await this.$api.dataConfig.techServiceType.update(this.categoryForm.id,e):await this.$api.dataConfig.techServiceType.create(e),t.data&&0===t.data.code?(this.$message.success("保存成功"),this.showCategoryDialog=!1,this.loadTreeData()):this.$message.error(t.data&&t.data.msg||"保存失败")}catch(t){console.error("保存失败:",t),this.$message.error("保存失败，请稍后重试")}})},parseMainAreaToCascader(e){if(!e||!this.areaOptions.length)return[];const t=(e,a,r=[])=>{for(const s of e){const e=[...r,s.value];if(s.label===a)return e;if(s.children&&s.children.length>0){const r=t(s.children,a,e);if(r.length>0)return r}}return[]};return t(this.areaOptions,e)},checkCategoryExists(e,t){return!1},handleSubCategorySave(){this.$refs.subCategoryForm.validate(async e=>{if(e)try{const e=this.subCategoryForm.mainArea||"",t={apply_type:this.subCategoryForm.applyType,service_name:this.subCategoryForm.serviceName,service_level:this.subCategoryForm.serviceLevel,main_area:e,project_year:this.subCategoryForm.projectYear,deadline:this.subCategoryForm.deadline||null,batch_number:1,is_valid:this.subCategoryForm.isValid?1:0,sort_order:this.subCategoryForm.sortOrder||1,updater:this.subCategoryForm.updatedBy||"系统管理员",description:`${this.subCategoryForm.applyType} - ${this.subCategoryForm.serviceName} - ${e} ${this.subCategoryForm.projectYear}`};let a;a=this.subCategoryForm.id?await this.$api.dataConfig.techServiceRegion.update(this.subCategoryForm.id,t):await this.$api.dataConfig.techServiceRegion.create(t),a.data&&0===a.data.code?(this.$message.success("保存成功"),this.showSubCategoryDialog=!1,this.loadTreeData()):this.$message.error(a.data&&a.data.msg||"保存失败")}catch(t){console.error("保存失败:",t),this.$message.error("保存失败，请稍后重试")}})},handleCategoryDialogClose(){this.$refs.categoryForm&&this.$refs.categoryForm.clearValidate()},handleSubCategoryDialogClose(){this.$refs.subCategoryForm&&this.$refs.subCategoryForm.clearValidate()},handleProcessDialogClose(){this.$refs.processForm&&this.$refs.processForm.clearValidate()}}}),o=l,i=(a("b7cb"),a("2877")),c=Object(i["a"])(o,r,s,!1,null,"08d01a2c",null);t["default"]=c.exports}}]);