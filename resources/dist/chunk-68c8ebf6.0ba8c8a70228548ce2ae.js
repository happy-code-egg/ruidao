(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68c8ebf6"],{"05d8":function(e,t,a){"use strict";var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"case-list"},[t("div",{staticClass:"body-part-search"},[t("el-form",{staticClass:"form-inline",attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",{attrs:{label:"客户名称",prop:"customerName"}},[t("el-input",{attrs:{placeholder:"客户名称",clearable:"",size:"small"},model:{value:e.searchForm.customerName,callback:function(t){e.$set(e.searchForm,"customerName",t)},expression:"searchForm.customerName"}})],1),t("el-form-item",{attrs:{label:"立项编号",prop:"caseNumber"}},[t("el-input",{attrs:{placeholder:"立项编号",clearable:"",size:"small"},model:{value:e.searchForm.caseNumber,callback:function(t){e.$set(e.searchForm,"caseNumber",t)},expression:"searchForm.caseNumber"}})],1),"to-be-filed"===e.type||"to-be-pending"===e.type?t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("el-select",{attrs:{placeholder:"请选择状态",clearable:"",size:"small"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[t("el-option",{attrs:{label:"草稿",value:"draft"}}),t("el-option",{attrs:{label:"审核中",value:"pending"}}),t("el-option",{attrs:{label:"已提交",value:"to-be-filed"}})],1)],1):e._e(),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("el-button",{attrs:{size:"small"},on:{click:e.resetSearch}},[e._v("重置")])],1)],1)],1),t("div",{staticClass:"body-part-content"},[t("div",{staticClass:"part-table-header"},[t("div",{staticClass:"part-table-title"},[e._v(" "+e._s(e.typeMap[e.type])+" ")])]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",size:"small"}},[t("el-table-column",{attrs:{type:"selection",width:"80",align:"center"}}),t("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t("el-table-column",{attrs:{prop:"customerName",label:"客户名称","min-width":"120"}}),t("el-table-column",{attrs:{prop:"contractCode",label:"合同代码","min-width":"100"}}),t("el-table-column",{attrs:{prop:"caseType",label:"项目类型","min-width":"100"}}),t("el-table-column",{attrs:{prop:"businessType",label:"业务类型","min-width":"100"}}),t("el-table-column",{attrs:{prop:"applyType",label:"申请类型","min-width":"100"}}),t("el-table-column",{attrs:{prop:"caseNumber",label:"立项编号","min-width":"120"}}),t("el-table-column",{attrs:{prop:"caseName",label:"提案名称","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"technicalDirector",label:"技术主导","min-width":"120","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"amount",label:"金额","min-width":"100"}}),t("el-table-column",{attrs:{prop:"serviceFee",label:"服务费","min-width":"100"}}),t("el-table-column",{attrs:{prop:"officialFee",label:"官费","min-width":"100"}}),t("el-table-column",{attrs:{prop:"creator",label:"创建人","min-width":"100"}}),t("el-table-column",{attrs:{prop:"processingTime",label:"最后处理时间"}}),t("el-table-column",{attrs:{prop:"preSales",label:"售前支持","min-width":"100"}}),t("el-table-column",{attrs:{prop:"caseHandler",label:"当前处理人","min-width":"120"}}),t("el-table-column",{attrs:{prop:"trademarkType",label:"商标类别","min-width":"100"}}),t("el-table-column",{attrs:{prop:"company",label:"乙方签约公司","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"agencyStructure",label:"代理机构","min-width":"100"}}),t("el-table-column",{attrs:{prop:"technicalDirector",label:"项目技术主导","min-width":"120","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"remark",label:"项目备注","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"操作",fixed:"right",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return["draft"===e.type||"pending"===e.type?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("立项")]):e._e(),"to-be-filed"===e.type||"to-be-pending"===e.type||"filed"===e.type?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleViewDetail(a.row)}}},[e._v("查看详情")]):e._e(),"to-be-filed"===e.type||"to-be-pending"===e.type||"filed"===e.type?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]):e._e(),"draft"===e.type?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")]):e._e()]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.pagination.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},l=[],r=(a("14d9"),a("d4f4")),i=a("f6b0"),n={name:"CaseList",props:{type:{type:String,required:!0,validator:function(e){return-1!==["draft","pending","to-be-filed","filed","to-be-pending"].indexOf(e)}},caseType:{type:String,default:"all",validator:function(e){return-1!==["all","patent","trademark","copyright","project"].indexOf(e)}},businessType:{type:String,default:"all"}},data(){return{loading:!1,searchForm:{customerName:"",caseNumber:"",status:""},tableData:[],pagination:{currentPage:1,pageSize:10,total:0},typeMap:{draft:"草稿",pending:"待立项","to-be-filed":"立项中",filed:"已立项","to-be-pending":"待处理"}}},created(){this.fetchData()},watch:{caseType:{handler(){this.fetchData()}},businessType:{handler(){this.fetchData()}}},methods:{async fetchData(){this.loading=!0;try{const e={case_status:this.type,customer_name:this.searchForm.customerName,case_number:this.searchForm.caseNumber,page:this.pagination.currentPage,page_size:this.pagination.pageSize};this.caseType&&"all"!==this.caseType&&(e.case_type=this.caseType),this.businessType&&"all"!==this.businessType&&(e.business_type=this.businessType);const t=await r["a"].getCaseList(e);t.data.success?(this.tableData=t.data.data.list,this.pagination.total=t.data.data.total,this.pagination.currentPage=t.data.data.current_page):this.$message.error(t.data.message||"获取数据失败")}catch(e){console.error("获取项目列表失败:",e),this.$message.error("获取数据失败，请稍后重试"),this.useMockData()}finally{this.loading=!1}},useMockData(){const e=[];let t=e;if("all"!==this.caseType){const a={patent:"专利",trademark:"商标",copyright:"版权",project:"科服"},s=a[this.caseType];t=e.filter(e=>e.caseType===s)}this.tableData=t,this.pagination.total=t.length},handleSearch(){this.pagination.currentPage=1,this.fetchData()},resetSearch(){this.searchForm={customerName:"",caseNumber:"",status:""},this.handleSearch()},handleSizeChange(e){this.pagination.pageSize=e,this.fetchData()},handleCurrentChange(e){this.pagination.currentPage=e,this.fetchData()},async handleEdit(e){try{let a=e.id;if("pending"===this.type){const s=await i["a"].createCaseFromRecord(e.id);var t;if(!s.data||!s.data.success)return void this.$message.error("创建立项数据失败："+((null===(t=s.data)||void 0===t?void 0:t.message)||"未知错误"));a=s.data.data.case_id,this.$message.success("立项数据创建成功")}let s="";const l=e.caseType||e.case_type;"专利"===l?s="/contract/case/edit-patent":"商标"===l?s="/contract/case/edit-trademark":"版权"===l?s="/contract/case/edit-copyright":"科服"===l&&(s="/contract/case/edit-project"),this.$router.push({path:s,query:{id:a,type:"pending"===this.type?"draft":this.type,from:this.type,customerId:e.customerId||e.customer_id,contractId:e.contractId||e.contract_id}})}catch(a){console.error("处理立项失败:",a),this.$message.error("操作失败，请稍后重试")}},handleViewDetail(e){let t="";const a=e.caseType||e.case_type;if("专利"===a)t="/contract/case/edit-patent";else if("商标"===a)t="/contract/case/edit-trademark";else if("版权"===a)t="/contract/case/edit-copyright";else{if("科服"!==a)return void this.$message.error("未知的项目类型");t="/contract/case/edit-project"}this.$router.push({path:t,query:{id:e.id,type:"view",from:this.type}})},async handleDelete(e){try{await this.$confirm("确认删除该项目?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const t=await r["a"].deleteCase(e.id);t.data.success?(this.$message({type:"success",message:"删除成功!"}),this.fetchData()):this.$message.error(t.data.message||"删除失败")}catch(t){"cancel"!==t&&(console.error("删除项目失败:",t),this.$message.error("删除失败，请稍后重试"))}}}},o=n,c=a("2877"),p=Object(c["a"])(o,s,l,!1,null,null,null);t["a"]=p.exports},6645:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"to-be-pending-list"},[t("case-list",{attrs:{type:"to-be-pending","case-type":e.businessType}})],1)},l=[],r=a("05d8"),i={name:"ToBePendingList",components:{CaseList:r["a"]},data(){return{businessType:"all"}},methods:{handleTypeChange(){}}},n=i,o=(a("9e79"),a("2877")),c=Object(o["a"])(n,s,l,!1,null,null,null);t["default"]=c.exports},"9e79":function(e,t,a){"use strict";a("e358")},d4f4:function(e,t,a){"use strict";var s=a("c1fb"),l=a("a417");t["a"]={getCaseList(e){return s["a"].get(l["a"].host+"/api/contract-cases",{params:e})},getCase(e){return s["a"].get(l["a"].host+"/api/contract-cases/"+e)},createCase(e){return s["a"].post(l["a"].host+"/api/contract-cases",e)},updateCase(e,t){return s["a"].put(l["a"].host+"/api/contract-cases/"+e,t)},updatePatentCase(e,t){return s["a"].put(l["a"].host+"/api/contract-cases/"+e,t)},deleteCase(e){return s["a"].delete(l["a"].host+"/api/contract-cases/"+e)},startCaseWorkflow(e,t){return s["a"].post(l["a"].host+"/api/contract-cases/"+e+"/start-workflow",t)},getCaseStatusOptions(){return s["a"].get(l["a"].host+"/api/contract-cases/options/case-statuses")},getCaseTypeOptions(){return[{label:"全部",value:"all"},{label:"专利",value:"patent"},{label:"商标",value:"trademark"},{label:"版权",value:"copyright"},{label:"科服",value:"project"}]},getBusinessTypeOptions(){return[{label:"发明专利",value:"发明专利"},{label:"实用新型",value:"实用新型"},{label:"外观设计",value:"外观设计"},{label:"商标注册",value:"商标注册"},{label:"商标续展",value:"商标续展"},{label:"商标变更",value:"商标变更"},{label:"软件著作权",value:"软件著作权"},{label:"作品著作权",value:"作品著作权"},{label:"高新认定",value:"高新认定"},{label:"科技项目",value:"科技项目"},{label:"其他",value:"其他"}]},getApplyTypeOptions(){return[{label:"国内申请",value:"国内申请"},{label:"国际申请",value:"国际申请"},{label:"PCT申请",value:"PCT申请"},{label:"科技项目",value:"科技项目"},{label:"其他",value:"其他"}]},getStatusOptions(){return[{label:"草稿",value:"draft"},{label:"审核中",value:"pending"},{label:"已提交",value:"to-be-filed"}]}}},e358:function(e,t,a){}}]);