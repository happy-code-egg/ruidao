(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-95b7e00e"],{"8e07":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"patent-import-container"},[t._m(0),e("div",{staticClass:"import-actions"},[e("el-card",{staticClass:"action-card"},[e("div",{staticClass:"action-item"},[e("div",{staticClass:"action-info"},[e("i",{staticClass:"el-icon-download"}),e("div",{staticClass:"action-text"},[e("h3",[t._v("下载导入模板")]),e("p",[t._v("下载标准的专利导入模板，包含必填字段说明")])])]),e("el-button",{attrs:{type:"primary",loading:t.downloadLoading},on:{click:t.downloadTemplate}},[e("i",{staticClass:"el-icon-download"}),t._v(" 下载专利模板 ")])],1)]),e("el-card",{staticClass:"action-card"},[e("div",{staticClass:"action-item"},[e("div",{staticClass:"action-info"},[e("i",{staticClass:"el-icon-upload2"}),e("div",{staticClass:"action-text"},[e("h3",[t._v("上传Excel数据")]),e("p",[t._v("支持.xlsx和.xls格式，单次最多导入1000条记录")])])]),e("el-upload",{ref:"upload",staticClass:"upload-component",attrs:{action:t.uploadUrl,"before-upload":t.beforeUpload,"on-success":t.handleUploadSuccess,"on-error":t.handleUploadError,"on-progress":t.handleUploadProgress,"show-file-list":!1,accept:".xlsx,.xls"}},[e("el-button",{attrs:{type:"success",loading:t.uploadLoading}},[e("i",{staticClass:"el-icon-upload2"}),t._v(" 上传Excel数据 ")])],1)],1)])],1),t.importProgress.show?e("div",{staticClass:"import-progress"},[e("el-card",[e("div",{staticClass:"progress-header"},[e("h3",[e("i",{staticClass:"el-icon-loading"}),t._v(" 正在处理导入数据... ")])]),e("el-progress",{attrs:{percentage:t.importProgress.percentage,status:t.importProgress.status,"stroke-width":8}}),e("p",{staticClass:"progress-text"},[t._v(t._s(t.importProgress.text))])],1)],1):t._e(),e("div",{staticClass:"import-result"},[e("el-card",[e("div",{staticClass:"result-header"},[e("h3",[t._v("导入结果")]),e("div",{staticClass:"result-actions"},[e("el-button",{attrs:{size:"small"},on:{click:t.clearResult}},[t._v("清除结果")]),e("el-button",{attrs:{size:"small",type:"primary",disabled:0===t.importResult.failed},on:{click:t.exportFailedRecords}},[t._v(" 导出失败记录 ")])],1)]),e("el-row",{staticClass:"result-stats",attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-item success"},[e("div",{staticClass:"stat-number"},[t._v(t._s(t.importResult.total))]),e("div",{staticClass:"stat-label"},[t._v("总计")])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-item success"},[e("div",{staticClass:"stat-number"},[t._v(t._s(t.importResult.success))]),e("div",{staticClass:"stat-label"},[t._v("成功")])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-item failed"},[e("div",{staticClass:"stat-number"},[t._v(t._s(t.importResult.failed))]),e("div",{staticClass:"stat-label"},[t._v("失败")])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-item skipped"},[e("div",{staticClass:"stat-number"},[t._v(t._s(t.importResult.skipped))]),e("div",{staticClass:"stat-label"},[t._v("跳过")])])])],1),e("div",{staticClass:"result-time"},[e("span",[t._v("导入时间："+t._s(t.importResult.importTime))]),e("span",[t._v("耗时："+t._s(t.importResult.duration))])])],1)],1),e("div",{staticClass:"failed-records"},[e("el-card",[e("div",{staticClass:"failed-header"},[e("h3",[t._v("导入失败情况")]),e("div",{staticClass:"failed-actions"},[e("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"搜索失败记录",size:"small","prefix-icon":"el-icon-search"},model:{value:t.failedSearch,callback:function(e){t.failedSearch=e},expression:"failedSearch"}})],1)]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.filteredFailedRecords,border:"",size:"small","max-height":"400"}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.$index+1)+" ")]}}])}),e("el-table-column",{attrs:{prop:"rowNumber",label:"Excel行号",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" 第"+t._s(e.row.rowNumber)+"行 ")]}}])}),e("el-table-column",{attrs:{prop:"patentName",label:"专利名称","min-width":"200","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"applicant",label:"申请人",width:"150","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"applicationNo",label:"申请号",width:"160"}}),e("el-table-column",{attrs:{prop:"patentType",label:"专利类型",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-tag",{attrs:{type:t.getPatentTypeColor(s.row.patentType),size:"mini"}},[t._v(" "+t._s(s.row.patentType)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"errorType",label:"错误类型",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-tag",{attrs:{type:t.getErrorTypeColor(s.row.errorType),size:"mini"}},[t._v(" "+t._s(s.row.errorType)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"errorMessage",label:"错误信息","min-width":"200","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{staticClass:"error-message"},[t._v(t._s(s.row.errorMessage))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"100",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.viewErrorDetail(s.row)}}},[t._v(" 详情 ")])]}}])})],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.filteredFailedRecords.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1),e("el-dialog",{attrs:{title:"错误详情",visible:t.errorDetailVisible,width:"600px"},on:{"update:visible":function(e){t.errorDetailVisible=e}}},[t.currentErrorDetail?e("div",{staticClass:"error-detail"},[e("el-descriptions",{attrs:{column:1,border:""}},[e("el-descriptions-item",{attrs:{label:"Excel行号"}},[t._v(" 第"+t._s(t.currentErrorDetail.rowNumber)+"行 ")]),e("el-descriptions-item",{attrs:{label:"专利名称"}},[t._v(" "+t._s(t.currentErrorDetail.patentName)+" ")]),e("el-descriptions-item",{attrs:{label:"申请人"}},[t._v(" "+t._s(t.currentErrorDetail.applicant)+" ")]),e("el-descriptions-item",{attrs:{label:"申请号"}},[t._v(" "+t._s(t.currentErrorDetail.applicationNo)+" ")]),e("el-descriptions-item",{attrs:{label:"专利类型"}},[e("el-tag",{attrs:{type:t.getPatentTypeColor(t.currentErrorDetail.patentType),size:"small"}},[t._v(" "+t._s(t.currentErrorDetail.patentType)+" ")])],1),e("el-descriptions-item",{attrs:{label:"错误类型"}},[e("el-tag",{attrs:{type:t.getErrorTypeColor(t.currentErrorDetail.errorType),size:"small"}},[t._v(" "+t._s(t.currentErrorDetail.errorType)+" ")])],1),e("el-descriptions-item",{attrs:{label:"错误信息"}},[e("span",{staticClass:"error-message"},[t._v(t._s(t.currentErrorDetail.errorMessage))])]),e("el-descriptions-item",{attrs:{label:"建议解决方案"}},[e("div",{staticClass:"error-solution"},[t._v(" "+t._s(t.getErrorSolution(t.currentErrorDetail.errorType))+" ")])])],1)],1):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.errorDetailVisible=!1}}},[t._v("关闭")])],1)]),e("el-dialog",{attrs:{title:"导入说明",visible:t.helpVisible,width:"700px"},on:{"update:visible":function(e){t.helpVisible=e}}},[e("div",{staticClass:"help-content"},[e("h4",[t._v("导入要求：")]),e("ul",[e("li",[t._v("文件格式：支持.xlsx和.xls格式")]),e("li",[t._v("数据量限制：单次最多导入1000条记录")]),e("li",[t._v("文件大小：不超过10MB")])]),e("h4",[t._v("必填字段：")]),e("ul",[e("li",[t._v("专利名称：不能为空，长度不超过200字符")]),e("li",[t._v("申请人：不能为空，长度不超过100字符")]),e("li",[t._v("申请号：格式如：CN202012345678.X")]),e("li",[t._v("专利类型：发明专利/实用新型/外观设计")]),e("li",[t._v("申请日期：格式：YYYY-MM-DD")])]),e("h4",[t._v("注意事项：")]),e("ul",[e("li",[t._v("请严格按照模板格式填写数据")]),e("li",[t._v("申请号不能重复，系统会自动检查")]),e("li",[t._v("日期格式必须正确，否则导入失败")]),e("li",[t._v("如有重复数据，系统会自动跳过")])])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.helpVisible=!1}}},[t._v("我知道了")])],1)]),e("div",{staticClass:"floating-help"},[e("el-button",{attrs:{circle:"",type:"info",icon:"el-icon-question"},on:{click:function(e){t.helpVisible=!0}}})],1)],1)},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"import-header"},[e("div",{staticClass:"header-content"},[e("h2",[t._v("专利导入")]),e("p",{staticClass:"description"},[t._v(" 支持批量导入专利项目信息，请先下载模板，按照模板格式填写数据后上传。 系统将自动检查数据格式并反馈导入结果。 ")])])])}],i=(s("e9f5"),s("910d"),s("ab43"),s("88a7"),s("271a"),s("5494"),{name:"PatentImport",data(){return{downloadLoading:!1,uploadLoading:!1,uploadUrl:"/api/patent/import",importProgress:{show:!1,percentage:0,status:"",text:""},importResult:{show:!1,total:0,success:0,failed:0,skipped:0,importTime:"",duration:""},failedRecords:[],failedSearch:"",currentPage:1,pageSize:10,errorDetailVisible:!1,currentErrorDetail:null,helpVisible:!1}},computed:{filteredFailedRecords(){if(!this.failedSearch)return this.failedRecords;const t=this.failedSearch.toLowerCase();return this.failedRecords.filter(e=>e.patentName.toLowerCase().includes(t)||e.applicant.toLowerCase().includes(t)||e.applicationNo.toLowerCase().includes(t)||e.errorMessage.toLowerCase().includes(t))}},methods:{downloadTemplate(){this.downloadLoading=!0,setTimeout(()=>{const t=[{"专利名称":"一种智能控制方法","申请人":"北京科技有限公司","申请号":"CN202012345678.X","专利类型":"发明专利","申请日期":"2023-01-15","技术领域":"计算机技术","发明人":"张三;李四","代理机构":"北京专利代理有限公司","代理人":"王五","优先权号":"","优先权日":"","公开号":"","公开日":"","授权号":"","授权日":"","备注":"示例数据"}];this.exportToExcel(t,"专利导入模板.xlsx"),this.downloadLoading=!1,this.$message.success("模板下载成功")},1e3)},beforeUpload(t){const e="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.type||"application/vnd.ms-excel"===t.type,s=t.size/1024/1024<10;return e?s?(this.uploadLoading=!0,this.showImportProgress(),!0):(this.$message.error("文件大小不能超过10MB!"),!1):(this.$message.error("只能上传Excel格式文件!"),!1)},handleUploadProgress(t){const e=Math.round(.3*t.percent);this.updateProgress(e,"正在上传文件...")},handleUploadSuccess(t){this.uploadLoading=!1,this.processImportData()},handleUploadError(t){this.uploadLoading=!1,this.hideImportProgress(),this.$message.error("文件上传失败："+t.message)},showImportProgress(){this.importProgress={show:!0,percentage:0,status:"",text:"准备导入..."}},updateProgress(t,e,s=""){this.importProgress.percentage=t,this.importProgress.text=e,this.importProgress.status=s},hideImportProgress(){this.importProgress.show=!1},processImportData(){let t=30;setTimeout(()=>{t=50,this.updateProgress(t,"正在解析Excel数据..."),setTimeout(()=>{t=70,this.updateProgress(t,"正在验证数据格式..."),setTimeout(()=>{t=90,this.updateProgress(t,"正在导入数据库..."),setTimeout(()=>{this.updateProgress(100,"导入完成!","success"),setTimeout(()=>{this.hideImportProgress(),this.showImportResult()},1e3)},1e3)},1500)},1e3)},1e3)},showImportResult(){const t=150,e=Math.floor(20*Math.random())+5,s=Math.floor(10*Math.random())+2,r=t-e-s;this.importResult={show:!0,total:t,success:r,failed:e,skipped:s,importTime:(new Date).toLocaleString(),duration:"2分35秒"},this.generateFailedRecords(e)},generateFailedRecords(t){const e=["格式错误","重复数据","必填缺失","数据无效"],s=["发明专利","实用新型","外观设计"],r={"格式错误":["申请号格式不正确","日期格式错误","专利类型不在允许范围内"],"重复数据":["申请号已存在","专利名称重复","数据重复导入"],"必填缺失":["专利名称不能为空","申请人不能为空","申请号不能为空"],"数据无效":["申请日期不能晚于今天","发明人格式错误","申请人格式不规范"]};this.failedRecords=Array.from({length:t}).map((t,a)=>{const i=e[Math.floor(Math.random()*e.length)],o=r[i];return{id:a+1,rowNumber:Math.floor(150*Math.random())+2,patentName:"专利名称"+(a+1),applicant:"申请人公司"+(a+1),applicationNo:`CN${String(202000001+a).padStart(10,"0")}.${Math.floor(10*Math.random())}`,patentType:s[Math.floor(Math.random()*s.length)],errorType:i,errorMessage:o[Math.floor(Math.random()*o.length)]}})},clearResult(){this.importResult.show=!1,this.failedRecords=[],this.failedSearch=""},exportFailedRecords(){if(0===this.failedRecords.length)return void this.$message.warning("没有失败记录可导出");const t=this.failedRecords.map(t=>({"Excel行号":`第${t.rowNumber}行`,"专利名称":t.patentName,"申请人":t.applicant,"申请号":t.applicationNo,"专利类型":t.patentType,"错误类型":t.errorType,"错误信息":t.errorMessage,"解决方案":this.getErrorSolution(t.errorType)}));this.exportToExcel(t,`导入失败记录_${(new Date).toLocaleDateString()}.xlsx`),this.$message.success("失败记录导出成功")},viewErrorDetail(t){this.currentErrorDetail=t,this.errorDetailVisible=!0},getPatentTypeColor(t){const e={"发明专利":"success","实用新型":"warning","外观设计":"info"};return e[t]||""},getErrorTypeColor(t){const e={"格式错误":"warning","重复数据":"info","必填缺失":"danger","数据无效":"warning"};return e[t]||""},getErrorSolution(t){const e={"格式错误":"请检查数据格式是否符合要求，特别注意日期和申请号的格式","重复数据":"请检查申请号是否已存在于系统中，确保数据唯一性","必填缺失":"请确保所有必填字段都已填写，不能为空","数据无效":"请检查数据的有效性，如日期的合理性、格式的正确性等"};return e[t]||"请联系系统管理员获取帮助"},exportToExcel(t,e){const s=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(s),a=document.createElement("a");a.href=r,a.download=e,a.click(),URL.revokeObjectURL(r)},handleSizeChange(t){this.pageSize=t},handleCurrentChange(t){this.currentPage=t}}}),o=i,l=(s("eb37"),s("2877")),n=Object(l["a"])(o,r,a,!1,null,"7bb86bcd",null);e["default"]=n.exports},b6e6:function(t,e,s){},eb37:function(t,e,s){"use strict";s("b6e6")}}]);