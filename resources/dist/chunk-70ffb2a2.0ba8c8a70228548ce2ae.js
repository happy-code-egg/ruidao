(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70ffb2a2"],{"19eb9":function(e,t,a){"use strict";a("b270")},"46b7":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"payment-request-list-container"},[t("div",{staticClass:"status-tabs"},[t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleStatusChange},model:{value:e.activeStatus,callback:function(t){e.activeStatus=t},expression:"activeStatus"}},[t("el-tab-pane",{attrs:{label:"全部",name:"all"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-s-order"}),e._v(" 全部")])]),t("el-tab-pane",{attrs:{label:"草稿",name:"draft"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-edit-outline"}),e._v(" 草稿")])]),t("el-tab-pane",{attrs:{label:"待审核",name:"pending"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-time"}),e._v(" 待审核")])]),t("el-tab-pane",{attrs:{label:"已通过",name:"approved"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-success"}),e._v(" 已通过")])]),t("el-tab-pane",{attrs:{label:"已退回",name:"rejected"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-warning"}),e._v(" 已退回")])]),t("el-tab-pane",{attrs:{label:"已撤回",name:"withdrawn"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-refresh-left"}),e._v(" 已撤回")])])],1)],1),t("div",{staticClass:"body-part-search"},[t("el-form",{ref:"searchForm",attrs:{model:e.searchForm,"label-width":"100px"}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"请款单号",prop:"requestNo"}},[t("el-input",{attrs:{placeholder:"请款单号",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchForm.requestNo,callback:function(t){e.$set(e.searchForm,"requestNo",t)},expression:"searchForm.requestNo"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"客户名称",prop:"customerName"}},[t("el-input",{attrs:{placeholder:"客户名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchForm.customerName,callback:function(t){e.$set(e.searchForm,"customerName",t)},expression:"searchForm.customerName"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"合同号",prop:"contractNo"}},[t("el-input",{attrs:{placeholder:"合同号",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchForm.contractNo,callback:function(t){e.$set(e.searchForm,"contractNo",t)},expression:"searchForm.contractNo"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"申请人",prop:"creator"}},[t("el-input",{attrs:{placeholder:"申请人",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchForm.creator,callback:function(t){e.$set(e.searchForm,"creator",t)},expression:"searchForm.creator"}})],1)],1)],1),e.expandVisible?t("el-row",[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"申请时间",prop:"createTimeRange"}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small","value-format":"yyyy-MM-dd"},model:{value:e.searchForm.createTimeRange,callback:function(t){e.$set(e.searchForm,"createTimeRange",t)},expression:"searchForm.createTimeRange"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"金额范围",prop:"amountRange"}},[t("div",{staticClass:"amount-range"},[t("el-input",{staticStyle:{width:"45%"},attrs:{placeholder:"最小金额",size:"small"},model:{value:e.searchForm.minAmount,callback:function(t){e.$set(e.searchForm,"minAmount",t)},expression:"searchForm.minAmount"}}),t("span",{staticStyle:{margin:"0 2%"}},[e._v("-")]),t("el-input",{staticStyle:{width:"45%"},attrs:{placeholder:"最大金额",size:"small"},model:{value:e.searchForm.maxAmount,callback:function(t){e.$set(e.searchForm,"maxAmount",t)},expression:"searchForm.maxAmount"}})],1)])],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"审核人",prop:"approver"}},[t("el-input",{attrs:{placeholder:"审核人",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchForm.approver,callback:function(t){e.$set(e.searchForm,"approver",t)},expression:"searchForm.approver"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"紧急程度",prop:"urgentLevel"}},[t("el-select",{attrs:{placeholder:"紧急程度",clearable:"",size:"small"},model:{value:e.searchForm.urgentLevel,callback:function(t){e.$set(e.searchForm,"urgentLevel",t)},expression:"searchForm.urgentLevel"}},[t("el-option",{attrs:{label:"普通",value:"normal"}}),t("el-option",{attrs:{label:"紧急",value:"urgent"}}),t("el-option",{attrs:{label:"特急",value:"emergency"}})],1)],1)],1)],1):e._e()],1),t("div",{staticClass:"part-search-buttons"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")]),t("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:e.handleReset}},[e._v("重置")]),t("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download"},on:{click:e.handleExport}},[e._v("导出")])],1)],1),"all"===e.activeStatus?t("div",{staticClass:"stats-container"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:4}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-value"},[e._v(e._s(e.statistics.total))]),t("div",{staticClass:"stat-label"},[e._v("总请款单")])])]),t("el-col",{attrs:{span:4}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-value",staticStyle:{color:"#909399"}},[e._v(e._s(e.statistics.draft))]),t("div",{staticClass:"stat-label"},[e._v("草稿")])])]),t("el-col",{attrs:{span:4}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-value",staticStyle:{color:"#e6a23c"}},[e._v(e._s(e.statistics.pending))]),t("div",{staticClass:"stat-label"},[e._v("待审核")])])]),t("el-col",{attrs:{span:4}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-value",staticStyle:{color:"#67c23a"}},[e._v(e._s(e.statistics.approved))]),t("div",{staticClass:"stat-label"},[e._v("已通过")])])]),t("el-col",{attrs:{span:4}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-value",staticStyle:{color:"#f56c6c"}},[e._v(e._s(e.statistics.rejected))]),t("div",{staticClass:"stat-label"},[e._v("已退回")])])]),t("el-col",{attrs:{span:4}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-value"},[e._v("¥"+e._s(e.statistics.totalAmount))]),t("div",{staticClass:"stat-label"},[e._v("请款总金额")])])])],1)],1):e._e(),t("div",{staticClass:"body-part-content"},[e._m(0),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",size:"small","row-key":"id"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"80"}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),t("el-table-column",{attrs:{prop:"requestNo",label:"请款单号",width:"140","show-overflow-tooltip":"",fixed:"left"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusType(a.row.status),size:"small"}},[e._v(" "+e._s(e.getStatusText(a.row.status))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"customerName",label:"客户名称",width:"150","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"contractNo",label:"合同号",width:"130","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"totalAmount",label:"请款金额",width:"120",align:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"amount-text"},[e._v("¥"+e._s(a.row.totalAmount))])]}}])}),t("el-table-column",{attrs:{prop:"officialFee",label:"官费",width:"100",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" ¥"+e._s(t.row.officialFee)+" ")]}}])}),t("el-table-column",{attrs:{prop:"serviceFee",label:"服务费",width:"100",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" ¥"+e._s(t.row.serviceFee)+" ")]}}])}),t("el-table-column",{attrs:{prop:"creator",label:"申请人",width:"100"}}),t("el-table-column",{attrs:{prop:"createTime",label:"申请时间",width:"150"}}),t("el-table-column",{attrs:{prop:"approver",label:"审核人",width:"100"}}),t("el-table-column",{attrs:{prop:"approveTime",label:"审核时间",width:"150"}}),t("el-table-column",{attrs:{prop:"urgentLevel",label:"紧急程度",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getUrgentType(a.row.urgentLevel),size:"small"}},[e._v(" "+e._s(e.getUrgentText(a.row.urgentLevel))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"linkedPaymentNo",label:"关联到款单",width:"140","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.linkedPaymentNo?t("span",{staticClass:"link-text",on:{click:function(t){return e.handleViewPayment(a.row.linkedPaymentNo)}}},[e._v(" "+e._s(a.row.linkedPaymentNo)+" ")]):t("span",{staticStyle:{color:"#c0c4cc"}},[e._v("-")])]}}])}),t("el-table-column",{attrs:{prop:"remark",label:"备注","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.handleView(a.row)}}},[e._v("查看")]),"draft"===a.row.status?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]):e._e()]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:"新增请款单",visible:e.addDialogVisible,width:"900px","close-on-click-modal":!1},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.handleAddDialogClose}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addRules,"label-width":"120px",size:"small"}},[t("div",{staticClass:"form-section"},[t("div",{staticClass:"section-title"},[e._v("基本信息")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"客户名称",prop:"customerName"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择客户",filterable:"",remote:"","remote-method":e.searchCustomers,loading:e.customerLoading},on:{change:e.handleCustomerChange},model:{value:e.addForm.customerName,callback:function(t){e.$set(e.addForm,"customerName",t)},expression:"addForm.customerName"}},e._l(e.customerOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"合同号",prop:"contractNo"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择合同",filterable:"",disabled:!e.addForm.customerName},on:{change:e.handleContractChange},model:{value:e.addForm.contractNo,callback:function(t){e.$set(e.addForm,"contractNo",t)},expression:"addForm.contractNo"}},e._l(e.contractOptions,(function(e){return t("el-option",{key:e.no,attrs:{label:`${e.no} - ${e.name}`,value:e.no}})})),1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"紧急程度",prop:"urgentLevel"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择紧急程度"},model:{value:e.addForm.urgentLevel,callback:function(t){e.$set(e.addForm,"urgentLevel",t)},expression:"addForm.urgentLevel"}},[t("el-option",{attrs:{label:"普通",value:"normal"}}),t("el-option",{attrs:{label:"紧急",value:"urgent"}}),t("el-option",{attrs:{label:"特急",value:"emergency"}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"技术负责人",prop:"techLead"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择技术负责人"},model:{value:e.addForm.techLead,callback:function(t){e.$set(e.addForm,"techLead",t)},expression:"addForm.techLead"}},[t("el-option",{attrs:{label:"张工程师",value:"张工程师"}}),t("el-option",{attrs:{label:"李工程师",value:"李工程师"}}),t("el-option",{attrs:{label:"王工程师",value:"王工程师"}}),t("el-option",{attrs:{label:"赵工程师",value:"赵工程师"}})],1)],1)],1)],1)],1),t("div",{staticClass:"form-section"},[t("div",{staticClass:"section-title"},[e._v("费用信息")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"官费",prop:"officialFee"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,min:0,max:999999,"controls-position":"right"},on:{change:e.calculateTotal},model:{value:e.addForm.officialFee,callback:function(t){e.$set(e.addForm,"officialFee",t)},expression:"addForm.officialFee"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"服务费",prop:"serviceFee"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,min:0,max:999999,"controls-position":"right"},on:{change:e.calculateTotal},model:{value:e.addForm.serviceFee,callback:function(t){e.$set(e.addForm,"serviceFee",t)},expression:"addForm.serviceFee"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"总金额"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{value:e.totalAmount,readonly:""}},[t("template",{slot:"prepend"},[e._v("¥")])],2)],1)],1)],1)],1),t("div",{staticClass:"form-section"},[t("div",{staticClass:"section-title"},[e._v("关联项目")]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.addForm.caseList,border:"",size:"mini","max-height":"200"}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),t("el-table-column",{attrs:{prop:"caseNo",label:"项目编号",width:"140"}}),t("el-table-column",{attrs:{prop:"caseName",label:"项目名称","min-width":"180","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"applicant",label:"申请人",width:"150","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"caseType",label:"项目类型",width:"100"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getCaseStatusType(a.row.status),size:"mini"}},[e._v(" "+e._s(a.row.status)+" ")])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.removeCaseFromList(a.$index)}}},[e._v(" 移除 ")])]}}])})],1),t("div",{staticStyle:{"margin-top":"10px"}},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.showCaseSelector}},[e._v("添加项目")])],1)],1),t("div",{staticClass:"form-section"},[t("div",{staticClass:"section-title"},[e._v("备注信息")]),t("el-form-item",{attrs:{label:"请款事由",prop:"reason"}},[t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入请款事由",maxlength:"200","show-word-limit":""},model:{value:e.addForm.reason,callback:function(t){e.$set(e.addForm,"reason",t)},expression:"addForm.reason"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入备注信息",maxlength:"500","show-word-limit":""},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1)],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"info"},on:{click:e.handleSaveDraft}},[e._v("保存草稿")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitAdd}},[e._v("提交审核")])],1)],1),t("el-dialog",{attrs:{title:"选择项目",visible:e.caseSelectorVisible,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){e.caseSelectorVisible=t}}},[t("div",{staticClass:"case-search-form"},[t("el-form",{attrs:{model:e.caseSearchForm,size:"small",inline:!0}},[t("el-form-item",{attrs:{label:"项目编号"}},[t("el-input",{attrs:{placeholder:"项目编号",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchCases.apply(null,arguments)}},model:{value:e.caseSearchForm.caseNo,callback:function(t){e.$set(e.caseSearchForm,"caseNo",t)},expression:"caseSearchForm.caseNo"}})],1),t("el-form-item",{attrs:{label:"项目名称"}},[t("el-input",{attrs:{placeholder:"项目名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchCases.apply(null,arguments)}},model:{value:e.caseSearchForm.caseName,callback:function(t){e.$set(e.caseSearchForm,"caseName",t)},expression:"caseSearchForm.caseName"}})],1),t("el-form-item",{attrs:{label:"项目类型"}},[t("el-select",{attrs:{placeholder:"项目类型",clearable:""},model:{value:e.caseSearchForm.caseType,callback:function(t){e.$set(e.caseSearchForm,"caseType",t)},expression:"caseSearchForm.caseType"}},[t("el-option",{attrs:{label:"发明专利",value:"发明专利"}}),t("el-option",{attrs:{label:"实用新型",value:"实用新型"}}),t("el-option",{attrs:{label:"外观设计",value:"外观设计"}}),t("el-option",{attrs:{label:"商标注册",value:"商标注册"}}),t("el-option",{attrs:{label:"版权登记",value:"版权登记"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.searchCases}},[e._v("搜索")]),t("el-button",{on:{click:e.resetCaseSearch}},[e._v("重置")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.caseLoading,expression:"caseLoading"}],staticStyle:{width:"100%"},attrs:{data:e.availableCases,border:"",size:"small","max-height":"400"},on:{"selection-change":e.handleCaseSelection}},[t("el-table-column",{attrs:{type:"selection",width:"80"}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),t("el-table-column",{attrs:{prop:"caseNo",label:"项目编号",width:"140"}}),t("el-table-column",{attrs:{prop:"caseName",label:"项目名称","min-width":"180","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"applicant",label:"申请人",width:"150","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"caseType",label:"项目类型",width:"100"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getCaseStatusType(a.row.status),size:"mini"}},[e._v(" "+e._s(a.row.status)+" ")])]}}])})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.caseSelectorVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmCaseSelection}},[e._v("确定")])],1)],1)],1)},l=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"part-table-header"},[t("div",{staticClass:"part-table-title"},[e._v("请款单列表")])])}],r=(a("14d9"),a("e9f5"),a("7d54"),a("ab43"),a("a732"),{name:"PaymentRequestList",data(){return{loading:!1,expandVisible:!0,activeStatus:"all",searchForm:{requestNo:"",customerName:"",contractNo:"",creator:"",createTimeRange:[],minAmount:"",maxAmount:"",approver:"",urgentLevel:""},tableData:[],selectedRows:[],currentPage:1,pageSize:10,total:0,statistics:{total:0,draft:0,pending:0,approved:0,rejected:0,totalAmount:"0"},addDialogVisible:!1,addForm:{customerName:"",contractNo:"",urgentLevel:"normal",techLead:"",officialFee:0,serviceFee:0,reason:"",remark:"",caseList:[]},addRules:{customerName:[{required:!0,message:"请选择客户名称",trigger:"change"}],contractNo:[{required:!0,message:"请选择合同号",trigger:"change"}],urgentLevel:[{required:!0,message:"请选择紧急程度",trigger:"change"}],techLead:[{required:!0,message:"请选择技术负责人",trigger:"change"}],officialFee:[{required:!0,message:"请输入官费",trigger:"blur"},{type:"number",min:0,message:"官费不能小于0",trigger:"blur"}],serviceFee:[{required:!0,message:"请输入服务费",trigger:"blur"},{type:"number",min:0,message:"服务费不能小于0",trigger:"blur"}],reason:[{required:!0,message:"请输入请款事由",trigger:"blur"}]},customerLoading:!1,customerOptions:[],contractOptions:[],caseSelectorVisible:!1,caseLoading:!1,availableCases:[],selectedCases:[],caseSearchForm:{caseNo:"",caseName:"",caseType:""}}},computed:{totalAmount(){return(this.addForm.officialFee+this.addForm.serviceFee).toFixed(2)}},created(){this.getList(),this.getStatistics()},methods:{getList(){this.loading=!0,setTimeout(()=>{const e=["draft","pending","approved","rejected","withdrawn"];this.tableData=Array.from({length:20}).map((t,a)=>{const s=e[Math.floor(Math.random()*e.length)],l=new Date(Date.now()-30*Math.random()*24*60*60*1e3),r=["approved","rejected"].includes(s);return{id:a+1,requestNo:"QK"+String(Date.now()+a).slice(-8),status:"all"===this.activeStatus?s:this.activeStatus,customerName:"客户公司"+(a+1),contractNo:"HT"+String(1e4+a).padStart(6,"0"),totalAmount:(5e3+2e4*Math.random()).toFixed(2),officialFee:(1e3+3e3*Math.random()).toFixed(2),serviceFee:(2e3+8e3*Math.random()).toFixed(2),creator:"申请人"+(a+1),createTime:l.toLocaleString(),approver:r?"审核人"+(Math.floor(5*Math.random())+1):"",approveTime:r?new Date(l.getTime()+864e5).toLocaleString():"",urgentLevel:["normal","urgent","emergency"][Math.floor(3*Math.random())],linkedPaymentNo:Math.random()>.6?"DK"+String(Date.now()+a).slice(-8):"",remark:a%3===0?"请款备注信息"+(a+1):""}}),this.total=this.tableData.length,this.loading=!1},500)},getStatistics(){this.statistics={total:156,draft:23,pending:18,approved:89,rejected:15,totalAmount:"2,468,900.00"}},handleSearch(){this.currentPage=1,this.getList()},handleReset(){this.searchForm={requestNo:"",customerName:"",contractNo:"",creator:"",createTimeRange:[],minAmount:"",maxAmount:"",approver:"",urgentLevel:""},this.getList()},handleStatusChange(){this.currentPage=1,this.getList()},handleSelectionChange(e){this.selectedRows=e},handleSizeChange(e){this.pageSize=e,this.getList()},handleCurrentChange(e){this.currentPage=e,this.getList()},getStatusType(e){const t={draft:"info",pending:"warning",approved:"success",rejected:"danger",withdrawn:""};return t[e]||""},getStatusText(e){const t={draft:"草稿",pending:"待审核",approved:"已通过",rejected:"已退回",withdrawn:"已撤回"};return t[e]||e},getUrgentType(e){const t={normal:"",urgent:"warning",emergency:"danger"};return t[e]||""},getUrgentText(e){const t={normal:"普通",urgent:"紧急",emergency:"特急"};return t[e]||e},handleAdd(){this.addDialogVisible=!0,this.initAddForm()},handleView(e){this.$router.push("/finance/payment-request/detail/"+e.id)},handleEdit(e){this.$message.info("跳转到编辑页面")},handleSubmit(e){this.$confirm("确认提交请款单审核吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.success("提交成功"),this.getList()})},handleWithdraw(e){this.$confirm("确认撤回请款单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.success("撤回成功"),this.getList()})},handleCommand(e,t){switch(e){case"copy":this.$message.info("复制请款单功能开发中");break;case"print":this.$message.info("打印功能开发中");break;case"export":this.$message.info("导出PDF功能开发中");break}},handleViewPayment(e){this.$router.push("/finance/payment-received/detail/"+e)},handleExport(){this.$message.info("导出功能开发中")},initAddForm(){this.addForm={customerName:"",contractNo:"",urgentLevel:"normal",techLead:"",officialFee:0,serviceFee:0,reason:"",remark:"",caseList:[]},this.customerOptions=[],this.contractOptions=[]},handleAddDialogClose(){this.addDialogVisible=!1,this.$refs.addForm&&this.$refs.addForm.resetFields(),this.initAddForm()},calculateTotal(){},searchCustomers(e){""!==e?(this.customerLoading=!0,setTimeout(()=>{this.customerOptions=[{id:1,name:"北京科技有限公司"},{id:2,name:"上海创新企业"},{id:3,name:"深圳技术公司"},{id:4,name:"广州研发中心"},{id:5,name:"成都软件公司"}].filter(t=>t.name.includes(e)),this.customerLoading=!1},200)):this.customerOptions=[]},handleCustomerChange(e){this.addForm.contractNo="",this.contractOptions=[],e&&this.loadContracts(e)},loadContracts(e){setTimeout(()=>{this.contractOptions=[{no:"HT202301001",name:"专利申请服务合同"},{no:"HT202301002",name:"商标注册服务合同"},{no:"HT202301003",name:"版权登记服务合同"},{no:"HT202301004",name:"知识产权维护合同"}]},300)},handleContractChange(e){e&&this.loadRelatedCases(e)},loadRelatedCases(e){},showCaseSelector(){this.caseSelectorVisible=!0,this.searchCases()},searchCases(){this.caseLoading=!0,setTimeout(()=>{this.availableCases=Array.from({length:10}).map((e,t)=>({id:t+1,caseNo:"CN"+String(202300001+t),caseName:"智能设备控制方法"+(t+1),applicant:this.addForm.customerName||"申请人"+(t+1),caseType:["发明专利","实用新型","外观设计","商标注册","版权登记"][t%5],status:["申请中","审查中","已授权","已驳回"][t%4]})),this.caseLoading=!1},500)},resetCaseSearch(){this.caseSearchForm={caseNo:"",caseName:"",caseType:""},this.searchCases()},handleCaseSelection(e){this.selectedCases=e},confirmCaseSelection(){0!==this.selectedCases.length?(this.selectedCases.forEach(e=>{const t=this.addForm.caseList.some(t=>t.id===e.id);t||this.addForm.caseList.push({...e})}),this.caseSelectorVisible=!1,this.selectedCases=[]):this.$message.warning("请选择至少一个项目")},removeCaseFromList(e){this.addForm.caseList.splice(e,1)},getCaseStatusType(e){const t={"申请中":"warning","审查中":"info","已授权":"success","已驳回":"danger"};return t[e]||""},handleSaveDraft(){this.$refs.addForm.validate(e=>{e&&(this.loading=!0,setTimeout(()=>{this.$message.success("请款单已保存为草稿"),this.addDialogVisible=!1,this.getList(),this.getStatistics(),this.loading=!1},1e3))})},handleSubmitAdd(){this.$refs.addForm.validate(e=>{if(e){if(0===this.addForm.caseList.length)return void this.$message.warning("请至少添加一个关联项目");this.loading=!0,setTimeout(()=>{this.$message.success("请款单已提交审核"),this.addDialogVisible=!1,this.getList(),this.getStatistics(),this.loading=!1},1e3)}})}}}),o=r,i=(a("19eb9"),a("2877")),n=Object(i["a"])(o,s,l,!1,null,"342795a1",null);t["default"]=n.exports},b270:function(e,t,a){}}]);