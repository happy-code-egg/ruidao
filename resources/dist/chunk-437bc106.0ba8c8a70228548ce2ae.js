(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-437bc106"],{"082b":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"operation-status-tabs"},[t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleStatusTabClick},model:{value:e.activeStatus,callback:function(t){e.activeStatus=t},expression:"activeStatus"}},[t("el-tab-pane",{attrs:{label:"待申报",name:"pending"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-edit-outline"}),e._v(" 待申报 ")])]),t("el-tab-pane",{attrs:{label:"已申报",name:"declared"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-document"}),e._v(" 已申报 ")])]),t("el-tab-pane",{attrs:{label:"审核中",name:"reviewing"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-time"}),e._v(" 审核中 ")])]),t("el-tab-pane",{attrs:{label:"已通过",name:"approved"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-success"}),e._v(" 已通过 ")])]),t("el-tab-pane",{attrs:{label:"已拒绝",name:"rejected"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-warning"}),e._v(" 已拒绝 ")])]),t("el-tab-pane",{attrs:{label:"全部",name:"all"}})],1)],1),t("div",{staticClass:"body-part-search"},[t("el-form",{attrs:{model:e.listQuery,"label-width":"100px"}},[t("div",{staticClass:"default-filters"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"技术人员",prop:"operationPerson"}},[t("el-input",{staticClass:"filter-item",attrs:{placeholder:"技术人员",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.listQuery.operationPerson,callback:function(t){e.$set(e.listQuery,"operationPerson",t)},expression:"listQuery.operationPerson"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"项目编号",prop:"caseNo"}},[t("el-input",{staticClass:"filter-item",attrs:{placeholder:"项目编号",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.listQuery.caseNo,callback:function(t){e.$set(e.listQuery,"caseNo",t)},expression:"listQuery.caseNo"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"提成月度",prop:"commissionMonth"}},[t("el-date-picker",{staticClass:"filter-item",attrs:{type:"month",placeholder:"选择月份",format:"yyyy-MM","value-format":"yyyy-MM",size:"small"},model:{value:e.listQuery.commissionMonth,callback:function(t){e.$set(e.listQuery,"commissionMonth",t)},expression:"listQuery.commissionMonth"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"任务类型",prop:"taskType"}},[t("el-select",{staticClass:"filter-item",attrs:{placeholder:"任务类型",clearable:"",size:"small"},model:{value:e.listQuery.taskType,callback:function(t){e.$set(e.listQuery,"taskType",t)},expression:"listQuery.taskType"}},[t("el-option",{attrs:{label:"专利撰写",value:"patent_writing"}}),t("el-option",{attrs:{label:"专利审查",value:"patent_review"}}),t("el-option",{attrs:{label:"商标设计",value:"trademark_design"}}),t("el-option",{attrs:{label:"商标注册",value:"trademark_register"}}),t("el-option",{attrs:{label:"版权登记",value:"copyright_register"}}),t("el-option",{attrs:{label:"项目申报",value:"project_declare"}})],1)],1)],1)],1)],1),e.expandVisible?t("div",[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"客户名称",prop:"customerName"}},[t("el-input",{staticClass:"filter-item",attrs:{placeholder:"客户名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.listQuery.customerName,callback:function(t){e.$set(e.listQuery,"customerName",t)},expression:"listQuery.customerName"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"申报状态",prop:"status"}},[t("el-select",{staticClass:"filter-item",attrs:{placeholder:"申报状态",clearable:"",size:"small"},model:{value:e.listQuery.status,callback:function(t){e.$set(e.listQuery,"status",t)},expression:"listQuery.status"}},[t("el-option",{attrs:{label:"待申报",value:"pending"}}),t("el-option",{attrs:{label:"已申报",value:"declared"}}),t("el-option",{attrs:{label:"审核中",value:"reviewing"}}),t("el-option",{attrs:{label:"已通过",value:"approved"}}),t("el-option",{attrs:{label:"已拒绝",value:"rejected"}})],1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"完成时间",prop:"completeTimeRange"}},[t("el-date-picker",{staticClass:"filter-item",attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small","value-format":"yyyy-MM-dd"},model:{value:e.listQuery.completeTimeRange,callback:function(t){e.$set(e.listQuery,"completeTimeRange",t)},expression:"listQuery.completeTimeRange"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"金额范围",prop:"amountRange"}},[t("div",{staticClass:"custom-range-input"},[t("el-input",{staticClass:"custom-range-item",attrs:{placeholder:"最小金额",size:"small"},model:{value:e.listQuery.minAmount,callback:function(t){e.$set(e.listQuery,"minAmount",t)},expression:"listQuery.minAmount"}}),t("span",{staticClass:"custom-range-separator"},[e._v("-")]),t("el-input",{staticClass:"custom-range-item",attrs:{placeholder:"最大金额",size:"small"},model:{value:e.listQuery.maxAmount,callback:function(t){e.$set(e.listQuery,"maxAmount",t)},expression:"listQuery.maxAmount"}})],1)])],1)],1)],1):e._e()]),t("div",{staticClass:"part-search-buttons"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")]),t("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:e.resetSearch}},[e._v("重置")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.expandVisible=!e.expandVisible}}},[e._v(" "+e._s(e.expandVisible?"收起":"展开")+" "),t("i",{class:e.expandVisible?"el-icon-arrow-up":"el-icon-arrow-down"})])],1)],1),t("div",{staticClass:"stats-container"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-icon pending"},[t("i",{staticClass:"el-icon-edit-outline"})]),t("div",{staticClass:"stat-info"},[t("div",{staticClass:"stat-value"},[e._v(e._s(e.stats.pendingCount))]),t("div",{staticClass:"stat-label"},[e._v("待申报任务")])])])]),t("el-col",{attrs:{span:6}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-icon declared"},[t("i",{staticClass:"el-icon-document"})]),t("div",{staticClass:"stat-info"},[t("div",{staticClass:"stat-value"},[e._v(e._s(e.stats.declaredCount))]),t("div",{staticClass:"stat-label"},[e._v("已申报任务")])])])]),t("el-col",{attrs:{span:6}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-icon amount"},[t("i",{staticClass:"el-icon-money"})]),t("div",{staticClass:"stat-info"},[t("div",{staticClass:"stat-value"},[e._v(e._s(e._f("currency")(e.stats.totalAmount)))]),t("div",{staticClass:"stat-label"},[e._v("本月提成总额")])])])]),t("el-col",{attrs:{span:6}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-icon efficiency"},[t("i",{staticClass:"el-icon-pie-chart"})]),t("div",{staticClass:"stat-info"},[t("div",{staticClass:"stat-value"},[e._v(e._s(e.stats.efficiency)+"%")]),t("div",{staticClass:"stat-label"},[e._v("平均效率")])])])])],1)],1),t("div",{staticClass:"body-part-content"},[t("div",{staticClass:"part-table-header"},[t("div",{staticClass:"part-table-title"},[e._v(" 运营提成管理 ")]),t("div",{staticClass:"part-table-operations"},[t("el-button",{attrs:{size:"small",type:"success",disabled:0===e.selectedRows.length},on:{click:e.handleBatchDeclare}},[e._v("批量申报")]),t("el-button",{attrs:{size:"small",type:"warning",disabled:0===e.selectedRows.length},on:{click:e.handleBatchApprove}},[e._v("批量审核")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleAdd}},[e._v("新增申报")]),t("el-button",{attrs:{size:"small"},on:{click:e.handleExport}},[e._v("导出")])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"80",align:"center"}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),t("el-table-column",{attrs:{prop:"caseNo",label:"项目编号",minWidth:"140",align:"center"}}),t("el-table-column",{attrs:{prop:"taskName",label:"任务名称",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"taskType",label:"任务类型",minWidth:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getTaskTypeColor(a.row.taskType),size:"small"}},[e._v(" "+e._s(e.getTaskTypeText(a.row.taskType))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"assignedPerson",label:"分配人员",minWidth:"100",align:"center"}}),t("el-table-column",{attrs:{prop:"workload",label:"工作量(小时)",minWidth:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.workload)+"h ")]}}])}),t("el-table-column",{attrs:{prop:"commissionLimit",label:"提成上限",minWidth:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.commissionLimit))+" ")]}}])}),t("el-table-column",{attrs:{prop:"declaredAmount",label:"申报金额",minWidth:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"declared-amount",class:{"over-limit":a.row.declaredAmount>a.row.commissionLimit}},[e._v(" "+e._s(e._f("currency")(a.row.declaredAmount))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"approvedAmount",label:"核准金额",minWidth:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.approvedAmount?t("span",{staticClass:"approved-amount"},[e._v(" "+e._s(e._f("currency")(a.row.approvedAmount))+" ")]):t("span",[e._v("-")])]}}])}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusType(a.row.status),size:"small"}},[e._v(" "+e._s(e.getStatusText(a.row.status))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"completeDate",label:"完成日期",minWidth:"120",align:"center"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"200","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handleView(a.row)}}},[e._v("查看")]),"pending"===a.row.status?t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(t){return e.handleDeclare(a.row)}}},[e._v("申报")]):e._e(),"declared"===a.row.status||"reviewing"===a.row.status?t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-check"},on:{click:function(t){return e.handleApprove(a.row)}}},[e._v("审核")]):e._e()]}}])})],1),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"运营提成详情",visible:e.viewDialogVisible,width:"70%","before-close":e.handleViewDialogClose},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[e.currentRow?t("div",[t("el-card",{staticClass:"detail-card",attrs:{header:"基本信息"}},[t("el-descriptions",{attrs:{column:2,border:""}},[t("el-descriptions-item",{attrs:{label:"项目编号"}},[e._v(e._s(e.currentRow.caseNo))]),t("el-descriptions-item",{attrs:{label:"任务名称"}},[e._v(e._s(e.currentRow.taskName))]),t("el-descriptions-item",{attrs:{label:"任务类型"}},[t("el-tag",{attrs:{type:e.getTaskTypeColor(e.currentRow.taskType),size:"small"}},[e._v(" "+e._s(e.getTaskTypeText(e.currentRow.taskType))+" ")])],1),t("el-descriptions-item",{attrs:{label:"技术人员"}},[e._v(e._s(e.currentRow.operationPerson))]),t("el-descriptions-item",{attrs:{label:"客户名称"}},[e._v(e._s(e.currentRow.customerName))]),t("el-descriptions-item",{attrs:{label:"申报状态"}},[t("el-tag",{attrs:{type:e.getStatusType(e.currentRow.status),size:"small"}},[e._v(" "+e._s(e.getStatusText(e.currentRow.status))+" ")])],1),t("el-descriptions-item",{attrs:{label:"完成日期"}},[e._v(e._s(e.currentRow.completeDate))]),t("el-descriptions-item",{attrs:{label:"申报时间"}},[e._v(e._s(e.currentRow.declareTime))])],1)],1),t("el-card",{staticClass:"detail-card",attrs:{header:"工作量和提成"}},[t("el-descriptions",{attrs:{column:2,border:""}},[t("el-descriptions-item",{attrs:{label:"工作量"}},[e._v(e._s(e.currentRow.workload)+"小时")]),t("el-descriptions-item",{attrs:{label:"难度系数"}},[e._v(e._s(e.currentRow.difficultyFactor))]),t("el-descriptions-item",{attrs:{label:"提成上限"}},[t("span",{staticClass:"limit-amount"},[e._v(e._s(e._f("currency")(e.currentRow.commissionLimit)))])]),t("el-descriptions-item",{attrs:{label:"申报金额"}},[t("span",{staticClass:"declared-amount",class:{"over-limit":e.currentRow.declaredAmount>e.currentRow.commissionLimit}},[e._v(" "+e._s(e._f("currency")(e.currentRow.declaredAmount))+" ")])]),e.currentRow.approvedAmount?t("el-descriptions-item",{attrs:{label:"核准金额"}},[t("span",{staticClass:"approved-amount-large"},[e._v(e._s(e._f("currency")(e.currentRow.approvedAmount)))])]):e._e(),t("el-descriptions-item",{attrs:{label:"效率评估"}},[e._v(e._s(e.currentRow.efficiency)+"%")])],1)],1),t("el-card",{staticClass:"detail-card",attrs:{header:"申报说明"}},[t("div",{staticClass:"declare-detail"},[t("p",[t("strong",[e._v("工作内容：")])]),t("p",[e._v(e._s(e.currentRow.workDescription||"暂无说明"))]),t("p",[t("strong",[e._v("完成质量：")])]),t("p",[e._v(e._s(e.currentRow.qualityDescription||"暂无说明"))]),t("p",[t("strong",[e._v("申报理由：")])]),t("p",[e._v(e._s(e.currentRow.declareReason||"暂无说明"))])])]),t("el-card",{staticClass:"detail-card",attrs:{header:"审核记录"}},[t("el-timeline",e._l(e.currentRow.auditLogs||[],(function(a,s){return t("el-timeline-item",{key:s,attrs:{timestamp:a.timestamp,type:e.getTimelineType(a.type)}},[t("strong",[e._v(e._s(a.action))]),t("p",[e._v("操作人："+e._s(a.operator))]),a.remark?t("p",[e._v("备注："+e._s(a.remark))]):e._e()])})),1)],1)],1):e._e()]),t("el-dialog",{attrs:{title:e.declareForm.id?"修改申报":"新增申报",visible:e.declareDialogVisible,width:"60%","before-close":e.handleDeclareDialogClose},on:{"update:visible":function(t){e.declareDialogVisible=t}}},[t("el-form",{ref:"declareForm",attrs:{model:e.declareForm,rules:e.declareRules,"label-width":"120px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"项目编号",prop:"caseNo"}},[t("el-input",{attrs:{placeholder:"请输入项目编号",disabled:!!e.declareForm.id},model:{value:e.declareForm.caseNo,callback:function(t){e.$set(e.declareForm,"caseNo",t)},expression:"declareForm.caseNo"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"任务名称",prop:"taskName"}},[t("el-input",{attrs:{placeholder:"请输入任务名称"},model:{value:e.declareForm.taskName,callback:function(t){e.$set(e.declareForm,"taskName",t)},expression:"declareForm.taskName"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"任务类型",prop:"taskType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择任务类型"},model:{value:e.declareForm.taskType,callback:function(t){e.$set(e.declareForm,"taskType",t)},expression:"declareForm.taskType"}},[t("el-option",{attrs:{label:"专利撰写",value:"patent_writing"}}),t("el-option",{attrs:{label:"专利审查",value:"patent_review"}}),t("el-option",{attrs:{label:"商标设计",value:"trademark_design"}}),t("el-option",{attrs:{label:"商标注册",value:"trademark_register"}}),t("el-option",{attrs:{label:"版权登记",value:"copyright_register"}}),t("el-option",{attrs:{label:"项目申报",value:"project_declare"}})],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"技术人员",prop:"operationPerson"}},[t("el-input",{attrs:{placeholder:"技术人员",disabled:!!e.declareForm.id},model:{value:e.declareForm.operationPerson,callback:function(t){e.$set(e.declareForm,"operationPerson",t)},expression:"declareForm.operationPerson"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"工作量(小时)",prop:"workload"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:1},model:{value:e.declareForm.workload,callback:function(t){e.$set(e.declareForm,"workload",t)},expression:"declareForm.workload"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"完成日期",prop:"completeDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.declareForm.completeDate,callback:function(t){e.$set(e.declareForm,"completeDate",t)},expression:"declareForm.completeDate"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"申报金额",prop:"declaredAmount"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2},model:{value:e.declareForm.declaredAmount,callback:function(t){e.$set(e.declareForm,"declaredAmount",t)},expression:"declareForm.declaredAmount"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"提成上限"}},[t("el-input",{attrs:{value:e._f("currency")(e.declareForm.commissionLimit),disabled:""}})],1)],1)],1),t("el-form-item",{attrs:{label:"工作内容",prop:"workDescription"}},[t("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请详细描述工作内容"},model:{value:e.declareForm.workDescription,callback:function(t){e.$set(e.declareForm,"workDescription",t)},expression:"declareForm.workDescription"}})],1),t("el-form-item",{attrs:{label:"申报理由",prop:"declareReason"}},[t("el-input",{attrs:{type:"textarea",rows:"2",placeholder:"请说明申报理由"},model:{value:e.declareForm.declareReason,callback:function(t){e.$set(e.declareForm,"declareReason",t)},expression:"declareForm.declareReason"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleDeclareDialogClose}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitDeclare}},[e._v(e._s(e.declareForm.id?"保存修改":"提交申报"))])],1)],1),t("el-dialog",{attrs:{title:"审核申报",visible:e.approveDialogVisible,width:"50%"},on:{"update:visible":function(t){e.approveDialogVisible=t}}},[t("el-form",{attrs:{model:e.approveForm,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"申报信息"}},[t("div",{staticClass:"approve-info"},[t("p",[t("strong",[e._v("项目编号：")]),e._v(e._s(e.approveForm.caseNo))]),t("p",[t("strong",[e._v("任务名称：")]),e._v(e._s(e.approveForm.taskName))]),t("p",[t("strong",[e._v("技术人员：")]),e._v(e._s(e.approveForm.operationPerson))]),t("p",[t("strong",[e._v("申报金额：")]),t("span",{staticClass:"declared-amount"},[e._v(e._s(e._f("currency")(e.approveForm.declaredAmount)))])]),t("p",[t("strong",[e._v("提成上限：")]),t("span",{staticClass:"limit-amount"},[e._v(e._s(e._f("currency")(e.approveForm.commissionLimit)))])])])]),t("el-form-item",{attrs:{label:"审核结果",required:""}},[t("el-radio-group",{model:{value:e.approveForm.result,callback:function(t){e.$set(e.approveForm,"result",t)},expression:"approveForm.result"}},[t("el-radio",{attrs:{label:"approved"}},[e._v("通过")]),t("el-radio",{attrs:{label:"rejected"}},[e._v("拒绝")])],1)],1),"approved"===e.approveForm.result?t("el-form-item",{attrs:{label:"核准金额",required:""}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:0,max:e.approveForm.commissionLimit,precision:2},model:{value:e.approveForm.approvedAmount,callback:function(t){e.$set(e.approveForm,"approvedAmount",t)},expression:"approveForm.approvedAmount"}}),t("span",{staticClass:"form-tip"},[e._v("（不能超过提成上限）")])],1):e._e(),t("el-form-item",{attrs:{label:"审核意见",required:""}},[t("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入审核意见"},model:{value:e.approveForm.remark,callback:function(t){e.$set(e.approveForm,"remark",t)},expression:"approveForm.remark"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.approveDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitApprove}},[e._v("确认审核")])],1)],1)],1)},r=[],l=(a("14d9"),a("e9f5"),a("910d"),a("7d54"),{name:"OperationCommission",filters:{currency(e){return e?"¥"+Number(e).toLocaleString("zh-CN",{minimumFractionDigits:2}):"¥0.00"}},data(){return{listLoading:!1,expandVisible:!1,viewDialogVisible:!1,declareDialogVisible:!1,approveDialogVisible:!1,currentRow:null,selectedRows:[],activeStatus:"pending",listQuery:{page:1,limit:20,operationPerson:"",caseNo:"",commissionMonth:"2024-01",taskType:"",customerName:"",status:"pending",completeTimeRange:[],minAmount:"",maxAmount:""},list:[],total:0,stats:{pendingCount:0,declaredCount:0,totalAmount:0,efficiency:0},declareForm:{id:null,caseNo:"",taskName:"",taskType:"",operationPerson:"当前用户",workload:0,completeDate:"",declaredAmount:0,commissionLimit:0,workDescription:"",declareReason:""},declareRules:{caseNo:[{required:!0,message:"请输入项目编号",trigger:"blur"}],taskName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],taskType:[{required:!0,message:"请选择任务类型",trigger:"change"}],workload:[{required:!0,message:"请输入工作量",trigger:"blur"}],completeDate:[{required:!0,message:"请选择完成日期",trigger:"change"}],declaredAmount:[{required:!0,message:"请输入申报金额",trigger:"blur"}],workDescription:[{required:!0,message:"请描述工作内容",trigger:"blur"}],declareReason:[{required:!0,message:"请说明申报理由",trigger:"blur"}]},approveForm:{id:null,caseNo:"",taskName:"",operationPerson:"",declaredAmount:0,commissionLimit:0,result:"",approvedAmount:0,remark:""}}},created(){this.getList(),this.getStats()},methods:{getList(){this.listLoading=!0,setTimeout(()=>{this.list=this.getMockData(),this.total=65,this.listLoading=!1},500)},getMockData(){const e=[],t=["华为技术","中兴通讯","海康威视","大疆创新","科大讯飞","比亚迪","宁德时代","小米科技"],a=["王技术","李工程师","张专员","赵分析师","钱设计师","孙开发","周测试","陈架构师"],s=["patent_writing","patent_review","trademark_design","trademark_register","copyright_register","project_declare"],r=["pending","declared","reviewing","approved","rejected"];for(let l=1;l<=20;l++){const i=s[Math.floor(Math.random()*s.length)],o=r[Math.floor(Math.random()*r.length)],n=Math.floor(40*Math.random())+8,c=Math.floor(3e3*Math.random())+1e3,d="pending"===o?0:Math.floor(Math.random()*(1.2*c))+500,p="approved"===o?Math.min(d,c):0;e.push({id:l,caseNo:"YY"+String(2e4+l).padStart(5,"0"),taskName:`${this.getTaskTypeText(i)}任务${l}`,taskType:i,operationPerson:a[Math.floor(Math.random()*a.length)],customerName:t[Math.floor(Math.random()*t.length)],workload:n,difficultyFactor:(2*Math.random()+.5).toFixed(1),commissionLimit:c,declaredAmount:d,approvedAmount:p,status:o,completeDate:"2024-01-"+String(Math.floor(28*Math.random())+1).padStart(2,"0"),declareTime:"2024-01-16 14:30:00",efficiency:Math.floor(30*Math.random())+70,workDescription:`完成${this.getTaskTypeText(i)}相关工作，包括文档撰写、技术审核等`,qualityDescription:"工作质量良好，符合公司标准",declareReason:"按照实际工作量和难度申报提成",auditLogs:[{action:"提交申报",operator:a[Math.floor(Math.random()*a.length)],timestamp:"2024-01-16 14:30:00",type:"declare",remark:"提交运营提成申报"},{action:"approved"===o?"审核通过":"rejected"===o?"审核拒绝":"审核中",operator:"审核人员",timestamp:"2024-01-17 10:20:00",type:"approved"===o?"approve":"rejected"===o?"reject":"review",remark:"approved"===o?"审核通过，金额合理":"rejected"===o?"申报金额过高":"正在审核中"}]})}return e},getStats(){this.stats={pendingCount:18,declaredCount:25,totalAmount:125e3,efficiency:85}},resetSearch(){this.listQuery={page:1,limit:20,operationPerson:"",caseNo:"",commissionMonth:"2024-01",taskType:"",customerName:"",status:"all"===this.activeStatus?"":this.activeStatus,completeTimeRange:[],minAmount:"",maxAmount:""},this.getList()},handleSearch(){this.listQuery.page=1,this.getList()},handleView(e){this.currentRow={...e},this.viewDialogVisible=!0},handleDeclare(e){this.declareForm={id:e.id,caseNo:e.caseNo,taskName:e.taskName,taskType:e.taskType,operationPerson:e.operationPerson,workload:e.workload||0,completeDate:e.completeDate||"",declaredAmount:e.declaredAmount||0,commissionLimit:e.commissionLimit,workDescription:e.workDescription||"",declareReason:e.declareReason||""},this.declareDialogVisible=!0},handleApprove(e){this.approveForm={id:e.id,caseNo:e.caseNo,taskName:e.taskName,operationPerson:e.operationPerson,declaredAmount:e.declaredAmount,commissionLimit:e.commissionLimit,result:"",approvedAmount:e.declaredAmount,remark:""},this.approveDialogVisible=!0},handleAdd(){this.declareForm={id:null,caseNo:"",taskName:"",taskType:"",operationPerson:"当前用户",workload:0,completeDate:"",declaredAmount:0,commissionLimit:0,workDescription:"",declareReason:""},this.declareDialogVisible=!0},handleEdit(e){this.handleDeclare(e)},handleBatchDeclare(){const e=this.selectedRows.filter(e=>"pending"===e.status);0!==e.length?this.$confirm(`确定要批量申报选中的 ${e.length} 条记录吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.listLoading=!0,setTimeout(()=>{e.forEach(e=>{e.status="declared"}),this.$message.success(`批量申报完成，共处理 ${e.length} 条记录`),this.listLoading=!1,this.getList()},1500)}):this.$message.warning("请选择待申报的记录")},handleBatchApprove(){const e=this.selectedRows.filter(e=>["declared","reviewing"].includes(e.status));0!==e.length?this.$confirm(`确定要批量审核选中的 ${e.length} 条记录吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.listLoading=!0,setTimeout(()=>{e.forEach(e=>{e.status="approved",e.approvedAmount=Math.min(e.declaredAmount,e.commissionLimit)}),this.$message.success(`批量审核完成，共处理 ${e.length} 条记录`),this.listLoading=!1,this.getList()},1500)}):this.$message.warning("请选择已申报或审核中的记录")},handleSubmitDeclare(){this.$refs.declareForm.validate(e=>{e&&(this.listLoading=!0,setTimeout(()=>{if(this.declareForm.id){const e=this.list.findIndex(e=>e.id===this.declareForm.id);e>-1&&Object.assign(this.list[e],this.declareForm,{status:"declared"}),this.$message.success("修改申报成功")}else{const e={...this.declareForm,id:Date.now(),status:"declared",declareTime:(new Date).toLocaleString()};this.list.unshift(e),this.$message.success("提交申报成功")}this.listLoading=!1,this.declareDialogVisible=!1},1e3))})},handleSubmitApprove(){this.approveForm.result?this.approveForm.remark?"approved"!==this.approveForm.result||this.approveForm.approvedAmount?(this.listLoading=!0,setTimeout(()=>{const e=this.list.findIndex(e=>e.id===this.approveForm.id);e>-1&&(this.list[e].status=this.approveForm.result,"approved"===this.approveForm.result&&(this.list[e].approvedAmount=this.approveForm.approvedAmount)),this.$message.success("审核完成"),this.listLoading=!1,this.approveDialogVisible=!1,this.getList()},1e3)):this.$message.warning("请输入核准金额"):this.$message.warning("请输入审核意见"):this.$message.warning("请选择审核结果")},handleExport(){this.$message.info("导出运营提成数据...")},handleViewCase(e){this.$message.info("查看项目："+e.caseNo)},handleViewWorkLog(e){this.$message.info("查看工作日志")},handlePrint(e){this.$message.info("打印提成凭证")},handleViewDialogClose(){this.viewDialogVisible=!1,this.currentRow=null},handleDeclareDialogClose(){this.declareDialogVisible=!1,this.$refs.declareForm.resetFields()},handleSelectionChange(e){this.selectedRows=e},handleSizeChange(e){this.listQuery.limit=e,this.getList()},handleCurrentChange(e){this.listQuery.page=e,this.getList()},handleStatusTabClick(e){"all"===this.activeStatus?this.listQuery.status="":this.listQuery.status=this.activeStatus,this.handleSearch()},tableRowClassName({row:e,rowIndex:t}){return"approved"===e.status?"success-row":"rejected"===e.status?"danger-row":e.declaredAmount>e.commissionLimit?"warning-row":""},getTaskTypeColor(e){const t={patent_writing:"primary",patent_review:"success",trademark_design:"warning",trademark_register:"info",copyright_register:"danger",project_declare:""};return t[e]||"default"},getTaskTypeText(e){const t={patent_writing:"专利撰写",patent_review:"专利审查",trademark_design:"商标设计",trademark_register:"商标注册",copyright_register:"版权登记",project_declare:"项目申报"};return t[e]||e},getStatusType(e){const t={pending:"info",declared:"warning",reviewing:"primary",approved:"success",rejected:"danger"};return t[e]||"info"},getStatusText(e){const t={pending:"待申报",declared:"已申报",reviewing:"审核中",approved:"已通过",rejected:"已拒绝"};return t[e]||e},getTimelineType(e){const t={declare:"primary",review:"warning",approve:"success",reject:"danger"};return t[e]||"primary"}}}),i=l,o=(a("9c9d"),a("2877")),n=Object(o["a"])(i,s,r,!1,null,"c99a48a2",null);t["default"]=n.exports},8911:function(e,t,a){},"9c9d":function(e,t,a){"use strict";a("8911")}}]);